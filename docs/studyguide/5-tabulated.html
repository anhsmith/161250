<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>161250 Data Analysis - Chapter 5: Tabulated Counts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../studyguide/6-single.html" rel="next">
<link href="../studyguide/4-inference.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">161250 Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../studyguide/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Study Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/ws01.html" rel="" target="">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-code">    
        <li>
    <a class="dropdown-item" href="../exercises/Chap2more.R" rel="" target="">
 <span class="dropdown-text">Ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap3more.R" rel="" target="">
 <span class="dropdown-text">Ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap4more.R" rel="" target="">
 <span class="dropdown-text">Ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap5more.R" rel="" target="">
 <span class="dropdown-text">Ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap6more.R" rel="" target="">
 <span class="dropdown-text">Ex6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap7more.R" rel="" target="">
 <span class="dropdown-text">Ex7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap8more.R" rel="" target="">
 <span class="dropdown-text">Ex8</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../studyguide/index.html">Study Guide</a></li><li class="breadcrumb-item"><a href="../studyguide/5-tabulated.html">Chapter 5: Tabulated Counts</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../studyguide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Study Guide</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/1-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 1: Data Collection and Quality Issues</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/2-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2: Exploratory Data Analysis (EDA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/3-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3: Probability Concepts and Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/4-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4: Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/5-tabulated.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Chapter 5: Tabulated Counts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/6-single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6: Models with a Single Continuous Predictor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/7-multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7: Models with Multiple Continuous Predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/8-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8: Analysis of Variance (ANOVA) and Covariance (ANCOVA)</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#goodness-of-fit-tests-for-frequencies" id="toc-goodness-of-fit-tests-for-frequencies" class="nav-link" data-scroll-target="#goodness-of-fit-tests-for-frequencies">Goodness of Fit Tests for Frequencies</a>
  <ul class="collapse">
  <li><a href="#goodness-of-fit-for-distributions" id="toc-goodness-of-fit-for-distributions" class="nav-link" data-scroll-target="#goodness-of-fit-for-distributions">Goodness of Fit for Distributions</a></li>
  </ul></li>
  <li><a href="#contingency-tables" id="toc-contingency-tables" class="nav-link" data-scroll-target="#contingency-tables">Contingency Tables</a>
  <ul class="collapse">
  <li><a href="#example-porcine-stress-syndrome-pss" id="toc-example-porcine-stress-syndrome-pss" class="nav-link" data-scroll-target="#example-porcine-stress-syndrome-pss">Example: Porcine Stress Syndrome (PSS)</a></li>
  </ul></li>
  <li><a href="#points-to-watch-out-for" id="toc-points-to-watch-out-for" class="nav-link" data-scroll-target="#points-to-watch-out-for">Points to Watch Out For</a>
  <ul class="collapse">
  <li><a href="#example-paturition-in-sows" id="toc-example-paturition-in-sows" class="nav-link" data-scroll-target="#example-paturition-in-sows">Example: Paturition in Sows</a></li>
  </ul></li>
  <li><a href="#square-contingency-tables" id="toc-square-contingency-tables" class="nav-link" data-scroll-target="#square-contingency-tables">Square contingency tables</a></li>
  <li><a href="#correspondence-analysis-ca" id="toc-correspondence-analysis-ca" class="nav-link" data-scroll-target="#correspondence-analysis-ca">Correspondence Analysis (CA)</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="5-tabulated.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Chapter 5: Tabulated Counts</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><em>“….the Chi-square statistical test is one of twenty important scientific breakthroughs of the 20th century…”</em></p>
<p>— Ian <span class="citation" data-cites="hacking">Hacking (<a href="#ref-hacking" role="doc-biblioref">1984</a>)</span></p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this chapter we consider tests of fit and tests of association. Tests of fit and association are used to determine whether the data complies with some hypothesis. In the first case, Goodness of Fit tests are used to determine whether the frequency distribution of some variable observed in sample data (for example the frequencies associated with the two categories of gender) complies with some hypothesised frequency breakdown. This test would involve comparing the number of males and females in the sample with the numbers of males and females expected under the hypothesis. Sometimes it is the Goodness of Fit of a particular distribution which is in question. For example, can we assume that the residuals follow a Normal distribution? We have already seen in Chapters 3 and 4 how Normal probability plotting can be used to asses for normality. Chi-squared Goodness of Fit Tests can also be used to test whether the data follows a specific distribution.</p>
<p>Tests of association, on the other hand, are tests for a relationship between two categorical variables when the data is arranged as a cross-tabulation (contingency table). Observed frequencies are compared with the frequencies which would be expected if the rows and columns of the tables were independent. If they are not independent, then we can use a numerical and graphical technique called Correspondence Analysis to help us explore the ‘correspondence’ (i.e.&nbsp;association) of the various row and column categories. Correspondence Analysis will be introduced only at a very basic level.</p>
</section>
<section id="goodness-of-fit-tests-for-frequencies" class="level1">
<h1>Goodness of Fit Tests for Frequencies</h1>
<p>In this section, we consider a row of numbers and consider the question, How do observed frequency counts compare with known, or assumed, expected counts? Consider the following hypothetical example. Of the people who emigrated from New Zealand in a particular year, the percentages in three age categories were as shown in <a href="#tbl-emigdat">Table&nbsp;1</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>emigration <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">c</span>( <span class="st">"Up to 30 years"</span>, <span class="st">"31-40 years"</span>, <span class="st">"41 years and older"</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Percentages =</span> <span class="fu">c</span>(<span class="dv">65</span>,  <span class="dv">25</span>,  <span class="dv">10</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>emigration</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-emigdat" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;1: Emigration Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Percentages</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Up to 30 years</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="even">
<td style="text-align: left;">31-40 years</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">41 years and older</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Assume that in a random sample of 200 emigrating from Wellington, the numbers in the three age categories were 100, 55 and 45 respectively (data fictitious). Are these numbers compatible with the yearly percentages? For the first category we would have expected 65% of 200 = 130; for category B, expected number is 25% of 200 = 50; for C, expected number is 10% of 200 = 20. We can then form a table of observed and expected frequencies as shown in <a href="#tbl-emigdat2">Table&nbsp;2</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>emigration <span class="ot">&lt;-</span> emigration <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Expected counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">130</span>, <span class="dv">50</span>, <span class="dv">20</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Observed counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">55</span>, <span class="dv">45</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>emigration</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-emigdat2" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2: Emigration data with observed and expected counts</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Percentages</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Expected counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Observed counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Up to 30 years</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">31-40 years</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">41 years and older</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">45</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Clearly, the composition in the random sample differs from the overall New Zealand percentages in that particular year. The question is whether these differences can be attributed simply to chance variation, or whether they indicate a definite regional difference between the emigration pattern from Wellington and that of New Zealand as a whole?</p>
<p>To test whether the observed values differ significantly from the expected, the Chi-squared statistic is used. Notice that the Greek letter <span class="math inline">\(\chi\)</span>, chi, is pronounced “kai” as in the greeting “hi”.</p>
<p><span class="math display">\[\chi ^{2} =\sum _{1}^{c}\frac{\left({\text {Observed-Expected}}\right)^2 }{{\text {Expected}}}  =\sum _{1}^{c}\frac{\left( O-E\right)^{2}}{E}\]</span></p>
<p>There are three points to be noted here:</p>
<ol type="a">
<li><p>The summation is over every cell (that is every count).</p></li>
<li><p>The Chi-squared statistic has a continuous distribution. Like the <em>t</em> distribution, its shape depends on the degrees of freedom; in general, its curve is skewed to the right. With <span class="math inline">\(c\)</span> categories, the degrees of freedom is equal to <span class="math inline">\((c-1)\)</span>.</p></li>
<li><p>We are employing the Chi-squared statistic with data which consists of integers. That is, the data are discrete rather than continuous. In consequence, the above formula for Chi-squared statistic is only approximate but the approximation is very good if each expected value is greater than 5 and it is often good even if some expected values are as small as 1.</p></li>
</ol>
<p>For the emigration example,</p>
<p><span class="math display">\[
\begin{aligned}
\chi^2 &amp;= (100-130)^2/130 + (55-50)^2/50 + (45-20)^2/20 \\
&amp;= 6.92 + 0.5 + 31.25 \\
&amp;= 38.67
\end{aligned}   
\]</span></p>
<p>with 2 degrees of freedom.</p>
<p>From the tables of <span class="math inline">\(\chi^2\)</span> distribution, 38.67 is much larger than the tabulated value of 13.82 so that the area (probability) greater than this value is only 0.001. In other words, the probability of such a high value of Chi-squared by chance is very small, indeed less than 0.001 or 0.1%. This leads us to reject, at the 0.1% level, the assumption that the age composition of emigrants (from Wellington) agrees with the overall New Zealand yearly figures. This suggests a difference in the age distribution of emigrants. Notice that the contributions to the Chi-squared statistic are reasonably small for categories A and B, but category C contributes a large value of 31.25. It would appear that the emigrants from Wellington are older.</p>
<p>There is an interesting historical situation in which Chi-squared statistics were used to demonstrate the experimental results had been fudged. Gregor Mendel (1822-1884) has some claim to being called the father of modern genetics. <span class="citation" data-cites="Freedman2007">Freedman, Pisani, and Purves (<a href="#ref-Freedman2007" role="doc-biblioref">2007</a>)</span> in their book ‘Statistics’ gave the following explanation.</p>
<blockquote class="blockquote">
<p>“<em>Mendel’s experiments were all carried out on garden peas. Pea seeds are either yellow or green, and a plant can bear seeds of both colours. Mendel bred a pure yellow strain, that is, a strain in which every plant in every generation had only yellow seeds; and separately he bred a pure green strain. He then crossed plants of the pure yellow strain with plants of the pure green strain. For instance, he used pollen from the yellows to fertilise ovules on plants of the green strain. (The alternative method using pollen from the greens to fertilise plants of the yellow strain, gave exactly the same results). The seeds resulting from a yellow-green cross, and the plants in to which they grow, are called first-generation hybrids. First-generation hybrid seeds are all yellow, indistinguishable from seeds of the pure yellow strain. So the green seems to have disappeared completely.</em><br><br>”<em>These first-generation hybrid seeds grew into first-generation hybrid plants which Mendel crossed with themselves, producing second-generation hybrid seeds. Some of these second-generation seeds were yellow, but some were green. So the green disappeared for one generation, but reappeared in the second. Even more surprising, the green reappeared in a definite simple proportion: of the second-generation hybrid seeds, about 75% were yellow and 25% were green.</em><br><br> “<em>What is behind this regularity? To explain it, Mendel postulated the existence of the entities now called genes. The genes of the yellow strain were dominant while the genes of the green strain were recessive. This caused the yellow colouring of the first-generation hybrids.</em>”</p>
</blockquote>
<p>Of course, the situation becomes more complicated if more than one attribute is considered. In one of Mendel’s trials he also considered whether the peas were smooth or wrinkled in appearance. The ratio for four types of peas was expected to be 9:3:3:1. The observed and expected numbers in the four categories were as shown in <a href="#tbl-menpea">Table&nbsp;3</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Mendel <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Type of pea</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Smooth yellow"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Wrinkled yellow"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Smooth green"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Wrinkled green"</span>), </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Expected counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">313</span>, <span class="dv">104</span>, <span class="dv">104</span>, <span class="dv">35</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Observed counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">315</span>, <span class="dv">101</span>, <span class="dv">108</span>, <span class="dv">32</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>Mendel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-menpea" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;3: Pea observed and expected counts</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Type of pea</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Expected counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Observed counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Smooth yellow</td>
<td style="text-align: right;">313</td>
<td style="text-align: right;">315</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wrinkled yellow</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Smooth green</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wrinkled green</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">32</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The observed results are very close to those expected and therefore a very small Chi-squared value is obtained. Sir R A Fisher (1890–1962) has some claim to being the father of inferential statistics. He examined the results of a number of Mendel’s experiments and discovered that, without exception, the Chi-squared values were much smaller than expected. While one can be lucky on a few occasions obtaining results close to what a theory suggests, the probability that the Chi-squared values would be small in every experiment is so low as to be unbelievable. Did the great Mendel cheat? <span class="citation" data-cites="Fisher1936">Fisher (<a href="#ref-Fisher1936" role="doc-biblioref">1936</a>)</span> gave him the benefit of the doubt but noted that Mendel’s assistant may well have been aware of the anticipated results and consciously, or unconsciously, had classified the peas in the appropriate cell. After all, it was not always easy to classify some of the pea seeds. The moral is that some people are just too helpful.</p>
<section id="goodness-of-fit-for-distributions" class="level2">
<h2 class="anchored" data-anchor-id="goodness-of-fit-for-distributions">Goodness of Fit for Distributions</h2>
<p>When testing for the goodness of fit for a distribution, observations in various non-overlapping ranges are classified into categories and a frequency count is obtained for each category or range. These (observed) frequency counts are compared to the counts which would be obtained if the hypothesised distribution fitted the data exactly. We call these counts the expected counts. In general one assumes that the parameters of the hypothesised distribution equal the estimates obtained from the data. Thus we are effectively just testing whether the <em>shape</em> of the hypothesised distribution is correct.</p>
<p>For example if a set of data has a sample mean of 10 and sample standard deviation of 2 and we wish to test whether a Normal distribution is appropriate for these data, we hypothesise a Normal distribution with a mean of 10 and a standard deviation of 2. The following Chi-squared statistic can be used to test whether the hypothesised distribution describes the data reasonably well. The idea is to split the number line into, say, <span class="math inline">\(c\)</span> non-overlapping intervals spanning the range of the data. The observed and expected frequency of data in each interval is then compared, using</p>
<p><span class="math display">\[\chi ^{2} =\sum _{1}^{c}\frac{\left({\text   {Observed-Expected}}\right)^2 }{{\text   {Expected}}}  =\sum _{1}^{c}\frac{\left( O-E\right)^{2}}{E},\]</span></p>
<p>where again we sum over all <span class="math inline">\(c\)</span> categories. For example, for <span class="math inline">\(n=100\)</span> data we would expect 15.87% to be <span class="math inline">\(\leq 8\)</span>, 34.13% to be greater than 8 and <span class="math inline">\(\leq 10\)</span> , 34.13% to be greater than 10 and <span class="math inline">\(\leq 12\)</span>, and 15.87% to be <span class="math inline">\(&gt;12\)</span>. We would compare our observed counts with these expected ones. Note that expected counts need not be integers, and should not be rounded in the calculation of <span class="math inline">\(\chi^2\)</span>, especially if they are small as that can introduce substantial round-off error into <span class="math inline">\(\chi^2\)</span>.</p>
<p>The degrees of freedom for this test equals the number of data categories minus one more than the number of parameters estimated <span class="math inline">\(c-1-2 = c-3\)</span> in this case). These tests were covered in your first-year paper. You should revise your notes on them. Note that we have seen in Chapter 4 that it is possible to test for normality using an tests such as Shapiro-Wilk test.</p>
</section>
</section>
<section id="contingency-tables" class="level1">
<h1>Contingency Tables</h1>
<p>Contingency tables are frequency counts arranged in a two way table. We can test for independence between the rows and columns of such a table using a Chi-squared statistic. There are two main points which need to be noted:</p>
<dl>
<dt><strong>(a)</strong></dt>
<dd>
<p>Expected values can be obtained by assuming that the row variable is <strong>independent</strong> of the column variable. In practice, this means that the expected count for cell <span class="math inline">\((i,j)\)</span> is given by <span class="math inline">\(E_{ij}\)</span> where</p>
<p><span class="math display">\[E_{ij} = (T_i \times T_j)/n\]</span></p>
<p>in which <span class="math inline">\(T_i\)</span> = total for row <span class="math inline">\(i\)</span>, <span class="math inline">\(T_j\)</span> = total for column <span class="math inline">\(j\)</span> and <span class="math inline">\(n\)</span> = overall total count</p>
</dd>
<dt><strong>(b)</strong></dt>
<dd>
<p>The <strong>degrees of freedom</strong> are given by <span class="math inline">\((r-1)\times(c-1)\)</span> where <span class="math inline">\(r\)</span> is the number of rows and <span class="math inline">\(c\)</span> is the number of columns.</p>
</dd>
</dl>
<p>These points will be illustrated in the example below on Porcine Stress Syndrome. The Chi-squared statistic is constructed in the same way as before, i.e.</p>
<p><span class="math display">\[\chi ^{2} =\sum _{i=1}^{r}\sum _{j=1}^{c}\frac{\left({ O}_{{ ij}} { -E}_{{ij}} \right)^{{ 2}} }{{ E}_{{ij}} }.\]</span></p>
<p>A useful way of thinking about the <span class="math inline">\(\chi ^2\)</span> is the following. If we think of the difference between the observed and expected values as a residual, then we can write:</p>
<p><span class="math display">\[\chi ^{2} =\sum \frac{\left({\text {O-E}}\right)^{2} }{{\text E}} =\sum \frac{\left({\text {residual}}\right)^{2} }{{\text {fit}}}.\]</span></p>
<p>In more theoretical courses, you may learn that data expressed as counts often follows a Poisson distribution in which the mean equals the variance. If you substitute variance for fit in the formula, you get</p>
<p><span class="math display">\[\chi ^{2} =\sum \frac{\left({\text {residual}}\right)^{2} }{{\text {variance}}} =\sum \left(\frac{{\text {residual}}}{{\text {std dev}}} \right)^{2}.\]</span> which looks like a sum of squared standardised residuals. As noted in chapter 6 any standardised residuals which are greater than 2 (approximately) in absolute value can be regarded as significant. Squaring this we find that any cell which makes a contribution of more than 4 to the Chi-squared statistic is a significant source of the dependence between rows and columns. So this idea helps in the interpretation of contingency tables. Any cells contributing more than 4 to the Chi-squared statistic should be studied carefully in order to gain an understanding regarding the nature of any dependence between the rows and columns.</p>
<section id="example-porcine-stress-syndrome-pss" class="level2">
<h2 class="anchored" data-anchor-id="example-porcine-stress-syndrome-pss">Example: Porcine Stress Syndrome (PSS)</h2>
<p>Porcine Stress Syndrome (PSS) can result in the development of pale, soft meat in pigs and, under conditions of stress, sudden death. It can therefore result in severe economic loss. It is believed to be controlled by a single gene and its incidence could therefore be reduced by a selective breeding program. In a survey of its incidence, the following results were obtained for four major breeds. (The presence of PSS can be detected by a positive reaction to the breathing of halothane). The observed counts are shown in <a href="#tbl-pss1">Table&nbsp;4</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dpss <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Breed =</span> <span class="fu">c</span>(<span class="st">"Large White"</span>, <span class="st">"Hampshire"</span>, <span class="st">"Landrace(B)"</span>, <span class="st">"Landrace(S)"</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Halothane positive</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">16</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Halothane negative</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">86</span>, <span class="dv">73</span>, <span class="dv">76</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>dpss_with_totals <span class="ot">&lt;-</span> dpss <span class="sc">|&gt;</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Row total"</span>, <span class="st">"Column total"</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>dpss_with_totals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-pss1" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;4: Porcine Stress Syndrome (PSS) data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Breed</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Halothane positive</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Halothane negative</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Column total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Large White</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">78</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hampshire</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">89</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Landrace(B)</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">84</td>
</tr>
<tr class="even">
<td style="text-align: left;">Landrace(S)</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Row total</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">311</td>
<td style="text-align: right;">343</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Expected values are calculated assuming independence between the rows and columns. This gives the numbers in parentheses in <a href="#fig-chisq">Figure&nbsp;1</a>.</p>
<div id="fig-chisq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/chisq.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Manual computation of ChSq statistic</figcaption>
</figure>
</div>
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| message: false -->
<!-- #| label: fig-chisq -->
<!-- #| fig-cap: 'Manual computation of ChSq statistic' -->
<!-- #| fig-width: 6 -->
<!-- knitr::include_graphics('images/chisq.png') -->
<!-- ``` -->
<p>For example the expected value in the (3, 2) cell, the number of British Landrace pigs which gave a negative test for halothane, is <span class="math display">\[E_{3,2} = T_3 \times T_2 /n = 84 \times 311/343 = 76.2.\]</span> The Chi-squared statistic is calculated as before using the formula <span class="math inline">\(\chi^2 = \sum(O_{ij} - E_{ij})^2/E_{ij}\)</span>. The Chi-square of 16.43 is associated with <span class="math inline">\((4-1)\times (2-1) = 3\)</span> degrees of freedom, and is therefore <em>significant</em> at the 5% level and at the 0.5% level. (Note that the <em>tabulated value</em> or <em>critical value</em> equals 7.81 at 5% significance level; and 12.8 at the 0.5% level).</p>
<p>Hence, there is strong statistical evidence that there are differences between breeds in the incidence of porcine stress syndrome. In other words, the breed is not independent of the result of the halothane test.</p>
<p>Notice that the large counts in the second column (halothane negative) lead to large expected values but low contributions to the Chi-squared statistics (0.38, 0.35, 0.13 and 0.66). This is not surprising as each of these terms is divided by a large expected value. On the other hand, the small observations of the first column lead to small expected values but larger contributions to the Chi-squared statistic. Any Chi-squared contribution in excess of four (as explained previously) should be interpreted. In this example it is clear that Landrace (Swedish) pigs are more prone to porcine stress syndrome than are the other three breeds.</p>
<p>Another view of the idea of degrees of freedom can be obtained by noting that if the three expected values at the top of Column 2 are calculated (70.7, 80.7 and 76.2) then the remaining expected value can be found by subtraction from the appropriate row or column totals. Thus if the row and column totals are known, then only three numbers inside the contingency table are free before the whole table of numbers is then determined.</p>
</section>
</section>
<section id="points-to-watch-out-for" class="level1">
<h1>Points to Watch Out For</h1>
<p>The Chi-squared statistic should only be used with frequency counts. Sometimes, researchers convert the counts in the cells of a table to percentages of the total. For example in <a href="#fig-chisq">Figure&nbsp;1</a>, the cell counts could be divided by 343 and multiplied by 100 to give percentages. In this case, the numbers in the cells would be reduced and the Chi-squared statistic likewise would be reduced from 16.43 to 16.43/343 = 0.048. An incorrect conclusion of independence of rows and columns would be drawn from this statistic.</p>
<p>If the expected value in a cell is small, the contribution to the Chi-squared statistic may be spuriously inflated. It was suggested earlier that an expected value less than 5 may lead to some concern and a very small value of less than 1 should sound warning bells. We suggest the following procedure:</p>
<ol type="1">
<li><p>If the Chi-squared statistic is small enough to not be significant, there is no problem.</p></li>
<li><p>If the Chi-squared statistic is significant in comparison with tabulated values, then consider the contributions of each cell. If cells with large expected value (that is, greater than 5) contribute a large amount to the Chi-squared statistic, again there is no problem. If cells with expected values less than 5 yield large contributions to the Chi-squared statistic, now you can worry and any declaration of significant values of Chi-squared statistic should be treated with caution.</p></li>
</ol>
<section id="example-paturition-in-sows" class="level2">
<h2 class="anchored" data-anchor-id="example-paturition-in-sows">Example: Paturition in Sows</h2>
<p>Consider the data on the effects of parturition in sows shown in <a href="#tbl-sows1">Table&nbsp;5</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dsow <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Condition =</span> <span class="fu">c</span>(<span class="st">"Starvation"</span>, <span class="st">"Overlain"</span>, <span class="st">"Anaemia"</span>, <span class="st">"Infections"</span>, <span class="st">"Birth Defect"</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Control</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Injected</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">2</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>dsow_with_totals <span class="ot">&lt;-</span> dsow <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Row total"</span>, <span class="st">"Column total"</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>dsow_with_totals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-sows1" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;5: Parturition in sows</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Condition</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Control</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Injected</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Column total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Starvation</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overlain</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Anaemia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Infections</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Birth Defect</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Row total</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">65</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>In an experiment to consider the effects of parturition in sows, 19 pregnant sows were given intramuscular injections of the drug <em>prostaglandin</em> while another 19 pregnant sows served as controls. Of the piglets born to the control sows, 25 died and were autopsied in the first 3 days and, for the treated sows, 40 died and were autopsied in the first 3 days. The chi square test is shown in <a href="#fig-chisq2">Figure&nbsp;2</a> and then the <code>R</code> output follows.</p>
<div id="fig-chisq2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/chisq2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Manual computation of ChSq statistic</figcaption>
</figure>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the variable "Condition" the row names </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so that the data frame contains only the </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># two columns and 10 data points </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>dsow_dataonly <span class="ot">&lt;-</span> dsow <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Condition"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>dsow_dataonly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Control Injected
Starvation         8       10
Overlain           8        9
Anaemia            0       12
Infections         3        7
Birth Defect       6        2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dsow_dataonly <span class="sc">|&gt;</span> <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in stats::chisq.test(x, y, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  dsow_dataonly
X-squared = 13.118, df = 4, p-value = 0.01071</code></pre>
</div>
</div>
<p>Notice that there are four cells whose expected values are less than 5 (4.6, 3.8, 3.1 and 4.9) and their contributions to the Chi-squared statistic are (4.62, 0.19, 2.78 and 1.74). Without these contributions, the Chi-squared statistic would not be significant. The conclusion should then be that there is not enough evidence to conclude that the Chi-squared statistic is significant. So there is not sufficient evidence to conclude that the cause of death depends on whether the injection was given.</p>
<p>If the Chi-square test involves many small expected counts, then we may obtain the <span class="math inline">\(p\)</span>-value for the chi square statistic by Monte Carlo simulation (i.e.&nbsp;without relying on the Chi-square approximation). This simulation procedure involves random sampling from the set of all possible contingency tables having the same row and column totals. The <code>R</code> function <code>chisq.test()</code> can do this for you.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dsow_dataonly <span class="sc">|&gt;</span> <span class="fu">chisq.test</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with simulated p-value (based on 2000
    replicates)

data:  dsow_dataonly
X-squared = 13.118, df = NA, p-value = 0.006497</code></pre>
</div>
</div>
<p>As mentioned earlier, the Chi-square test is for actual counts and if you scale them you will get different results. For example, if we multiply Parturition counts by 100, and do the test, the conclusions will change.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dsow_dataonly_100 <span class="ot">&lt;-</span> dsow_dataonly <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Control =</span> <span class="dv">100</span> <span class="sc">*</span> Control,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Injected =</span> <span class="dv">100</span> <span class="sc">*</span> Injected) </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dsow_dataonly_100</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Control Injected
Starvation       800     1000
Overlain         800      900
Anaemia            0     1200
Infections       300      700
Birth Defect     600      200</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dsow_dataonly_100 <span class="sc">|&gt;</span> <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  dsow_dataonly_100
X-squared = 1311.8, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We should also be careful when we combine two or more contingency tables into one. The association seen in a particular table may disappear after amalgamation. <span class="citation" data-cites="Simpson">Simpson (<a href="#ref-Simpson" role="doc-biblioref">1951</a>)</span> provided the theory on why this happens for contingency tables data and hence this paradox is known as Simpson’s paradox even though this was observed by others before him. Consider the following <code>R</code> outputs showing the ChiSq test for two separate groups and then the amalgamated group.</p>
<p>For Group 1 counts, the Chi-square test is shown below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">30</span>), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">80</span>)) </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>group1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   80  120
[2,]   30   80</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(group1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  group1
X-squared = 4.4809, df = 1, p-value = 0.03428</code></pre>
</div>
</div>
<p>For group 2 counts, the Chi-square test is shown below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">25</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">20</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>group2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   20   75
[2,]   25   20</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(group2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  group2
X-squared = 15.122, df = 1, p-value = 0.0001008</code></pre>
</div>
</div>
<p>For the amalgamated contingency table, we obtain-</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">55</span>),</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(<span class="dv">195</span>,<span class="dv">100</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]  100  195
[2,]   55  100</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  all
X-squared = 0.053808, df = 1, p-value = 0.8166</code></pre>
</div>
</div>
<p>Evidently the association seen in the subgroups is lost after amalgamation.</p>
<p>The opposite can also happen. That is, when populations are separated somewhat parallelly by a factor like Gender, the overall association may not filter to the same level of association for the two gender groups.</p>
</section>
</section>
<section id="square-contingency-tables" class="level1">
<h1>Square contingency tables</h1>
<p>Assume that two observers independently classifying the same <span class="math inline">\(n\)</span> items into the same <span class="math inline">\(k\)</span> categories. The resulting contingency table becomes a <span class="math inline">\(k \times k\)</span> square contingency table. In biostatistical studies, such square contingency tables are common. Often such contingency tables would have very low cell counts for the off-diagonal cells. The main interest with a square contingency table is the assessment or measurement of the agreement between rows and columns. So there is no need to perform any ChiSq test. <a href="#tbl-britrel">Table&nbsp;6</a> gives the religion of origin cross-classified by current religion using the six groupings in Britain (data taken from <span class="citation" data-cites="Breen">Breen and Hayes (<a href="#ref-Breen" role="doc-biblioref">1996</a>)</span>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>drel <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Row =</span> <span class="fu">c</span>(<span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"R3"</span>, <span class="st">"R4"</span>, <span class="st">"R5"</span>, <span class="st">"R6"</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">R1 =</span> <span class="fu">c</span>(<span class="dv">123</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">420</span>, <span class="dv">21</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>), </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">R3 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">102</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">R4 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">R5 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">1</span>), </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">R6 =</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">217</span>, <span class="dv">54</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">62</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>drel <span class="sc">|&gt;</span> </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"ROW TOTAL"</span>, <span class="st">"COL TOTAL"</span>), </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-britrel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;6: Crosstabulation of origin religion by current religion</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Row</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COL TOTAL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">174</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">420</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">185</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ROW TOTAL</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">458</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">392</td>
<td style="text-align: right;">1135</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The agreement between the origin and current religion can be visualised using the agreement plot available in the <code>vcd</code> package (<a href="#fig-agreementplot">Figure&nbsp;3</a>). (Note, some functions require the data to be in numerical matrix format.)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>drelmatrix <span class="ot">&lt;-</span> drel <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Row"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">agreementplot</span>(drelmatrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-agreementplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="5-tabulated_files/figure-html/fig-agreementplot-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Agreement plot for origin vs religion</figcaption>
</figure>
</div>
</div>
</div>
<p>Evidently there is a strong agreement between rows and columns. One of the popular measures for measuring agreement is the Cohen’s kappa. This statistic is the diagonal sum of the relative frequencies, corrected for expected values and standardized by its maximum value. In case of complete agreement, the kappa coefficient will be unity. For the religion example, the kappa value is not actually high.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Kappa</span>(drelmatrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            value     ASE     z   Pr(&gt;|z|)
Unweighted 0.4955 0.01825 27.15 2.526e-162
Weighted   0.3358 0.02030 16.55  1.733e-61</code></pre>
</div>
</div>
<p>This topic is not covered in depth. It is sufficient if you recognise the special form of two-way contingency table such as this one.</p>
</section>
<section id="correspondence-analysis-ca" class="level1">
<h1>Correspondence Analysis (CA)</h1>
<p><strong>Correspondence Analysis</strong> is an exploratory statistical technique for assessing the interdependence of categorical variables whose data are presented primarily in the form of a two-way table of frequencies (or <strong><em>contingency table</em></strong>). Applied in an advanced way, the methodology can help researchers to “quantify the qualitative data” found in many disciplines. However we will introduce CA at a very basic level, just picking up on those aspects that can help one interpret a contingency table.</p>
<p>CA requires only a rectangular data matrix (cross-tabulation) of non-negative counts-but the number of rows and columns must be 3 or more. The rows and columns do not have to have predefined meanings but instead must represent the responses to categorical variables. Where there are just two variables (one each for rows and columns) the analysis is called <strong>Simple Correspondence Analysis</strong>. The analysis of cross-tabulations of three or more variables is called <strong>Multiple Correspondence Analysis</strong>. This is beyond the scope of this paper.</p>
<p>We shall illustrate some of the basic ideas behind CA using a simple example. Consider <a href="#tbl-smoke">Table&nbsp;7</a> of frequencies (or <em>contingency table</em>) of <em>smokers</em> in a random sample of 193 personnel (<em>staff group</em>) from an organisation (data from Correspondence Analysis in Practice by Greenacre, 1993). A significant association between smoking status and staff groupings can be observed with the Chi-square test.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dsmo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Groups =</span> <span class="fu">c</span>(<span class="st">"Junior employees"</span>, <span class="st">"Junior managers"</span>, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Secretaries"</span>, <span class="st">"Senior employees"</span>, <span class="st">"Senior managers"</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">None =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">4</span>),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Moderate =</span> <span class="fu">c</span>(<span class="dv">57</span>, <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">22</span>, <span class="dv">5</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Heavy =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>dsmo <span class="sc">|&gt;</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"ROW TOTAL"</span>, <span class="st">"COL TOTAL"</span>), </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-smoke" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;7: Smoking Status vis-a-vis Staff Groupings</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Groups</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">None</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Moderate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Heavy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COL TOTAL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Junior employees</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">88</td>
</tr>
<tr class="even">
<td style="text-align: left;">Junior managers</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Secretaries</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Senior employees</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Senior managers</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROW TOTAL</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">193</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  column_to_rownames(dsmo, "Groups")
X-squared = 15.672, df = 8, p-value = 0.04733</code></pre>
</div>
</div>
<p>Suppose we think that there are differences in the smoking status of the various staff groups. One way to investigate these differences would be to calculate <strong>row profiles</strong>. That is, <em>we divide each entry in a particular row by the total for that row</em>, and multiply by 100%. The set of percentages for each staff group are then called the row profile for that group. The row profiles are shown in <a href="#tbl-rowprofiles">Table&nbsp;8</a> (ignore for a moment the row labelled “Row.Mass”).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dsmomatrix <span class="ot">&lt;-</span> dsmo <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Groups"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>rowtotal <span class="ot">=</span> <span class="fu">rowSums</span>(dsmomatrix)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>rowprofile <span class="ot">=</span> dsmomatrix<span class="sc">/</span>rowtotal</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>coltotal <span class="ot">=</span> <span class="fu">colSums</span>(dsmomatrix)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>colprofile <span class="ot">=</span> dsmomatrix<span class="sc">/</span>coltotal</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>Row.Mass <span class="ot">=</span> coltotal<span class="sc">/</span><span class="fu">sum</span>(dsmomatrix)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>Column.Mass <span class="ot">=</span> rowtotal<span class="sc">/</span><span class="fu">sum</span>(dsmomatrix)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>rowpf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rowprofile, Row.Mass) <span class="sc">|&gt;</span> </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>rowpf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-rowprofiles" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;8: Row Profiles</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">None</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Moderate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Heavy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Junior employees</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0.648</td>
<td style="text-align: right;">0.148</td>
</tr>
<tr class="even">
<td style="text-align: left;">Junior managers</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">0.222</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Secretaries</td>
<td style="text-align: right;">0.400</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.080</td>
</tr>
<tr class="even">
<td style="text-align: left;">Senior employees</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">0.431</td>
<td style="text-align: right;">0.078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Senior managers</td>
<td style="text-align: right;">0.364</td>
<td style="text-align: right;">0.455</td>
<td style="text-align: right;">0.182</td>
</tr>
<tr class="even">
<td style="text-align: left;">Row.Mass</td>
<td style="text-align: right;">0.316</td>
<td style="text-align: right;">0.554</td>
<td style="text-align: right;">0.130</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Comparing the profiles among the various staff groups we see that they generally have a similar shape (small % of ‘none’, large % of ‘moderate’ and small % of ‘heavy’) but there are subtle differences. In particular a much larger percentage of secretaries and senior employees were in the ‘none’ group, than was the case for junior employees and junior managers, with senior managers in between. The row ‘mass’ can be interpreted as the marginal (average) profile for the smoking status and is found by dividing each column total by the overall total. The profiles can also be plotted as in <a href="#fig-rowprofiles1">Figure&nbsp;4</a> to facilitate comparisons.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>rowprofile_long <span class="ot">&lt;-</span> rowprofile <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Staff Group"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>None<span class="sc">:</span>Heavy,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Smoking Status"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Row Profiles"</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>rowprofile_long <span class="sc">|&gt;</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Staff Group</span><span class="st">`</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">Row Profiles</span><span class="st">`</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">`</span><span class="at">Smoking Status</span><span class="st">`</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">`</span><span class="at">Smoking Status</span><span class="st">`</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="st">`</span><span class="at">Smoking Status</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-rowprofiles1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="5-tabulated_files/figure-html/fig-rowprofiles1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Graphical display of Row Profiles</figcaption>
</figure>
</div>
</div>
</div>
<p>An alternative analysis could be based on the column percentages (<strong>column profiles</strong>) by dividing the entries in each column of the <a href="#tbl-columnprofiles">Table&nbsp;9</a> by each column’s total.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>colpf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(colprofile, Column.Mass) <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>colpf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-columnprofiles" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;9: Column Profiles</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">None</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Moderate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Heavy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Column.Mass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Junior employees</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">Junior managers</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Secretaries</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Senior employees</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Senior managers</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.06</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The ‘mass’ column is then based on the total’ column in <a href="#tbl-columnprofiles">Table&nbsp;9</a>, and can be interpreted as the marginal percentage of employees in each staff group. Looking at the column profiles displayed in <a href="#tbl-columnprofiles">Table&nbsp;9</a>, for example, we notice that of the 107 moderate smokers in the survey, 53.3% are junior employees compared to 45.6% of the sample as a whole. Moreover this profile is fairly similar to that of the ‘heavy’ smokers. The profile for non-smokers, however, is quite different. In particular more than average of the senior employees are non-smokers. Whether we analyse the data by considering the row profiles or the column profiles, we should arrive at a similar conclusion. In each case we can compare the row (column) profile to the row (column) average (mass). As we should come to much the same conclusion either way, this approach is known as ‘symmetric consideration’ of the rows and columns.</p>
<p>There are further methods available to investigate the dependency in a contingency table which are beyond the scope of this course. However we will consider one very useful graph called a <strong>Symmetric Plot</strong>. The way this graph is created is that techniques from Linear Algebra are used to define two principal trends within the data. Technically the trends are referred to as inertia, which is a concept we will not go into. What is needful is to know that the trends are represented as the axes of the plot. As these axes are devised automatically – based purely on the numbers rather than the context – it can be that they are not easy to interpret. But often they are easily interpreted, especially if you apply a little ‘lateral thinking’. So the axes can give a real insight into the data. And even when the axes themselves are not interpretable, this still does not prevent us getting some useful information from the plot. Plotted on this graph are points, corresponding to the row and column categories of the contingency table. The actual location of the points depends on the axes. The main thing is that we can interpret points that are ‘near’ as being related in some way, while points that are far apart are in some sense opposite.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS, <span class="at">exclude =</span> <span class="st">"select"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>dsmomatrix <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corresp</span>(<span class="at">nf=</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, .<span class="dv">45</span>))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-symplot1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="5-tabulated_files/figure-html/fig-symplot1-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Symmetric plot of smoking data</figcaption>
</figure>
</div>
</div>
</div>
<p>Looking at the example of a symmetric plot in <a href="#fig-symplot1">Figure&nbsp;5</a>, we see that Senior Employees are very close to the None category of smokers, while Junior Managers are very close to the Heavy category of smokers. This is graphical display of the information in <a href="#tbl-rowprofiles">Table&nbsp;8</a>, where these types of workers had the smallest and biggest proportions in the Heavy smokers column respectively – and the reverse for the ‘None’ column. The other categories are intermediate – that is, for example the Secretaries are a lot closer to the Senior Employees in smoking behaviour than to the Junior Managers and so are plotted that way. The Junior Employees most closely resemble the typical profile of a Moderate smoker.</p>
<p>In a symmetric plot, it is also possible to interpret the axes as well. First note that the <strong>horizontal axis is usually by far the most important</strong>. The variable representing the horizontal axis of the Symmetric Plot accounts for the maximum possible variation when compared to the variable representing the vertical axis. Nevertheless the second axis does serve to spread the data out. Now to interpret the first Axis (horizontal), we consider the points at the extreme left and right of the data. As None is far to the right and Heavy and Moderate far to the left, it is reasonable to interpret this axis as largely a contrast between Non-smokers and Smokers (in general). Then how far from right to left the worker groups are, can be interpreted in terms of how far they are from being non-smokers.</p>
<p>To interpret the second Axis (vertical) we note that the workers with the lowest status (Junior Employees and Secretaries) are at the top, both types of Managers (high job status) are at the bottom, and Senior Employees are in the middle. Thus interestingly the program has sorted the workers in terms of Status, even though the sorting was done entirely on the basis of smoking behaviour! However we should not pay equal attention to this axis as it does not represent much variation when compared to the horizontal axis.</p>
<p>As a further example, consider <a href="#tbl-eyehair">Table&nbsp;10</a>. These are frequencies on colours of eyes (rows) and hair of people (columns) in Caithness, Scotland originally analysed by <span class="citation" data-cites="Fisher1940">Fisher (<a href="#ref-Fisher1940" role="doc-biblioref">1940</a>)</span>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>deh <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">eye =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"light"</span>, <span class="st">"medium"</span>, <span class="st">"dark"</span>),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fair =</span> <span class="fu">c</span>(<span class="dv">326</span>, <span class="dv">688</span>, <span class="dv">343</span>, <span class="dv">98</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">red =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">116</span>, <span class="dv">84</span>, <span class="dv">48</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">medium =</span> <span class="fu">c</span>(<span class="dv">241</span>, <span class="dv">584</span>, <span class="dv">909</span>, <span class="dv">403</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark=</span> <span class="fu">c</span>(<span class="dv">110</span>, <span class="dv">188</span>, <span class="dv">412</span>, <span class="dv">681</span>),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">black =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">26</span>, <span class="dv">85</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"eye"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-eyehair" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;10: Frequency of colours of eyes (rows) and hair (columns) in Caithness, Scotland</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">fair</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">red</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dark</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">black</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">blue</td>
<td style="text-align: right;">326</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">241</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">light</td>
<td style="text-align: right;">688</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">584</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medium</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">909</td>
<td style="text-align: right;">412</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="even">
<td style="text-align: left;">dark</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">403</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">85</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The Chi-square test of association on the above two-way table suggests that there is a significant association between the colours of eyes and hair (<span class="math inline">\(\chi^2\)</span>=1240, df = 12, <span class="math inline">\(p\)</span>-value <span class="math inline">\(&lt;0.000\)</span>).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  deh
X-squared = 1240, df = 12, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Given the significant association between row and column variables, it is useful to look for further patterns of association using the symmetric plot given in <a href="#fig-symplot2">Figure&nbsp;6</a>. We see many patterns such as black eyes being associated with dark or black hair etc.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>deh <span class="sc">|&gt;</span> <span class="fu">corresp</span>(<span class="at">nf=</span><span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-symplot2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="5-tabulated_files/figure-html/fig-symplot2-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Symmetric plot of eye and hair colour</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<p>In this chapter, we considered Goodness of Fit Tests and Tests of Association. Two different Goodness of Fit Tests were considered. Chi-square Goodness of Fit Tests are used to test whether a set of frequency data complies with a hypothesised distribution. Only one test of association, the Chi-square Test of Association was considered. For Chi-square tests of association we perform a test on a table of frequencies, that is counts. The null hypothesis is that the row categories are independent of the column categories. A Chi-squared statistic with <span class="math inline">\((r-1)(c-1)\)</span> degrees of freedom is calculated. The contribution of a cell to the total Chi-squared statistic will be large if <span class="math inline">\((O-E)\)</span> is large; that is the observed count is considerably different from the expected (fitted) value. We are interested in this difference.</p>
<p>If <span class="math inline">\(E\)</span> is small then the effect may be spurious, and so categories are joined together to ensure that <span class="math inline">\(E\)</span> is not too small. As a rule of thumb, 1 was taken as the smallest value of E provided that no more than 5% of cells have <span class="math inline">\(E&lt;5\)</span>.</p>
<p>Simple correspondence analysis helps us to explore relationships in large two-way contingency tables when independence is rejected. We use symmetric plots for reduction of the complexity of the table so that we can understand the nature of relationships between the categorical variables.</p>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Breen" class="csl-entry" role="listitem">
Breen, R, and B. C. Hayes. 1996. <span>“Religious Mobility in the <span>UK</span>.”</span> <em>Journal of the Royal Statistical Society. Series A (Statistics in Society)</em> 159 (3): 493–504.
</div>
<div id="ref-Fisher1936" class="csl-entry" role="listitem">
Fisher, R. A. 1936. <span>“Has <span>M</span>endel’s Work Been Rediscovered?”</span> <em>Annals of Science</em> 1: 115–37.
</div>
<div id="ref-Fisher1940" class="csl-entry" role="listitem">
———. 1940. <span>“The Precision of Discriminant Functions.”</span> <em>Annals of Eugenics</em> 10: 422–29.
</div>
<div id="ref-Freedman2007" class="csl-entry" role="listitem">
Freedman, D., R. Pisani, and R. Purves. 2007. <em>Statistics</em>. Fourth. NY: Norton.
</div>
<div id="ref-hacking" class="csl-entry" role="listitem">
Hacking, Ian. 1984. <span>“Trial by Number.”</span> <em>Science</em> 5 (9): 69–70.
</div>
<div id="ref-Simpson" class="csl-entry" role="listitem">
Simpson, E. H. 1951. <span>“The Interpretation of Interaction in Contingency Tables.”</span> <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 13 (2): 238–41.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../studyguide/4-inference.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Chapter 4: Statistical Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../studyguide/6-single.html" class="pagination-link">
        <span class="nav-page-text">Chapter 6: Models with a Single Continuous Predictor</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb45" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Chapter 5: Tabulated Counts"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"....the Chi-square statistical test is one of twenty important scientific breakthroughs of the 20th century..."*</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; — Ian @hacking</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>In this chapter we consider tests of fit and tests of association. Tests of fit and association are used to determine whether the data complies with some hypothesis. In the first case, Goodness of Fit tests are used to determine whether the frequency distribution of some variable observed in sample data (for example the frequencies associated with the two categories of gender) complies with some hypothesised frequency breakdown. This test would involve comparing the number of males and females in the sample with the numbers of males and females expected under the hypothesis. Sometimes it is the Goodness of Fit of a particular distribution which is in question. For example, can we assume that the residuals follow a Normal distribution? We have already seen in Chapters 3 and 4 how Normal probability plotting can be used to asses for normality. Chi-squared Goodness of Fit Tests can also be used to test whether the data follows a specific distribution.</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>Tests of association, on the other hand, are tests for a relationship between two categorical variables when the data is arranged as a cross-tabulation (contingency table). Observed frequencies are compared with the frequencies which would be expected if the rows and columns of the tables were independent. If they are not independent, then we can use a numerical and graphical technique called Correspondence Analysis to help us explore the 'correspondence' (i.e. association) of the various row and column categories. Correspondence Analysis will be introduced only at a very basic level.</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu"># Goodness of Fit Tests for Frequencies</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>In this section, we consider a row of numbers and consider the question, How do observed frequency counts compare with known, or assumed, expected counts? Consider the following hypothetical example. Of the people who emigrated from New Zealand in a particular year, the percentages in three age categories were as shown in @tbl-emigdat.</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>emigration <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">c</span>( <span class="st">"Up to 30 years"</span>, <span class="st">"31-40 years"</span>, <span class="st">"41 years and older"</span>),</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">Percentages =</span> <span class="fu">c</span>(<span class="dv">65</span>,  <span class="dv">25</span>,  <span class="dv">10</span>)</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>emigration</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-emigdat"</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: 'Emigration Data'</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(emigration) <span class="sc">|&gt;</span> </span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>Assume that in a random sample of 200 emigrating from Wellington, the numbers in the three age categories were 100, 55 and 45 respectively (data fictitious). Are these numbers compatible with the yearly percentages? For the first category we would have expected 65% of 200 = 130; for category B, expected number is 25% of 200 = 50; for C, expected number is 10% of 200 = 20. We can then form a table of observed and expected frequencies as shown in @tbl-emigdat2.</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>emigration <span class="ot">&lt;-</span> emigration <span class="sc">|&gt;</span> </span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Expected counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">130</span>, <span class="dv">50</span>, <span class="dv">20</span>),</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Observed counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">55</span>, <span class="dv">45</span>)</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>emigration</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-emigdat2"</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: 'Emigration data with observed and expected counts'</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(emigration) <span class="sc">|&gt;</span> </span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a>Clearly, the composition in the random sample differs from the overall New Zealand percentages in that particular year. The question is whether these differences can be attributed simply to chance variation, or whether they indicate a definite regional difference between the emigration pattern from Wellington and that of New Zealand as a whole?</span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>To test whether the observed values differ significantly from the expected, the Chi-squared statistic is used. Notice that the Greek letter $\chi$, chi, is pronounced "kai" as in the greeting "hi".</span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>$$\chi ^{2} =\sum _{1}^{c}\frac{\left({\text {Observed-Expected}}\right)^2 }{{\text {Expected}}}  =\sum _{1}^{c}\frac{\left( O-E\right)^{2}}{E}$$ </span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a>There are three points to be noted here:</span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a>a.  The summation is over every cell (that is every count).</span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a>b.  The Chi-squared statistic has a continuous distribution. Like the *t* distribution, its shape depends on the degrees of freedom; in general, its curve is skewed to the right. With $c$ categories, the degrees of freedom is equal to $(c-1)$.</span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a>c.  We are employing the Chi-squared statistic with data which consists of integers. That is, the data are discrete rather than continuous. In consequence, the above formula for Chi-squared statistic is only approximate but the approximation is very good if each expected value is greater than 5 and it is often good even if some expected values are as small as 1.</span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a>For the emigration example, </span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a>\chi^2 &amp;= (100-130)^2/130 + (55-50)^2/50 + (45-20)^2/20 <span class="sc">\\</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a>&amp;= 6.92 + 0.5 + 31.25 <span class="sc">\\</span></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a>&amp;= 38.67</span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a>\end{aligned}   </span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a>with 2 degrees of freedom.</span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a>From the tables of $\chi^2$ distribution, 38.67 is much larger than the tabulated value of 13.82 so that the area (probability) greater than this value is only 0.001. In other words, the probability of such a high value of Chi-squared by chance is very small, indeed less than 0.001 or 0.1%. This leads us to reject, at the 0.1% level, the assumption that the age composition of emigrants (from Wellington) agrees with the overall New Zealand yearly figures. This suggests a difference in the age distribution of emigrants. Notice that the contributions to the Chi-squared statistic are reasonably small for categories A and B, but category C contributes a large value of 31.25. It would appear that the emigrants from Wellington are older.</span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a>There is an interesting historical situation in which Chi-squared statistics were used to demonstrate the experimental results had been fudged. Gregor Mendel (1822-1884) has some claim to being called the father of modern genetics. @Freedman2007 in their book 'Statistics' gave the following explanation.</span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "*Mendel's experiments were all carried out on garden peas. Pea seeds are either yellow or green, and a plant can bear seeds of both colours. Mendel bred a pure yellow strain, that is, a strain in which every plant in every generation had only yellow seeds; and separately he bred a pure green strain. He then crossed plants of the pure yellow strain with plants of the pure green strain. For instance, he used pollen from the yellows to fertilise ovules on plants of the green strain. (The alternative method using pollen from the greens to fertilise plants of the yellow strain, gave exactly the same results). The seeds resulting from a yellow-green cross, and the plants in to which they grow, are called first-generation hybrids. First-generation hybrid seeds are all yellow, indistinguishable from seeds of the pure yellow strain. So the green seems to have disappeared completely.*</span><span class="kw">&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "*These first-generation hybrid seeds grew into first-generation hybrid plants which Mendel crossed with themselves, producing second-generation hybrid seeds. Some of these second-generation seeds were yellow, but some were green. So the green disappeared for one generation, but reappeared in the second. Even more surprising, the green reappeared in a definite simple proportion: of the second-generation hybrid seeds, about 75% were yellow and 25% were green.*</span><span class="kw">&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "*What is behind this regularity? To explain it, Mendel postulated the existence of the entities now called genes. The genes of the yellow strain were dominant while the genes of the green strain were recessive. This caused the yellow colouring of the first-generation hybrids.*"</span></span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a>Of course, the situation becomes more complicated if more than one attribute is considered. In one of Mendel's trials he also considered whether the peas were smooth or wrinkled in appearance. The ratio for four types of peas was expected to be 9:3:3:1. The observed and expected numbers in the four categories were as shown in @tbl-menpea.</span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a>Mendel <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Type of pea</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Smooth yellow"</span>, </span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Wrinkled yellow"</span>, </span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Smooth green"</span>, </span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Wrinkled green"</span>), </span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Expected counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">313</span>, <span class="dv">104</span>, <span class="dv">104</span>, <span class="dv">35</span>),</span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Observed counts</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">315</span>, <span class="dv">101</span>, <span class="dv">108</span>, <span class="dv">32</span>)</span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-141"><a href="#cb45-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-142"><a href="#cb45-142" aria-hidden="true" tabindex="-1"></a>Mendel</span>
<span id="cb45-143"><a href="#cb45-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-144"><a href="#cb45-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-145"><a href="#cb45-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-148"><a href="#cb45-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-149"><a href="#cb45-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-150"><a href="#cb45-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-menpea"</span></span>
<span id="cb45-151"><a href="#cb45-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Pea observed and expected counts"</span></span>
<span id="cb45-152"><a href="#cb45-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-153"><a href="#cb45-153" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Mendel) <span class="sc">|&gt;</span> </span>
<span id="cb45-154"><a href="#cb45-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-155"><a href="#cb45-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-156"><a href="#cb45-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-157"><a href="#cb45-157" aria-hidden="true" tabindex="-1"></a>The observed results are very close to those expected and therefore a very small Chi-squared value is obtained. Sir R A Fisher (1890--1962) has some claim to being the father of inferential statistics. He examined the results of a number of Mendel's experiments and discovered that, without exception, the Chi-squared values were much smaller than expected. While one can be lucky on a few occasions obtaining results close to what a theory suggests, the probability that the Chi-squared values would be small in every experiment is so low as to be unbelievable. Did the great Mendel cheat? @Fisher1936 gave him the benefit of the doubt but noted that Mendel's assistant may well have been aware of the anticipated results and consciously, or unconsciously, had classified the peas in the appropriate cell. After all, it was not always easy to classify some of the pea seeds. The moral is that some people are just too helpful.</span>
<span id="cb45-158"><a href="#cb45-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-159"><a href="#cb45-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Goodness of Fit for Distributions</span></span>
<span id="cb45-160"><a href="#cb45-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-161"><a href="#cb45-161" aria-hidden="true" tabindex="-1"></a>When testing for the goodness of fit for a distribution, observations in various non-overlapping ranges are classified into categories and a frequency count is obtained for each category or range. These (observed) frequency counts are compared to the counts which would be obtained if the hypothesised distribution fitted the data exactly. We call these counts the expected counts. In general one assumes that the parameters of the hypothesised distribution equal the estimates obtained from the data. Thus we are effectively just testing whether the *shape* of the hypothesised distribution is correct.</span>
<span id="cb45-162"><a href="#cb45-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-163"><a href="#cb45-163" aria-hidden="true" tabindex="-1"></a>For example if a set of data has a sample mean of 10 and sample standard deviation of 2 and we wish to test whether a Normal distribution is appropriate for these data, we hypothesise a Normal distribution with a mean of 10 and a standard deviation of 2. The following Chi-squared statistic can be used to test whether the hypothesised distribution describes the data reasonably well. The idea is to split the number line into, say, $c$ non-overlapping intervals spanning the range of the data. The observed and expected frequency of data in each interval is then compared, using </span>
<span id="cb45-164"><a href="#cb45-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-165"><a href="#cb45-165" aria-hidden="true" tabindex="-1"></a>$$\chi ^{2} =\sum _{1}^{c}\frac{\left({\text   {Observed-Expected}}\right)^2 }{{\text   {Expected}}}  =\sum _{1}^{c}\frac{\left( O-E\right)^{2}}{E},$$ </span>
<span id="cb45-166"><a href="#cb45-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-167"><a href="#cb45-167" aria-hidden="true" tabindex="-1"></a>where again we sum over all $c$ categories. For example, for $n=100$ data we would expect 15.87% to be $\leq 8$, 34.13% to be greater than 8 and $\leq 10$ , 34.13% to be greater than 10 and $\leq 12$, and 15.87% to be $&gt;12$. We would compare our observed counts with these expected ones. Note that expected counts need not be integers, and should not be rounded in the calculation of $\chi^2$, especially if they are small as that can introduce substantial round-off error into $\chi^2$.</span>
<span id="cb45-168"><a href="#cb45-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-169"><a href="#cb45-169" aria-hidden="true" tabindex="-1"></a>The degrees of freedom for this test equals the number of data categories minus one more than the number of parameters estimated $c-1-2 = c-3$ in this case). These tests were covered in your first-year paper. You should revise your notes on them. Note that we have seen in Chapter 4 that it is possible to test for normality using an tests such as Shapiro-Wilk test.</span>
<span id="cb45-170"><a href="#cb45-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-171"><a href="#cb45-171" aria-hidden="true" tabindex="-1"></a><span class="fu"># Contingency Tables</span></span>
<span id="cb45-172"><a href="#cb45-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-173"><a href="#cb45-173" aria-hidden="true" tabindex="-1"></a>Contingency tables are frequency counts arranged in a two way table. We can test for independence between the rows and columns of such a table using a Chi-squared statistic. There are two main points which need to be noted:</span>
<span id="cb45-174"><a href="#cb45-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-175"><a href="#cb45-175" aria-hidden="true" tabindex="-1"></a>**(a)**</span>
<span id="cb45-176"><a href="#cb45-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-177"><a href="#cb45-177" aria-hidden="true" tabindex="-1"></a>:   Expected values can be obtained by assuming that the row variable is **independent** of the column variable. In practice, this means that the expected count for cell $(i,j)$ is given by $E_{ij}$ where</span>
<span id="cb45-178"><a href="#cb45-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-179"><a href="#cb45-179" aria-hidden="true" tabindex="-1"></a><span class="in">    $$E_{ij} = (T_i \times T_j)/n$$</span></span>
<span id="cb45-180"><a href="#cb45-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-181"><a href="#cb45-181" aria-hidden="true" tabindex="-1"></a><span class="in">    in which $T_i$ = total for row $i$, $T_j$ = total for column $j$ and $n$ = overall total count</span></span>
<span id="cb45-182"><a href="#cb45-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-183"><a href="#cb45-183" aria-hidden="true" tabindex="-1"></a>**(b)**</span>
<span id="cb45-184"><a href="#cb45-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-185"><a href="#cb45-185" aria-hidden="true" tabindex="-1"></a>:   The **degrees of freedom** are given by $(r-1)\times(c-1)$ where $r$ is the number of rows and $c$ is the number of columns.</span>
<span id="cb45-186"><a href="#cb45-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-187"><a href="#cb45-187" aria-hidden="true" tabindex="-1"></a>These points will be illustrated in the example below on Porcine Stress Syndrome. The Chi-squared statistic is constructed in the same way as before, i.e.</span>
<span id="cb45-188"><a href="#cb45-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-189"><a href="#cb45-189" aria-hidden="true" tabindex="-1"></a>$$\chi ^{2} =\sum _{i=1}^{r}\sum _{j=1}^{c}\frac{\left({ O}_{{ ij}} { -E}_{{ij}} \right)^{{ 2}} }{{ E}_{{ij}} }.$$</span>
<span id="cb45-190"><a href="#cb45-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-191"><a href="#cb45-191" aria-hidden="true" tabindex="-1"></a>A useful way of thinking about the $\chi ^2$ is the following. If we think of the difference between the observed and expected values as a residual, then we can write:</span>
<span id="cb45-192"><a href="#cb45-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-193"><a href="#cb45-193" aria-hidden="true" tabindex="-1"></a>$$\chi ^{2} =\sum \frac{\left({\text {O-E}}\right)^{2} }{{\text E}} =\sum \frac{\left({\text {residual}}\right)^{2} }{{\text {fit}}}.$$</span>
<span id="cb45-194"><a href="#cb45-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-195"><a href="#cb45-195" aria-hidden="true" tabindex="-1"></a>In more theoretical courses, you may learn that data expressed as counts often follows a Poisson distribution in which the mean equals the variance. If you substitute variance for fit in the formula, you get</span>
<span id="cb45-196"><a href="#cb45-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-197"><a href="#cb45-197" aria-hidden="true" tabindex="-1"></a>$$\chi ^{2} =\sum \frac{\left({\text {residual}}\right)^{2} }{{\text {variance}}} =\sum \left(\frac{{\text {residual}}}{{\text {std dev}}} \right)^{2}.$$ which looks like a sum of squared standardised residuals. As noted in chapter 6 any standardised residuals which are greater than 2 (approximately) in absolute value can be regarded as significant. Squaring this we find that any cell which makes a contribution of more than 4 to the Chi-squared statistic is a significant source of the dependence between rows and columns. So this idea helps in the interpretation of contingency tables. Any cells contributing more than 4 to the Chi-squared statistic should be studied carefully in order to gain an understanding regarding the nature of any dependence between the rows and columns.</span>
<span id="cb45-198"><a href="#cb45-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-199"><a href="#cb45-199" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Porcine Stress Syndrome (PSS)</span></span>
<span id="cb45-200"><a href="#cb45-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-201"><a href="#cb45-201" aria-hidden="true" tabindex="-1"></a>Porcine Stress Syndrome (PSS) can result in the development of pale, soft meat in pigs and, under conditions of stress, sudden death. It can therefore result in severe economic loss. It is believed to be controlled by a single gene and its incidence could therefore be reduced by a selective breeding program. In a survey of its incidence, the following results were obtained for four major breeds. (The presence of PSS can be detected by a positive reaction to the breathing of halothane). The observed counts are shown in @tbl-pss1.</span>
<span id="cb45-202"><a href="#cb45-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-205"><a href="#cb45-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-206"><a href="#cb45-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-207"><a href="#cb45-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-208"><a href="#cb45-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-209"><a href="#cb45-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-210"><a href="#cb45-210" aria-hidden="true" tabindex="-1"></a>dpss <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-211"><a href="#cb45-211" aria-hidden="true" tabindex="-1"></a>  <span class="at">Breed =</span> <span class="fu">c</span>(<span class="st">"Large White"</span>, <span class="st">"Hampshire"</span>, <span class="st">"Landrace(B)"</span>, <span class="st">"Landrace(S)"</span>),</span>
<span id="cb45-212"><a href="#cb45-212" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Halothane positive</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">16</span>),</span>
<span id="cb45-213"><a href="#cb45-213" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Halothane negative</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">86</span>, <span class="dv">73</span>, <span class="dv">76</span>)</span>
<span id="cb45-214"><a href="#cb45-214" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb45-215"><a href="#cb45-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-216"><a href="#cb45-216" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb45-217"><a href="#cb45-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-218"><a href="#cb45-218" aria-hidden="true" tabindex="-1"></a>dpss_with_totals <span class="ot">&lt;-</span> dpss <span class="sc">|&gt;</span> </span>
<span id="cb45-219"><a href="#cb45-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb45-220"><a href="#cb45-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Row total"</span>, <span class="st">"Column total"</span>),</span>
<span id="cb45-221"><a href="#cb45-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb45-222"><a href="#cb45-222" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-223"><a href="#cb45-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-224"><a href="#cb45-224" aria-hidden="true" tabindex="-1"></a>dpss_with_totals</span>
<span id="cb45-225"><a href="#cb45-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-226"><a href="#cb45-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-227"><a href="#cb45-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-228"><a href="#cb45-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-231"><a href="#cb45-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-232"><a href="#cb45-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-233"><a href="#cb45-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-pss1"</span></span>
<span id="cb45-234"><a href="#cb45-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: 'Porcine Stress Syndrome (PSS) data'</span></span>
<span id="cb45-235"><a href="#cb45-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-236"><a href="#cb45-236" aria-hidden="true" tabindex="-1"></a>dpss_with_totals <span class="sc">|&gt;</span></span>
<span id="cb45-237"><a href="#cb45-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-238"><a href="#cb45-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-239"><a href="#cb45-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-240"><a href="#cb45-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-241"><a href="#cb45-241" aria-hidden="true" tabindex="-1"></a>Expected values are calculated assuming independence between the rows and columns. This gives the numbers in parentheses in @fig-chisq.</span>
<span id="cb45-242"><a href="#cb45-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-243"><a href="#cb45-243" aria-hidden="true" tabindex="-1"></a><span class="al">![Manual computation of ChSq statistic](images/chisq.png)</span>{#fig-chisq}</span>
<span id="cb45-244"><a href="#cb45-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-245"><a href="#cb45-245" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb45-246"><a href="#cb45-246" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: false --&gt;</span></span>
<span id="cb45-247"><a href="#cb45-247" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| message: false --&gt;</span></span>
<span id="cb45-248"><a href="#cb45-248" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| label: fig-chisq --&gt;</span></span>
<span id="cb45-249"><a href="#cb45-249" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fig-cap: 'Manual computation of ChSq statistic' --&gt;</span></span>
<span id="cb45-250"><a href="#cb45-250" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fig-width: 6 --&gt;</span></span>
<span id="cb45-251"><a href="#cb45-251" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- knitr::include_graphics('images/chisq.png') --&gt;</span></span>
<span id="cb45-252"><a href="#cb45-252" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb45-253"><a href="#cb45-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-254"><a href="#cb45-254" aria-hidden="true" tabindex="-1"></a>For example the expected value in the (3, 2) cell, the number of British Landrace pigs which gave a negative test for halothane, is $$E_{3,2} = T_3 \times T_2 /n = 84 \times 311/343 = 76.2.$$ The Chi-squared statistic is calculated as before using the formula $\chi^2 = \sum(O_{ij} - E_{ij})^2/E_{ij}$. The Chi-square of 16.43 is associated with $(4-1)\times (2-1) = 3$ degrees of freedom, and is therefore *significant* at the 5% level and at the 0.5% level. (Note that the *tabulated value* or *critical value* equals 7.81 at 5% significance level; and 12.8 at the 0.5% level).</span>
<span id="cb45-255"><a href="#cb45-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-256"><a href="#cb45-256" aria-hidden="true" tabindex="-1"></a>Hence, there is strong statistical evidence that there are differences between breeds in the incidence of porcine stress syndrome. In other words, the breed is not independent of the result of the halothane test.</span>
<span id="cb45-257"><a href="#cb45-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-258"><a href="#cb45-258" aria-hidden="true" tabindex="-1"></a>Notice that the large counts in the second column (halothane negative) lead to large expected values but low contributions to the Chi-squared statistics (0.38, 0.35, 0.13 and 0.66). This is not surprising as each of these terms is divided by a large expected value. On the other hand, the small observations of the first column lead to small expected values but larger contributions to the Chi-squared statistic. Any Chi-squared contribution in excess of four (as explained previously) should be interpreted. In this example it is clear that Landrace (Swedish) pigs are more prone to porcine stress syndrome than are the other three breeds.</span>
<span id="cb45-259"><a href="#cb45-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-260"><a href="#cb45-260" aria-hidden="true" tabindex="-1"></a>Another view of the idea of degrees of freedom can be obtained by noting that if the three expected values at the top of Column 2 are calculated (70.7, 80.7 and 76.2) then the remaining expected value can be found by subtraction from the appropriate row or column totals. Thus if the row and column totals are known, then only three numbers inside the contingency table are free before the whole table of numbers is then determined.</span>
<span id="cb45-261"><a href="#cb45-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-262"><a href="#cb45-262" aria-hidden="true" tabindex="-1"></a><span class="fu"># Points to Watch Out For</span></span>
<span id="cb45-263"><a href="#cb45-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-264"><a href="#cb45-264" aria-hidden="true" tabindex="-1"></a>The Chi-squared statistic should only be used with frequency counts. Sometimes, researchers convert the counts in the cells of a table to percentages of the total. For example in @fig-chisq, the cell counts could be divided by 343 and multiplied by 100 to give percentages. In this case, the numbers in the cells would be reduced and the Chi-squared statistic likewise would be reduced from 16.43 to 16.43/343 = 0.048. An incorrect conclusion of independence of rows and columns would be drawn from this statistic.</span>
<span id="cb45-265"><a href="#cb45-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-266"><a href="#cb45-266" aria-hidden="true" tabindex="-1"></a>If the expected value in a cell is small, the contribution to the Chi-squared statistic may be spuriously inflated. It was suggested earlier that an expected value less than 5 may lead to some concern and a very small value of less than 1 should sound warning bells. We suggest the following procedure:</span>
<span id="cb45-267"><a href="#cb45-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-268"><a href="#cb45-268" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>If the Chi-squared statistic is small enough to not be significant, there is no problem.</span>
<span id="cb45-269"><a href="#cb45-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-270"><a href="#cb45-270" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>If the Chi-squared statistic is significant in comparison with tabulated values, then consider the contributions of each cell. If cells with large expected value (that is, greater than 5) contribute a large amount to the Chi-squared statistic, again there is no problem. If cells with expected values less than 5 yield large contributions to the Chi-squared statistic, now you can worry and any declaration of significant values of Chi-squared statistic should be treated with caution.</span>
<span id="cb45-271"><a href="#cb45-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-272"><a href="#cb45-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Paturition in Sows</span></span>
<span id="cb45-273"><a href="#cb45-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-274"><a href="#cb45-274" aria-hidden="true" tabindex="-1"></a>Consider the data on the effects of parturition in sows shown in @tbl-sows1.</span>
<span id="cb45-275"><a href="#cb45-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-278"><a href="#cb45-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-279"><a href="#cb45-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-280"><a href="#cb45-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb45-281"><a href="#cb45-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-282"><a href="#cb45-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-283"><a href="#cb45-283" aria-hidden="true" tabindex="-1"></a>dsow <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-284"><a href="#cb45-284" aria-hidden="true" tabindex="-1"></a>  <span class="at">Condition =</span> <span class="fu">c</span>(<span class="st">"Starvation"</span>, <span class="st">"Overlain"</span>, <span class="st">"Anaemia"</span>, <span class="st">"Infections"</span>, <span class="st">"Birth Defect"</span>),</span>
<span id="cb45-285"><a href="#cb45-285" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Control</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>),</span>
<span id="cb45-286"><a href="#cb45-286" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Injected</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">2</span>)</span>
<span id="cb45-287"><a href="#cb45-287" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb45-288"><a href="#cb45-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-289"><a href="#cb45-289" aria-hidden="true" tabindex="-1"></a>dsow_with_totals <span class="ot">&lt;-</span> dsow <span class="sc">|&gt;</span> </span>
<span id="cb45-290"><a href="#cb45-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb45-291"><a href="#cb45-291" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Row total"</span>, <span class="st">"Column total"</span>),</span>
<span id="cb45-292"><a href="#cb45-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb45-293"><a href="#cb45-293" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-294"><a href="#cb45-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-295"><a href="#cb45-295" aria-hidden="true" tabindex="-1"></a>dsow_with_totals</span>
<span id="cb45-296"><a href="#cb45-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-297"><a href="#cb45-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-298"><a href="#cb45-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-301"><a href="#cb45-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-302"><a href="#cb45-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-303"><a href="#cb45-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-sows1"</span></span>
<span id="cb45-304"><a href="#cb45-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: 'Parturition in sows'</span></span>
<span id="cb45-305"><a href="#cb45-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-306"><a href="#cb45-306" aria-hidden="true" tabindex="-1"></a>dsow_with_totals <span class="sc">|&gt;</span> </span>
<span id="cb45-307"><a href="#cb45-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-308"><a href="#cb45-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-309"><a href="#cb45-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-310"><a href="#cb45-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-311"><a href="#cb45-311" aria-hidden="true" tabindex="-1"></a>In an experiment to consider the effects of parturition in sows, 19 pregnant sows were given intramuscular injections of the drug *prostaglandin* while another 19 pregnant sows served as controls. Of the piglets born to the control sows, 25 died and were autopsied in the first 3 days and, for the treated sows, 40 died and were autopsied in the first 3 days. The chi square test is shown in @fig-chisq2 and then the <span class="in">`R`</span> output follows.</span>
<span id="cb45-312"><a href="#cb45-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-313"><a href="#cb45-313" aria-hidden="true" tabindex="-1"></a><span class="al">![Manual computation of ChSq statistic](images/chisq2.png)</span>{#fig-chisq2}</span>
<span id="cb45-314"><a href="#cb45-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-317"><a href="#cb45-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-318"><a href="#cb45-318" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the variable "Condition" the row names </span></span>
<span id="cb45-319"><a href="#cb45-319" aria-hidden="true" tabindex="-1"></a><span class="co"># so that the data frame contains only the </span></span>
<span id="cb45-320"><a href="#cb45-320" aria-hidden="true" tabindex="-1"></a><span class="co"># two columns and 10 data points </span></span>
<span id="cb45-321"><a href="#cb45-321" aria-hidden="true" tabindex="-1"></a>dsow_dataonly <span class="ot">&lt;-</span> dsow <span class="sc">|&gt;</span> </span>
<span id="cb45-322"><a href="#cb45-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Condition"</span>)</span>
<span id="cb45-323"><a href="#cb45-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-324"><a href="#cb45-324" aria-hidden="true" tabindex="-1"></a>dsow_dataonly</span>
<span id="cb45-325"><a href="#cb45-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-326"><a href="#cb45-326" aria-hidden="true" tabindex="-1"></a>dsow_dataonly <span class="sc">|&gt;</span> <span class="fu">chisq.test</span>()</span>
<span id="cb45-327"><a href="#cb45-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-328"><a href="#cb45-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-329"><a href="#cb45-329" aria-hidden="true" tabindex="-1"></a>Notice that there are four cells whose expected values are less than 5 (4.6, 3.8, 3.1 and 4.9) and their contributions to the Chi-squared statistic are (4.62, 0.19, 2.78 and 1.74). Without these contributions, the Chi-squared statistic would not be significant. The conclusion should then be that there is not enough evidence to conclude that the Chi-squared statistic is significant. So there is not sufficient evidence to conclude that the cause of death depends on whether the injection was given.</span>
<span id="cb45-330"><a href="#cb45-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-331"><a href="#cb45-331" aria-hidden="true" tabindex="-1"></a>If the Chi-square test involves many small expected counts, then we may obtain the $p$-value for the chi square statistic by Monte Carlo simulation (i.e. without relying on the Chi-square approximation). This simulation procedure involves random sampling from the set of all possible contingency tables having the same row and column totals. The <span class="in">`R`</span> function <span class="in">`chisq.test()`</span> can do this for you.</span>
<span id="cb45-332"><a href="#cb45-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-335"><a href="#cb45-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-336"><a href="#cb45-336" aria-hidden="true" tabindex="-1"></a>dsow_dataonly <span class="sc">|&gt;</span> <span class="fu">chisq.test</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-337"><a href="#cb45-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-338"><a href="#cb45-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-339"><a href="#cb45-339" aria-hidden="true" tabindex="-1"></a>As mentioned earlier, the Chi-square test is for actual counts and if you scale them you will get different results. For example, if we multiply Parturition counts by 100, and do the test, the conclusions will change.</span>
<span id="cb45-340"><a href="#cb45-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-343"><a href="#cb45-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-344"><a href="#cb45-344" aria-hidden="true" tabindex="-1"></a>dsow_dataonly_100 <span class="ot">&lt;-</span> dsow_dataonly <span class="sc">|&gt;</span> </span>
<span id="cb45-345"><a href="#cb45-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Control =</span> <span class="dv">100</span> <span class="sc">*</span> Control,</span>
<span id="cb45-346"><a href="#cb45-346" aria-hidden="true" tabindex="-1"></a>         <span class="at">Injected =</span> <span class="dv">100</span> <span class="sc">*</span> Injected) </span>
<span id="cb45-347"><a href="#cb45-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-348"><a href="#cb45-348" aria-hidden="true" tabindex="-1"></a>dsow_dataonly_100</span>
<span id="cb45-349"><a href="#cb45-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-350"><a href="#cb45-350" aria-hidden="true" tabindex="-1"></a>dsow_dataonly_100 <span class="sc">|&gt;</span> <span class="fu">chisq.test</span>()</span>
<span id="cb45-351"><a href="#cb45-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-352"><a href="#cb45-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-353"><a href="#cb45-353" aria-hidden="true" tabindex="-1"></a>We should also be careful when we combine two or more contingency tables into one. The association seen in a particular table may disappear after amalgamation. @Simpson provided the theory on why this happens for contingency tables data and hence this paradox is known as Simpson's paradox even though this was observed by others before him. Consider the following <span class="in">`R`</span> outputs showing the ChiSq test for two separate groups and then the amalgamated group.</span>
<span id="cb45-354"><a href="#cb45-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-355"><a href="#cb45-355" aria-hidden="true" tabindex="-1"></a>For Group 1 counts, the Chi-square test is shown below:</span>
<span id="cb45-356"><a href="#cb45-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-359"><a href="#cb45-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-360"><a href="#cb45-360" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">30</span>), </span>
<span id="cb45-361"><a href="#cb45-361" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">80</span>)) </span>
<span id="cb45-362"><a href="#cb45-362" aria-hidden="true" tabindex="-1"></a>group1</span>
<span id="cb45-363"><a href="#cb45-363" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(group1)</span>
<span id="cb45-364"><a href="#cb45-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-365"><a href="#cb45-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-366"><a href="#cb45-366" aria-hidden="true" tabindex="-1"></a>For group 2 counts, the Chi-square test is shown below:</span>
<span id="cb45-367"><a href="#cb45-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-370"><a href="#cb45-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-371"><a href="#cb45-371" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">25</span>),</span>
<span id="cb45-372"><a href="#cb45-372" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">20</span>))</span>
<span id="cb45-373"><a href="#cb45-373" aria-hidden="true" tabindex="-1"></a>group2</span>
<span id="cb45-374"><a href="#cb45-374" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(group2)</span>
<span id="cb45-375"><a href="#cb45-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-376"><a href="#cb45-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-377"><a href="#cb45-377" aria-hidden="true" tabindex="-1"></a>For the amalgamated contingency table, we obtain-</span>
<span id="cb45-378"><a href="#cb45-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-381"><a href="#cb45-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-382"><a href="#cb45-382" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">55</span>),</span>
<span id="cb45-383"><a href="#cb45-383" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(<span class="dv">195</span>,<span class="dv">100</span>))</span>
<span id="cb45-384"><a href="#cb45-384" aria-hidden="true" tabindex="-1"></a>all</span>
<span id="cb45-385"><a href="#cb45-385" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(all)</span>
<span id="cb45-386"><a href="#cb45-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-387"><a href="#cb45-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-388"><a href="#cb45-388" aria-hidden="true" tabindex="-1"></a>Evidently the association seen in the subgroups is lost after amalgamation.</span>
<span id="cb45-389"><a href="#cb45-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-390"><a href="#cb45-390" aria-hidden="true" tabindex="-1"></a>The opposite can also happen. That is, when populations are separated somewhat parallelly by a factor like Gender, the overall association may not filter to the same level of association for the two gender groups.</span>
<span id="cb45-391"><a href="#cb45-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-392"><a href="#cb45-392" aria-hidden="true" tabindex="-1"></a><span class="fu"># Square contingency tables</span></span>
<span id="cb45-393"><a href="#cb45-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-394"><a href="#cb45-394" aria-hidden="true" tabindex="-1"></a>Assume that two observers independently classifying the same $n$ items into the same $k$ categories. The resulting contingency table becomes a $k \times k$ square contingency table. In biostatistical studies, such square contingency tables are common. Often such contingency tables would have very low cell counts for the off-diagonal cells. The main interest with a square contingency table is the assessment or measurement of the agreement between rows and columns. So there is no need to perform any ChiSq test. @tbl-britrel gives the religion of origin cross-classified by current religion using the six groupings in Britain (data taken from @Breen).</span>
<span id="cb45-395"><a href="#cb45-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-398"><a href="#cb45-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-399"><a href="#cb45-399" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-400"><a href="#cb45-400" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-401"><a href="#cb45-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-402"><a href="#cb45-402" aria-hidden="true" tabindex="-1"></a>drel <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-403"><a href="#cb45-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">Row =</span> <span class="fu">c</span>(<span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"R3"</span>, <span class="st">"R4"</span>, <span class="st">"R5"</span>, <span class="st">"R6"</span>),</span>
<span id="cb45-404"><a href="#cb45-404" aria-hidden="true" tabindex="-1"></a>    <span class="at">R1 =</span> <span class="fu">c</span>(<span class="dv">123</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb45-405"><a href="#cb45-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">420</span>, <span class="dv">21</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>), </span>
<span id="cb45-406"><a href="#cb45-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">R3 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">102</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb45-407"><a href="#cb45-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">R4 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb45-408"><a href="#cb45-408" aria-hidden="true" tabindex="-1"></a>    <span class="at">R5 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">1</span>), </span>
<span id="cb45-409"><a href="#cb45-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">R6 =</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">217</span>, <span class="dv">54</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">62</span>)</span>
<span id="cb45-410"><a href="#cb45-410" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb45-411"><a href="#cb45-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-412"><a href="#cb45-412" aria-hidden="true" tabindex="-1"></a>drel <span class="sc">|&gt;</span> </span>
<span id="cb45-413"><a href="#cb45-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb45-414"><a href="#cb45-414" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"ROW TOTAL"</span>, <span class="st">"COL TOTAL"</span>), </span>
<span id="cb45-415"><a href="#cb45-415" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb45-416"><a href="#cb45-416" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-417"><a href="#cb45-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-418"><a href="#cb45-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-419"><a href="#cb45-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-422"><a href="#cb45-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-423"><a href="#cb45-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-britrel</span></span>
<span id="cb45-424"><a href="#cb45-424" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: 'Crosstabulation of origin religion by current religion'</span></span>
<span id="cb45-425"><a href="#cb45-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-426"><a href="#cb45-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-427"><a href="#cb45-427" aria-hidden="true" tabindex="-1"></a>drel <span class="sc">|&gt;</span> </span>
<span id="cb45-428"><a href="#cb45-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb45-429"><a href="#cb45-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"ROW TOTAL"</span>, <span class="st">"COL TOTAL"</span>), </span>
<span id="cb45-430"><a href="#cb45-430" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb45-431"><a href="#cb45-431" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb45-432"><a href="#cb45-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-433"><a href="#cb45-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-434"><a href="#cb45-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-435"><a href="#cb45-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-436"><a href="#cb45-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-437"><a href="#cb45-437" aria-hidden="true" tabindex="-1"></a>The agreement between the origin and current religion can be visualised using the agreement plot available in the <span class="in">`vcd`</span> package (@fig-agreementplot). (Note, some functions require the data to be in numerical matrix format.)</span>
<span id="cb45-438"><a href="#cb45-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-441"><a href="#cb45-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-442"><a href="#cb45-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-443"><a href="#cb45-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-agreementplot</span></span>
<span id="cb45-444"><a href="#cb45-444" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Agreement plot for origin vs religion'</span></span>
<span id="cb45-445"><a href="#cb45-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb45-446"><a href="#cb45-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb45-447"><a href="#cb45-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-448"><a href="#cb45-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-449"><a href="#cb45-449" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb45-450"><a href="#cb45-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-451"><a href="#cb45-451" aria-hidden="true" tabindex="-1"></a>drelmatrix <span class="ot">&lt;-</span> drel <span class="sc">|&gt;</span> </span>
<span id="cb45-452"><a href="#cb45-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Row"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-453"><a href="#cb45-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb45-454"><a href="#cb45-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-455"><a href="#cb45-455" aria-hidden="true" tabindex="-1"></a><span class="fu">agreementplot</span>(drelmatrix)</span>
<span id="cb45-456"><a href="#cb45-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-457"><a href="#cb45-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-458"><a href="#cb45-458" aria-hidden="true" tabindex="-1"></a>Evidently there is a strong agreement between rows and columns. One of the popular measures for measuring agreement is the Cohen's kappa. This statistic is the diagonal sum of the relative frequencies, corrected for expected values and standardized by its maximum value. In case of complete agreement, the kappa coefficient will be unity. For the religion example, the kappa value is not actually high.</span>
<span id="cb45-459"><a href="#cb45-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-462"><a href="#cb45-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-463"><a href="#cb45-463" aria-hidden="true" tabindex="-1"></a><span class="fu">Kappa</span>(drelmatrix)</span>
<span id="cb45-464"><a href="#cb45-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-465"><a href="#cb45-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-466"><a href="#cb45-466" aria-hidden="true" tabindex="-1"></a>This topic is not covered in depth. It is sufficient if you recognise the special form of two-way contingency table such as this one.</span>
<span id="cb45-467"><a href="#cb45-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-468"><a href="#cb45-468" aria-hidden="true" tabindex="-1"></a><span class="fu"># Correspondence Analysis (CA)</span></span>
<span id="cb45-469"><a href="#cb45-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-470"><a href="#cb45-470" aria-hidden="true" tabindex="-1"></a>**Correspondence Analysis** is an exploratory statistical technique for assessing the interdependence of categorical variables whose data are presented primarily in the form of a two-way table of frequencies (or ***contingency table***). Applied in an advanced way, the methodology can help researchers to "quantify the qualitative data" found in many disciplines. However we will introduce CA at a very basic level, just picking up on those aspects that can help one interpret a contingency table.</span>
<span id="cb45-471"><a href="#cb45-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-472"><a href="#cb45-472" aria-hidden="true" tabindex="-1"></a>CA requires only a rectangular data matrix (cross-tabulation) of non-negative counts-but the number of rows and columns must be 3 or more. The rows and columns do not have to have predefined meanings but instead must represent the responses to categorical variables. Where there are just two variables (one each for rows and columns) the analysis is called **Simple Correspondence Analysis**. The analysis of cross-tabulations of three or more variables is called **Multiple Correspondence Analysis**. This is beyond the scope of this paper.</span>
<span id="cb45-473"><a href="#cb45-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-474"><a href="#cb45-474" aria-hidden="true" tabindex="-1"></a>We shall illustrate some of the basic ideas behind CA using a simple example. Consider @tbl-smoke of frequencies (or *contingency table*) of *smokers* in a random sample of 193 personnel (*staff group*) from an organisation (data from Correspondence Analysis in Practice by Greenacre, 1993). A significant association between smoking status and staff groupings can be observed with the Chi-square test.</span>
<span id="cb45-475"><a href="#cb45-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-478"><a href="#cb45-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-479"><a href="#cb45-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-480"><a href="#cb45-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-481"><a href="#cb45-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-482"><a href="#cb45-482" aria-hidden="true" tabindex="-1"></a>dsmo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-483"><a href="#cb45-483" aria-hidden="true" tabindex="-1"></a>  <span class="at">Groups =</span> <span class="fu">c</span>(<span class="st">"Junior employees"</span>, <span class="st">"Junior managers"</span>, </span>
<span id="cb45-484"><a href="#cb45-484" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Secretaries"</span>, <span class="st">"Senior employees"</span>, <span class="st">"Senior managers"</span>),</span>
<span id="cb45-485"><a href="#cb45-485" aria-hidden="true" tabindex="-1"></a>  <span class="at">None =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">4</span>),</span>
<span id="cb45-486"><a href="#cb45-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">Moderate =</span> <span class="fu">c</span>(<span class="dv">57</span>, <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">22</span>, <span class="dv">5</span>),</span>
<span id="cb45-487"><a href="#cb45-487" aria-hidden="true" tabindex="-1"></a>  <span class="at">Heavy =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb45-488"><a href="#cb45-488" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb45-489"><a href="#cb45-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-490"><a href="#cb45-490" aria-hidden="true" tabindex="-1"></a>dsmo <span class="sc">|&gt;</span> </span>
<span id="cb45-491"><a href="#cb45-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb45-492"><a href="#cb45-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"ROW TOTAL"</span>, <span class="st">"COL TOTAL"</span>), </span>
<span id="cb45-493"><a href="#cb45-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb45-494"><a href="#cb45-494" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-495"><a href="#cb45-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-496"><a href="#cb45-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-497"><a href="#cb45-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-500"><a href="#cb45-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-501"><a href="#cb45-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-502"><a href="#cb45-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-smoke"</span></span>
<span id="cb45-503"><a href="#cb45-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: 'Smoking Status vis-a-vis Staff Groupings'</span></span>
<span id="cb45-504"><a href="#cb45-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-505"><a href="#cb45-505" aria-hidden="true" tabindex="-1"></a>dsmo <span class="sc">|&gt;</span> </span>
<span id="cb45-506"><a href="#cb45-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(</span>
<span id="cb45-507"><a href="#cb45-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"ROW TOTAL"</span>, <span class="st">"COL TOTAL"</span>), </span>
<span id="cb45-508"><a href="#cb45-508" aria-hidden="true" tabindex="-1"></a>    <span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)</span>
<span id="cb45-509"><a href="#cb45-509" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb45-510"><a href="#cb45-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-511"><a href="#cb45-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-512"><a href="#cb45-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-513"><a href="#cb45-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-514"><a href="#cb45-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, warning=FALSE}</span></span>
<span id="cb45-515"><a href="#cb45-515" aria-hidden="true" tabindex="-1"></a>dsmo <span class="sc">|&gt;</span> <span class="fu">column_to_rownames</span>(<span class="st">"Groups"</span>) <span class="sc">|&gt;</span> <span class="fu">chisq.test</span>()</span>
<span id="cb45-516"><a href="#cb45-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-517"><a href="#cb45-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-518"><a href="#cb45-518" aria-hidden="true" tabindex="-1"></a>Suppose we think that there are differences in the smoking status of the various staff groups. One way to investigate these differences would be to calculate **row profiles**. That is, *we divide each entry in a particular row by the total for that row*, and multiply by 100%. The set of percentages for each staff group are then called the row profile for that group. The row profiles are shown in @tbl-rowprofiles (ignore for a moment the row labelled "Row.Mass").</span>
<span id="cb45-519"><a href="#cb45-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-522"><a href="#cb45-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-523"><a href="#cb45-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-524"><a href="#cb45-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-525"><a href="#cb45-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-526"><a href="#cb45-526" aria-hidden="true" tabindex="-1"></a>dsmomatrix <span class="ot">&lt;-</span> dsmo <span class="sc">|&gt;</span> </span>
<span id="cb45-527"><a href="#cb45-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Groups"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-528"><a href="#cb45-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb45-529"><a href="#cb45-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-530"><a href="#cb45-530" aria-hidden="true" tabindex="-1"></a>rowtotal <span class="ot">=</span> <span class="fu">rowSums</span>(dsmomatrix)</span>
<span id="cb45-531"><a href="#cb45-531" aria-hidden="true" tabindex="-1"></a>rowprofile <span class="ot">=</span> dsmomatrix<span class="sc">/</span>rowtotal</span>
<span id="cb45-532"><a href="#cb45-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-533"><a href="#cb45-533" aria-hidden="true" tabindex="-1"></a>coltotal <span class="ot">=</span> <span class="fu">colSums</span>(dsmomatrix)</span>
<span id="cb45-534"><a href="#cb45-534" aria-hidden="true" tabindex="-1"></a>colprofile <span class="ot">=</span> dsmomatrix<span class="sc">/</span>coltotal</span>
<span id="cb45-535"><a href="#cb45-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-536"><a href="#cb45-536" aria-hidden="true" tabindex="-1"></a>Row.Mass <span class="ot">=</span> coltotal<span class="sc">/</span><span class="fu">sum</span>(dsmomatrix)</span>
<span id="cb45-537"><a href="#cb45-537" aria-hidden="true" tabindex="-1"></a>Column.Mass <span class="ot">=</span> rowtotal<span class="sc">/</span><span class="fu">sum</span>(dsmomatrix)</span>
<span id="cb45-538"><a href="#cb45-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-539"><a href="#cb45-539" aria-hidden="true" tabindex="-1"></a>rowpf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rowprofile, Row.Mass) <span class="sc">|&gt;</span> </span>
<span id="cb45-540"><a href="#cb45-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-541"><a href="#cb45-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb45-542"><a href="#cb45-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-543"><a href="#cb45-543" aria-hidden="true" tabindex="-1"></a>rowpf</span>
<span id="cb45-544"><a href="#cb45-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-545"><a href="#cb45-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-546"><a href="#cb45-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-549"><a href="#cb45-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-550"><a href="#cb45-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-551"><a href="#cb45-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-rowprofiles"</span></span>
<span id="cb45-552"><a href="#cb45-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Row Profiles"</span></span>
<span id="cb45-553"><a href="#cb45-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-554"><a href="#cb45-554" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(rowpf)  <span class="sc">|&gt;</span> </span>
<span id="cb45-555"><a href="#cb45-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-556"><a href="#cb45-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-557"><a href="#cb45-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-558"><a href="#cb45-558" aria-hidden="true" tabindex="-1"></a>Comparing the profiles among the various staff groups we see that they generally have a similar shape (small % of 'none', large % of 'moderate' and small % of 'heavy') but there are subtle differences. In particular a much larger percentage of secretaries and senior employees were in the 'none' group, than was the case for junior employees and junior managers, with senior managers in between. The row 'mass' can be interpreted as the marginal (average) profile for the smoking status and is found by dividing each column total by the overall total. The profiles can also be plotted as in @fig-rowprofiles1 to facilitate comparisons.</span>
<span id="cb45-559"><a href="#cb45-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-562"><a href="#cb45-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-563"><a href="#cb45-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-564"><a href="#cb45-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rowprofiles1</span></span>
<span id="cb45-565"><a href="#cb45-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Graphical display of Row Profiles'</span></span>
<span id="cb45-566"><a href="#cb45-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-567"><a href="#cb45-567" aria-hidden="true" tabindex="-1"></a>rowprofile_long <span class="ot">&lt;-</span> rowprofile <span class="sc">|&gt;</span> </span>
<span id="cb45-568"><a href="#cb45-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-569"><a href="#cb45-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Staff Group"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-570"><a href="#cb45-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>None<span class="sc">:</span>Heavy,</span>
<span id="cb45-571"><a href="#cb45-571" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Smoking Status"</span>,</span>
<span id="cb45-572"><a href="#cb45-572" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Row Profiles"</span></span>
<span id="cb45-573"><a href="#cb45-573" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb45-574"><a href="#cb45-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-575"><a href="#cb45-575" aria-hidden="true" tabindex="-1"></a>rowprofile_long <span class="sc">|&gt;</span> </span>
<span id="cb45-576"><a href="#cb45-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb45-577"><a href="#cb45-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Staff Group</span><span class="st">`</span>,</span>
<span id="cb45-578"><a href="#cb45-578" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">Row Profiles</span><span class="st">`</span>,</span>
<span id="cb45-579"><a href="#cb45-579" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">`</span><span class="at">Smoking Status</span><span class="st">`</span>,</span>
<span id="cb45-580"><a href="#cb45-580" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">`</span><span class="at">Smoking Status</span><span class="st">`</span>,</span>
<span id="cb45-581"><a href="#cb45-581" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="st">`</span><span class="at">Smoking Status</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb45-582"><a href="#cb45-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-583"><a href="#cb45-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb45-584"><a href="#cb45-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb45-585"><a href="#cb45-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-586"><a href="#cb45-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-587"><a href="#cb45-587" aria-hidden="true" tabindex="-1"></a>An alternative analysis could be based on the column percentages (**column profiles**) by dividing the entries in each column of the @tbl-columnprofiles by each column's total.</span>
<span id="cb45-588"><a href="#cb45-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-591"><a href="#cb45-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-592"><a href="#cb45-592" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-593"><a href="#cb45-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-594"><a href="#cb45-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-595"><a href="#cb45-595" aria-hidden="true" tabindex="-1"></a>colpf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(colprofile, Column.Mass) <span class="sc">|&gt;</span> </span>
<span id="cb45-596"><a href="#cb45-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-597"><a href="#cb45-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb45-598"><a href="#cb45-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-599"><a href="#cb45-599" aria-hidden="true" tabindex="-1"></a>colpf</span>
<span id="cb45-600"><a href="#cb45-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-601"><a href="#cb45-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-602"><a href="#cb45-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-605"><a href="#cb45-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-606"><a href="#cb45-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-607"><a href="#cb45-607" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-columnprofiles"</span></span>
<span id="cb45-608"><a href="#cb45-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Column Profiles"</span></span>
<span id="cb45-609"><a href="#cb45-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-610"><a href="#cb45-610" aria-hidden="true" tabindex="-1"></a>colpf <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-611"><a href="#cb45-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-612"><a href="#cb45-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-613"><a href="#cb45-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-614"><a href="#cb45-614" aria-hidden="true" tabindex="-1"></a>The 'mass' column is then based on the total' column in @tbl-columnprofiles, and can be interpreted as the marginal percentage of employees in each staff group. Looking at the column profiles displayed in @tbl-columnprofiles, for example, we notice that of the 107 moderate smokers in the survey, 53.3% are junior employees compared to 45.6% of the sample as a whole. Moreover this profile is fairly similar to that of the 'heavy' smokers. The profile for non-smokers, however, is quite different. In particular more than average of the senior employees are non-smokers. Whether we analyse the data by considering the row profiles or the column profiles, we should arrive at a similar conclusion. In each case we can compare the row (column) profile to the row (column) average (mass). As we should come to much the same conclusion either way, this approach is known as 'symmetric consideration' of the rows and columns.</span>
<span id="cb45-615"><a href="#cb45-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-616"><a href="#cb45-616" aria-hidden="true" tabindex="-1"></a>There are further methods available to investigate the dependency in a contingency table which are beyond the scope of this course. However we will consider one very useful graph called a **Symmetric Plot**. The way this graph is created is that techniques from Linear Algebra are used to define two principal trends within the data. Technically the trends are referred to as inertia, which is a concept we will not go into. What is needful is to know that the trends are represented as the axes of the plot. As these axes are devised automatically -- based purely on the numbers rather than the context -- it can be that they are not easy to interpret. But often they are easily interpreted, especially if you apply a little 'lateral thinking'. So the axes can give a real insight into the data. And even when the axes themselves are not interpretable, this still does not prevent us getting some useful information from the plot. Plotted on this graph are points, corresponding to the row and column categories of the contingency table. The actual location of the points depends on the axes. The main thing is that we can interpret points that are 'near' as being related in some way, while points that are far apart are in some sense opposite.</span>
<span id="cb45-617"><a href="#cb45-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-620"><a href="#cb45-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-621"><a href="#cb45-621" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-622"><a href="#cb45-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-symplot1</span></span>
<span id="cb45-623"><a href="#cb45-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Symmetric plot of smoking data'</span></span>
<span id="cb45-624"><a href="#cb45-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb45-625"><a href="#cb45-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb45-626"><a href="#cb45-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-627"><a href="#cb45-627" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS, <span class="at">exclude =</span> <span class="st">"select"</span>)</span>
<span id="cb45-628"><a href="#cb45-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-629"><a href="#cb45-629" aria-hidden="true" tabindex="-1"></a>dsmomatrix <span class="sc">|&gt;</span> </span>
<span id="cb45-630"><a href="#cb45-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corresp</span>(<span class="at">nf=</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-631"><a href="#cb45-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, .<span class="dv">45</span>))</span>
<span id="cb45-632"><a href="#cb45-632" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>)</span>
<span id="cb45-633"><a href="#cb45-633" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb45-634"><a href="#cb45-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-635"><a href="#cb45-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-636"><a href="#cb45-636" aria-hidden="true" tabindex="-1"></a>Looking at the example of a symmetric plot in @fig-symplot1, we see that Senior Employees are very close to the None category of smokers, while Junior Managers are very close to the Heavy category of smokers. This is graphical display of the information in @tbl-rowprofiles, where these types of workers had the smallest and biggest proportions in the Heavy smokers column respectively -- and the reverse for the 'None' column. The other categories are intermediate -- that is, for example the Secretaries are a lot closer to the Senior Employees in smoking behaviour than to the Junior Managers and so are plotted that way. The Junior Employees most closely resemble the typical profile of a Moderate smoker.</span>
<span id="cb45-637"><a href="#cb45-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-638"><a href="#cb45-638" aria-hidden="true" tabindex="-1"></a>In a symmetric plot, it is also possible to interpret the axes as well. First note that the **horizontal axis is usually by far the most important**. The variable representing the horizontal axis of the Symmetric Plot accounts for the maximum possible variation when compared to the variable representing the vertical axis. Nevertheless the second axis does serve to spread the data out. Now to interpret the first Axis (horizontal), we consider the points at the extreme left and right of the data. As None is far to the right and Heavy and Moderate far to the left, it is reasonable to interpret this axis as largely a contrast between Non-smokers and Smokers (in general). Then how far from right to left the worker groups are, can be interpreted in terms of how far they are from being non-smokers.</span>
<span id="cb45-639"><a href="#cb45-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-640"><a href="#cb45-640" aria-hidden="true" tabindex="-1"></a>To interpret the second Axis (vertical) we note that the workers with the lowest status (Junior Employees and Secretaries) are at the top, both types of Managers (high job status) are at the bottom, and Senior Employees are in the middle. Thus interestingly the program has sorted the workers in terms of Status, even though the sorting was done entirely on the basis of smoking behaviour! However we should not pay equal attention to this axis as it does not represent much variation when compared to the horizontal axis.</span>
<span id="cb45-641"><a href="#cb45-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-642"><a href="#cb45-642" aria-hidden="true" tabindex="-1"></a>As a further example, consider @tbl-eyehair. These are frequencies on colours of eyes (rows) and hair of people (columns) in Caithness, Scotland originally analysed by @Fisher1940.</span>
<span id="cb45-643"><a href="#cb45-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-646"><a href="#cb45-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-647"><a href="#cb45-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-648"><a href="#cb45-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb45-649"><a href="#cb45-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-650"><a href="#cb45-650" aria-hidden="true" tabindex="-1"></a>deh <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-651"><a href="#cb45-651" aria-hidden="true" tabindex="-1"></a>  <span class="at">eye =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"light"</span>, <span class="st">"medium"</span>, <span class="st">"dark"</span>),</span>
<span id="cb45-652"><a href="#cb45-652" aria-hidden="true" tabindex="-1"></a>  <span class="at">fair =</span> <span class="fu">c</span>(<span class="dv">326</span>, <span class="dv">688</span>, <span class="dv">343</span>, <span class="dv">98</span>),</span>
<span id="cb45-653"><a href="#cb45-653" aria-hidden="true" tabindex="-1"></a>  <span class="at">red =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">116</span>, <span class="dv">84</span>, <span class="dv">48</span>),</span>
<span id="cb45-654"><a href="#cb45-654" aria-hidden="true" tabindex="-1"></a>  <span class="at">medium =</span> <span class="fu">c</span>(<span class="dv">241</span>, <span class="dv">584</span>, <span class="dv">909</span>, <span class="dv">403</span>),</span>
<span id="cb45-655"><a href="#cb45-655" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark=</span> <span class="fu">c</span>(<span class="dv">110</span>, <span class="dv">188</span>, <span class="dv">412</span>, <span class="dv">681</span>),</span>
<span id="cb45-656"><a href="#cb45-656" aria-hidden="true" tabindex="-1"></a>  <span class="at">black =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">26</span>, <span class="dv">85</span>)</span>
<span id="cb45-657"><a href="#cb45-657" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb45-658"><a href="#cb45-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"eye"</span>)</span>
<span id="cb45-659"><a href="#cb45-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-660"><a href="#cb45-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-661"><a href="#cb45-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-662"><a href="#cb45-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-665"><a href="#cb45-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-666"><a href="#cb45-666" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb45-667"><a href="#cb45-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "tbl-eyehair"</span></span>
<span id="cb45-668"><a href="#cb45-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Frequency of colours of eyes (rows) and hair (columns) in Caithness, Scotland"</span></span>
<span id="cb45-669"><a href="#cb45-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-670"><a href="#cb45-670" aria-hidden="true" tabindex="-1"></a>deh <span class="sc">|&gt;</span> </span>
<span id="cb45-671"><a href="#cb45-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-672"><a href="#cb45-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span>
<span id="cb45-673"><a href="#cb45-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-674"><a href="#cb45-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-675"><a href="#cb45-675" aria-hidden="true" tabindex="-1"></a>The Chi-square test of association on the above two-way table suggests that there is a significant association between the colours of eyes and hair ($\chi^2$=1240, df = 12, $p$-value $&lt;0.000$).</span>
<span id="cb45-676"><a href="#cb45-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-677"><a href="#cb45-677" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, warning=FALSE}</span></span>
<span id="cb45-678"><a href="#cb45-678" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(deh)</span>
<span id="cb45-679"><a href="#cb45-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-680"><a href="#cb45-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-681"><a href="#cb45-681" aria-hidden="true" tabindex="-1"></a>Given the significant association between row and column variables, it is useful to look for further patterns of association using the symmetric plot given in @fig-symplot2. We see many patterns such as black eyes being associated with dark or black hair etc.</span>
<span id="cb45-682"><a href="#cb45-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-685"><a href="#cb45-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-686"><a href="#cb45-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb45-687"><a href="#cb45-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-symplot2</span></span>
<span id="cb45-688"><a href="#cb45-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Symmetric plot of eye and hair colour'</span></span>
<span id="cb45-689"><a href="#cb45-689" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb45-690"><a href="#cb45-690" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb45-691"><a href="#cb45-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-692"><a href="#cb45-692" aria-hidden="true" tabindex="-1"></a>deh <span class="sc">|&gt;</span> <span class="fu">corresp</span>(<span class="at">nf=</span><span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb45-693"><a href="#cb45-693" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>)</span>
<span id="cb45-694"><a href="#cb45-694" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb45-695"><a href="#cb45-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-696"><a href="#cb45-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-697"><a href="#cb45-697" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary</span></span>
<span id="cb45-698"><a href="#cb45-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-699"><a href="#cb45-699" aria-hidden="true" tabindex="-1"></a>In this chapter, we considered Goodness of Fit Tests and Tests of Association. Two different Goodness of Fit Tests were considered. Chi-square Goodness of Fit Tests are used to test whether a set of frequency data complies with a hypothesised distribution. Only one test of association, the Chi-square Test of Association was considered. For Chi-square tests of association we perform a test on a table of frequencies, that is counts. The null hypothesis is that the row categories are independent of the column categories. A Chi-squared statistic with $(r-1)(c-1)$ degrees of freedom is calculated. The contribution of a cell to the total Chi-squared statistic will be large if $(O-E)$ is large; that is the observed count is considerably different from the expected (fitted) value. We are interested in this difference.</span>
<span id="cb45-700"><a href="#cb45-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-701"><a href="#cb45-701" aria-hidden="true" tabindex="-1"></a>If $E$ is small then the effect may be spurious, and so categories are joined together to ensure that $E$ is not too small. As a rule of thumb, 1 was taken as the smallest value of E provided that no more than 5% of cells have $E&lt;5$.</span>
<span id="cb45-702"><a href="#cb45-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-703"><a href="#cb45-703" aria-hidden="true" tabindex="-1"></a>Simple correspondence analysis helps us to explore relationships in large two-way contingency tables when independence is rejected. We use symmetric plots for reduction of the complexity of the table so that we can understand the nature of relationships between the categorical variables.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>