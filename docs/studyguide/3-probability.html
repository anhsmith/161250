<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>161250 Data Analysis - Chapter 3: Probability Concepts and Distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../studyguide/4-inference.html" rel="next">
<link href="../studyguide/2-eda.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">161250 Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../studyguide/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Study Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/ws01.html" rel="" target="">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-code">    
        <li>
    <a class="dropdown-item" href="../exercises/Chap2more.R" rel="" target="">
 <span class="dropdown-text">Ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap3more.R" rel="" target="">
 <span class="dropdown-text">Ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap4more.R" rel="" target="">
 <span class="dropdown-text">Ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap5more.R" rel="" target="">
 <span class="dropdown-text">Ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap6more.R" rel="" target="">
 <span class="dropdown-text">Ex6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap7more.R" rel="" target="">
 <span class="dropdown-text">Ex7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap8more.R" rel="" target="">
 <span class="dropdown-text">Ex8</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../studyguide/index.html">Study Guide</a></li><li class="breadcrumb-item"><a href="../studyguide/3-probability.html">Chapter 3: Probability Concepts and Distributions</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../studyguide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Study Guide</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/1-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 1: Data Collection and Quality Issues</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/2-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2: Exploratory Data Analysis (EDA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/3-probability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Chapter 3: Probability Concepts and Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/4-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4: Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/5-tabulated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5: Tabulated Counts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/6-single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6: Models with a Single Continuous Predictor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/7-multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7: Models with Multiple Continuous Predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/8-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8: Analysis of Variance (ANOVA) and Covariance (ANCOVA)</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#probability-a-placeholder-for-incomplete-knowledge" id="toc-probability-a-placeholder-for-incomplete-knowledge" class="nav-link" data-scroll-target="#probability-a-placeholder-for-incomplete-knowledge">Probability: a placeholder for incomplete knowledge</a>
  <ul class="collapse">
  <li><a href="#probability-as-a-relative-frequency" id="toc-probability-as-a-relative-frequency" class="nav-link" data-scroll-target="#probability-as-a-relative-frequency">Probability as a relative frequency</a></li>
  <li><a href="#mutually-exclusive-events" id="toc-mutually-exclusive-events" class="nav-link" data-scroll-target="#mutually-exclusive-events">Mutually exclusive events</a></li>
  <li><a href="#statistical-independence" id="toc-statistical-independence" class="nav-link" data-scroll-target="#statistical-independence">Statistical independence</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a>
  <ul class="collapse">
  <li><a href="#blood-group-example" id="toc-blood-group-example" class="nav-link" data-scroll-target="#blood-group-example">Blood group example</a></li>
  <li><a href="#beached-whales-example" id="toc-beached-whales-example" class="nav-link" data-scroll-target="#beached-whales-example">Beached whales example</a></li>
  </ul></li>
  <li><a href="#probability-tree-diagram" id="toc-probability-tree-diagram" class="nav-link" data-scroll-target="#probability-tree-diagram">Probability tree diagram</a>
  <ul class="collapse">
  <li><a href="#rules-of-the-probability-tree" id="toc-rules-of-the-probability-tree" class="nav-link" data-scroll-target="#rules-of-the-probability-tree">Rules of the Probability Tree</a></li>
  </ul></li>
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule">Bayes rule</a></li>
  </ul></li>
  <li><a href="#probability-distributions" id="toc-probability-distributions" class="nav-link" data-scroll-target="#probability-distributions">Probability Distributions</a>
  <ul class="collapse">
  <li><a href="#probability-massdensity-functions" id="toc-probability-massdensity-functions" class="nav-link" data-scroll-target="#probability-massdensity-functions">Probability Mass/Density Functions</a></li>
  <li><a href="#discrete-probability-distributions" id="toc-discrete-probability-distributions" class="nav-link" data-scroll-target="#discrete-probability-distributions">Discrete probability distributions</a>
  <ul class="collapse">
  <li><a href="#binomial-distribution" id="toc-binomial-distribution" class="nav-link" data-scroll-target="#binomial-distribution">Binomial distribution</a></li>
  <li><a href="#poisson-distribution" id="toc-poisson-distribution" class="nav-link" data-scroll-target="#poisson-distribution">Poisson distribution</a></li>
  </ul></li>
  <li><a href="#continuous-probability-distributions" id="toc-continuous-probability-distributions" class="nav-link" data-scroll-target="#continuous-probability-distributions">Continuous probability distributions</a>
  <ul class="collapse">
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution">Normal distribution</a></li>
  <li><a href="#skewed-distributions" id="toc-skewed-distributions" class="nav-link" data-scroll-target="#skewed-distributions">Skewed distributions</a></li>
  <li><a href="#empirical-distributions" id="toc-empirical-distributions" class="nav-link" data-scroll-target="#empirical-distributions">Empirical distributions</a></li>
  <li><a href="#importance-of-the-normal-distribution" id="toc-importance-of-the-normal-distribution" class="nav-link" data-scroll-target="#importance-of-the-normal-distribution">Importance of the normal distribution</a></li>
  <li><a href="#normal-data-in-practice" id="toc-normal-data-in-practice" class="nav-link" data-scroll-target="#normal-data-in-practice">Normal data in practice</a></li>
  <li><a href="#assessment-of-normality" id="toc-assessment-of-normality" class="nav-link" data-scroll-target="#assessment-of-normality">Assessment of Normality</a></li>
  <li><a href="#normal-quantile-quantile-plots" id="toc-normal-quantile-quantile-plots" class="nav-link" data-scroll-target="#normal-quantile-quantile-plots">Normal quantile-quantile plots</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="3-probability.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Chapter 3: Probability Concepts and Distributions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>“<em>Misunderstanding of probability may be the greatest of all impediments to scientific literacy</em>”</p>
<p>— Stephen Jay Gould</p>
</blockquote>
<blockquote class="blockquote">
<p>“<em>Statisticians, like artists, have the bad habit of falling in love with their models.</em>”</p>
<p>— George Box</p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The concept of probability is the foundation of statistical inference. In other words, making inferences about a populations based on a sample relies on probability notions, and any uncertainty in our conclusions can be expressed in probabilistic terms. We also informally used the probability concepts in data collection, particularly with the <em>EPSEM</em> sampling methods.</p>
<p>The concepts we cover in this Chapter will be largely familiar to you from a first year course. Note that we are covering probability concepts and distributions at a very basic level without much maths.</p>
</section>
<section id="probability-a-placeholder-for-incomplete-knowledge" class="level1">
<h1>Probability: a placeholder for incomplete knowledge</h1>
<p>Probability is a mathematical framework used to quantify and describe expectations of random events. Okay, so what is randomness? Where does it come from? This is a philosophical question, really.</p>
<p>From a practical viewpoint, I find it useful to think of randomness and probability as <em>placeholders for incomplete knowledge</em>. If we have complete knowledge of something, we don’t need the concepts of randomness and probability.</p>
<p>To illustrate, when you roll a die, you don’t know what number you’ll get. On inspection of the die, you can see that it has six sides, numbered 1-6. If we assume that it will land on one side, and that there’s equal probability of landing on each of the six sides, then we can form a basic probability model.</p>
<table class="table">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th><span class="math inline">\(P(x)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/6</td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/6</td>
</tr>
<tr class="even">
<td>4</td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1/6</td>
</tr>
<tr class="even">
<td>6</td>
<td>1/6</td>
</tr>
</tbody>
</table>
<p>There are six possible outcomes with equal probability, so the probability of each is 1/6. The probabilities sum to 1.</p>
<p>Where does the randomness come into this scenario? Is there randomness inherent in the process of rolling a die? I would say no. If we had complete knowledge of the system, including the shape of the die, the starting position, the angle and velocity with which it is thrown, and the shape and texture of the surface it lands on, and a good physical model of how these things interact, then we could theoretically be able to predict perfectly the number on which it will land. The trouble is, of course, that all this information is extremely difficult to collect in enough detail to allow us to make such a prediction.</p>
<p>A simpler case is a shuffled deck of cards. When you shuffle a deck of cards for long enough, we’d consider the question of which card is on the top to be random. However, if we knew the starting conditions and exactly how the cards were shuffled, then there’s no randomness, and no need for a probability model.</p>
<p>But most of the world isn’t as simple as shuffling cards or even rolling a die. Our knowledge is so very limited that concepts of uncertainty, randomness, and probability are indispensable to anyone who wants to make any real sense of it.</p>
<section id="probability-as-a-relative-frequency" class="level2">
<h2 class="anchored" data-anchor-id="probability-as-a-relative-frequency">Probability as a relative frequency</h2>
<p>The naive or classical definition of probability is just a relative frequency. If <span class="math inline">\(n\)</span> is the total number of equally likely possible outcomes and if <span class="math inline">\(m\)</span> of those <span class="math inline">\(n\)</span> outcomes result in the occurrence of some given event, then the probability of that event is <span class="math inline">\(m/n\)</span>.</p>
<p>For example, if a fair die is rolled, there are <span class="math inline">\(n = 6\)</span> possible outcomes. Let the event of interest be <em>getting a number 4 or more</em>. So, the probability of this event is 3 out of 6 or <span class="math inline">\(p=1/2\)</span>.</p>
<p>The <em>sample space</em> or the set of all possible outcomes need not be finite. For example, tossing a coin until the first head appears will result in an infinite sample space.So, the probability can be viewed as a limiting or long run fraction of <span class="math inline">\(m/n\)</span> (i.e.&nbsp;when <span class="math inline">\(n \to \infty\)</span>).</p>
<p>When the sample space is finite and outcomes are equally likely, we can assume that classical probability will be the same as empirical probability. Note that to find the probability of a fair coin landing heads it is not necessary to toss the coin repeatedly and observe the proportion of heads. So when the number of trails is reasonably large, empirical probability may be treated as the true value.</p>
<p>Subjective probability (such as expert opinion) is useful in areas such as decision theory, and its definition does not fit as a relative frequency.</p>
<p>Probabilities can only be between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (impossible to certain).</p>
</section>
<section id="mutually-exclusive-events" class="level2">
<h2 class="anchored" data-anchor-id="mutually-exclusive-events">Mutually exclusive events</h2>
<p>A German researcher <span class="citation" data-cites="witt">(<a href="#ref-witt" role="doc-biblioref">Witt 1956</a>)</span> studied the effects of various drugs on the web-building abilities of orb-web spiders (<a href="#fig-webs">Figure&nbsp;1</a>).</p>
<div id="fig-webs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/webs.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Some examples of webs made by spiders dosed with various intoxicants</figcaption>
</figure>
</div>
<p>Say he classified the webs into three types:</p>
<ul>
<li><code>complete</code>, <code>partial</code>, or <code>fail</code>.</li>
</ul>
<p>He found the relative frequencies for the three types as follows:</p>
<ul>
<li><p><span class="math inline">\(P(W=\text{complete}) = 0.2\)</span></p></li>
<li><p><span class="math inline">\(P(W=\text{partial}) = 0.3\)</span></p></li>
<li><p><span class="math inline">\(P(W=\text{fail}) = 0.5\)</span></p></li>
</ul>
<p>The random variable <span class="math inline">\(W\)</span> has three possible states but any given observation can only belong to one state. You cannot observe a web that is both “partial” and “complete”, or “complete” and “fail”. These values or states are said to be mutually exclusive.</p>
<p>For mutually exclusive events,</p>
<ol type="1">
<li><p>The probability of any two events co-occurring is zero.</p></li>
<li><p>The probability of one event or another event occurring is the sum of the two respective probabilities.</p></li>
</ol>
<p>For example, either a complete web or a partial web being observed is equal to the sum of <span class="math inline">\(P(W = \text{complete})\)</span> and <span class="math inline">\(P(W = \text {partial})\)</span>. That is,</p>
<ol start="3" type="1">
<li>The probability of any one event not occurring is the sum of those remaining is <span class="math display">\[P(\text{not complete})    = P(W = \text{partial or}~W \text{ = fail})= 0.3 + 0.5 = 0.8 = 1 – P(W = \text{complete}) \]</span></li>
</ol>
</section>
<section id="statistical-independence" class="level2">
<h2 class="anchored" data-anchor-id="statistical-independence">Statistical independence</h2>
<p>If events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are statistically independent, then <span class="math display">\[P(A \textbf{ and } B) = P(A) \times P(B)\]</span></p>
<p>If the <span class="math inline">\(n\)</span> events <span class="math inline">\(A_1, A_2, \dots, A_n\)</span> are mutually independent, then: <span class="math display">\[P(A_1 \textbf{ and } A_2 \textbf{ and } \dots \textbf{ and } A_n) = P(A_1) \times  P(A_2) \times \dots \times P(A_n)\]</span></p>
<p>The probability of <em>event A occurring given that event B has already occurred</em> is written in shorthand as <span class="math inline">\(P(A|B)\)</span>.</p>
<p>For example, the probability of a card you’ve drawn being a 5, given that it is a spade. This is known as a <strong>conditional probability</strong>.</p>
<p>Note that the sample space is reduced to that where B has occurred.</p>
<p>We say that two events (A and B) are <strong>independent</strong> if</p>
<p><span class="math display">\[P(A | B) = P(A) \textbf{ and } P(B | A) = P(B)\]</span></p>
<p>This means that observing event A doesn’t make event B any more or less likely, and vice versa.</p>
<p>For any two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>,</p>
<p><span class="math display">\[P(A \textbf{ and } B ) = P(A|B) \times P(B)\]</span> and also</p>
<p><span class="math display">\[P(A \textbf{ and } B ) = P(B|A) \times P(A)\]</span></p>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<section id="blood-group-example" class="level3">
<h3 class="anchored" data-anchor-id="blood-group-example">Blood group example</h3>
<p>There are a large number of genetic-based blood-type systems that have been used for categorising blood. Two of these are the Rh system (Rh+ and Rh–) and the Kell system (K+ and K–). It is found that for any person, their blood type in any one system is independent of their blood type in any other.</p>
<p>For Europeans in New Zealand, about 81% are Rh+ and about 8% are K+. So, we can form a Table of counts as shown in <a href="#fig-Rh">Figure&nbsp;2</a>:</p>
<div id="fig-Rh" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/RhK.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Categorising blood types</figcaption>
</figure>
</div>
<p>If a European New Zealander is chosen at random, what is the probability that they are (Rh+ and K+) or (Rh– and K–)?</p>
<p>The answer is 0.0648 + 0.1748 = 0.2396 (verify).</p>
<p>Suppose that a murder victim has a bloodstain on him with type (Rh– and K+), presumably from the assailant. What is the probability that a randomly selected person matches this type?</p>
<p>The answer is 0.0152 (verify).</p>
</section>
<section id="beached-whales-example" class="level3">
<h3 class="anchored" data-anchor-id="beached-whales-example">Beached whales example</h3>
<p>Assume that 0.63 is the probability of a randomly selected beached whale is a male. So the probability of a beached whale being female is <span class="math inline">\(1-0.63=0.37\)</span>. Suppose that we also observe whether beached whales are juvenile or adult, and the probability of a whale being juvenile, given that it is female, is 0.8, and the probability it is juvenile, given that it is male, is 0.4.</p>
<p>Let us denote the random variables and their outcomes as follows:</p>
<p><em>Sex</em> (S) = either female (<span class="math inline">\(f\)</span>) or male (<span class="math inline">\(m\)</span>)</p>
<p><em>Age</em> (A) = either juvenile (<span class="math inline">\(j\)</span>) or adult (<span class="math inline">\(a\)</span>)</p>
<p>We are given</p>
<p><span class="math inline">\(P(S=m) = 0.63\)</span><br>
<span class="math inline">\(P(A=j | S=f) = 0.8\)</span><br>
<span class="math inline">\(P(A=j | S=m) = 0.4\)</span></p>
</section>
</section>
<section id="probability-tree-diagram" class="level2">
<h2 class="anchored" data-anchor-id="probability-tree-diagram">Probability tree diagram</h2>
<p>Easy to visualise the probabilities with this representation as shown in <a href="#fig-PTD">Figure&nbsp;3</a>.</p>
<div id="fig-PTD" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/tree.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Probability tree diagram</figcaption>
</figure>
</div>
<section id="rules-of-the-probability-tree" class="level3">
<h3 class="anchored" data-anchor-id="rules-of-the-probability-tree">Rules of the Probability Tree</h3>
<ol type="1">
<li><p>Within each level, all branches are mutually exclusive events.</p></li>
<li><p>The tree covers all possibilities (i.e., the entire sample space).</p></li>
<li><p>We multiply as we move along branches.</p></li>
<li><p>We add when we move across branches.</p></li>
</ol>
<p>What is the overall probability that a whale is juvenile? That is, what is <span class="math inline">\(P(A = j)\)</span> (or <span class="math inline">\(P(j)\)</span> for short)?</p>
<p><span class="math display">\[P(j) = P(m \textbf{ and } j) + P(f \textbf{ and } j)= 0.63\times 0.4+0.37 \times 0.8 = 0.548 \]</span></p>
</section>
</section>
<section id="bayes-rule" class="level2">
<h2 class="anchored" data-anchor-id="bayes-rule">Bayes rule</h2>
<p>What is the probability of the whale being female given that it is juvenile? i.e., what is <span class="math inline">\(P(f | j)\)</span> ?</p>
<p><span class="math inline">\(P(f | j)\)</span> doesn’t appear in the tree anywhere, so we will have to go back to first principles.</p>
<p>we know that</p>
<p><span class="math display">\[P(f \textbf{ and }  j)  = P(f | j) × P(j)\]</span> and<br>
<span class="math display">\[P(f \textbf{ and }  j)  = P(j | f) × P(f)\]</span></p>
<p>Thus, <span class="math display">\[P(f | j) × P(j) = P(j | f) × P(f)\]</span></p>
<p><span class="math display">\[P(f | j) = \frac {P(j | f) × P(f)} {P(j)}\]</span> This is known as the <em>Bayes rule</em> or theorem.</p>
<p>For our question <span class="math display">\[P(f | j) = \frac {P(j | f) × P(f)} {P(j)}= \frac{0.8 \times 0.37}{0.548}= 0.54\]</span></p>
</section>
</section>
<section id="probability-distributions" class="level1">
<h1>Probability Distributions</h1>
<p>Consider the number of eggs <span class="math inline">\((X)\)</span> in an Adelie penguin’s nest. The values range from <span class="math inline">\(1\)</span> to <span class="math inline">\(5\)</span>, each with a certain probability (or relative frequency) of occurrence.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">X=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dfm, <span class="at">booktabs=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">X</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.15</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The barplot of these probabilities is shown as <a href="#fig-discr">Figure&nbsp;4</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dfm <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span><span class="st">`</span><span class="at">Probability</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"table"</span>, <span class="at">label =</span> <span class="fu">list</span>(dfm), <span class="at">x=</span><span class="dv">8</span>, <span class="at">y=</span>.<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-discr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-discr-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Barplot of probabilities</figcaption>
</figure>
</div>
</div>
</div>
<p>This is an example of a theoretical probability distribution, which describes the behaviour of a data-producing system. It’s a model for producing random values with specific probabilities.</p>
<p>Note the probabilities add to <span class="math inline">\(1\)</span> because <span class="math inline">\({1,2,3,4,5}\)</span> is a complete distribution. There are no other possibilities.</p>
<p>Two important parameters for describing the probability distribution of a random variable <span class="math inline">\(X\)</span> are:</p>
<ul>
<li>The mean <span class="math inline">\(\mu\)</span> (or “expected value” <span class="math inline">\(\text{E}(X)\)</span>). This is the “point of balance”, that locates the distribution and puts equal mass either side.</li>
<li>The variance <span class="math inline">\(\sigma_X^2\)</span> (or <span class="math inline">\(\text{Var}(X)\)</span>) is a measure of spread. It is the average squared difference from a value to the mean.</li>
</ul>
<p>For a discrete probability distribution, the population mean <span class="math inline">\(\mu_X\)</span> is simply the sum of each outcome multiplied by its probability.</p>
<p><span class="math display">\[\mu_X = \text{E}(X) = \sum xP(X=x) = \sum xP(x)\]</span></p>
<p>In R,</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>(Mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(X<span class="sc">*</span>P))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.15</code></pre>
</div>
</div>
<p>The population variance is given by</p>
<p><span class="math display">\[\sigma_X^2 = \text{Var}(X) = \sum (x-\mu_X)^2 P(x)\]</span></p>
<p>The population SD is simply the square-root of the variance.</p>
<p>In R,</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">*</span> P)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>(Variance <span class="ot">&lt;-</span> <span class="fu">sum</span>((X<span class="sc">-</span>Mean)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>P))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4275</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(SD <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Variance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.19478</code></pre>
</div>
</div>
<section id="probability-massdensity-functions" class="level2">
<h2 class="anchored" data-anchor-id="probability-massdensity-functions">Probability Mass/Density Functions</h2>
<p>The above example of the distribution of numbers of eggs of penguins is an odd case, because we’ve simply listed the outcomes and probabilities. More often, we use a known probability distribution where the probabilities of any value of <span class="math inline">\(X\)</span> may be calculated using a Probability Mass Function (PMF, for discrete distributions) or Probability Density Function (PDF, for continuous distributions). A PMF or PDF is a formula that can be used to calculate the probability associated with any value; that is, <span class="math inline">\(\text{P}(X=x)\)</span>, the probability that the random variable <span class="math inline">\(X\)</span> will take a particular value <span class="math inline">\(x\)</span>. These probabilities arise from making particular assumptions about how the values arise.</p>
<p>The remainder of this chapter will discuss some of the more common probability distributions.</p>
</section>
<section id="discrete-probability-distributions" class="level2">
<h2 class="anchored" data-anchor-id="discrete-probability-distributions">Discrete probability distributions</h2>
<p>Discrete probability distributions are those that can produce a limited set of values, usually non-negative integers {0, 1, 2, 3, …}. The two most useful ones are the Binomial and the Poisson.</p>
<section id="binomial-distribution" class="level3">
<h3 class="anchored" data-anchor-id="binomial-distribution">Binomial distribution</h3>
<p>Let <span class="math inline">\(X\)</span> be the number of heads when two coins are tossed. The possible outcomes are shown in <a href="#fig-twocoins">Figure&nbsp;5</a>.</p>
<div id="fig-twocoins" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/binom.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Possible outcomes for two coin tosses</figcaption>
</figure>
</div>
<p>In general, when there only two possible outcomes say <em>success</em> or <em>failure</em> (<span class="math inline">\(1\)</span> or <span class="math inline">\(0\)</span>; Yes or No; On or Off; Heads or Tails; etc.), we deal with a <em>binary</em> or <strong>Bernoulli</strong> random variable.</p>
<p>The count of the number of <em>successes</em> <span class="math inline">\(X\)</span> out of a fixed total of <span class="math inline">\(n\)</span> <em>independent</em> trials (in the above coin tossing example, there were <span class="math inline">\(n = 2\)</span> trials) follows the binomial distribution.</p>
<p>In other words, <span class="math inline">\(X \sim Bin(n, p)\)</span>, where <span class="math inline">\(p\)</span> the probability of a success. The binomial probability mass function <span class="math inline">\(P(X=x)\)</span> or <span class="math inline">\(P(x)\)</span> is given by</p>
<p><span class="math display">\[P(x)={n \choose x}p^{x}(1-p)^{n-x}\]</span></p>
<p>It is easy to plot these probabilities in R. For <span class="math inline">\(n=10\)</span>, <span class="math inline">\(p=0.3\)</span>, the binomial probabilities <span class="math inline">\(P(x)~~~ x=0,1,2, \dots, 10\)</span> are plotted in <a href="#fig-dbin">Figure&nbsp;6</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dbin" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-dbin-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Binomial probabilities</figcaption>
</figure>
</div>
</div>
</div>
<p>Example: A microbiologist conducts an experiment to create a recombinant strain of bacteria that is resistant to penicillin. She plates out the bacteria on a plate, and picks out 10 colonies. She knows that the probability of successfully creating a recombinant is 0.15.</p>
<p>What is the probability that if she mixes all 10 colonies in a growth medium with penicillin, something (anything) will grow?</p>
<p>Given:</p>
<p><span class="math inline">\(X \sim Bin(n = 10, p = 0.15)\)</span>. What is <span class="math inline">\(P(x &gt; 0)\)</span>?</p>
<p>Note <span class="math inline">\(P(x &gt; 0)=1-P(x = 0)\)</span>. So in R, compute this as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span>.<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8031256</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span>.<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8031256</code></pre>
</div>
</div>
<p>Note that function <code>pbinom(k,size=n,prob=p)</code> gives the cumulative probabilities up to and including the quantile <span class="math inline">\(k\)</span> (which is equal to zero in our example).</p>
<p><span class="math display">\[P(X\leq k)=\sum _{i=0}^{k}{n \choose x}p^{x}(1-p)^{n-x}\]</span></p>
<p>The mean and variance of the binomial random variable is given by</p>
<p><span class="math display">\[\mu_X=np~~~~ \sigma^2_X=np(1-p)\]</span></p>
<p>So the expected number of recombinant strain of bacteria would be</p>
<p><span class="math display">\[\mu_X=np=10*0.15=1.5\]</span></p>
<p>with SD</p>
<p><span class="math display">\[\sigma_X=\sqrt {np(1-p)}=1.129159\]</span></p>
</section>
<section id="poisson-distribution" class="level3">
<h3 class="anchored" data-anchor-id="poisson-distribution">Poisson distribution</h3>
<p>The Poisson distribution is used to obtain the probabilities of counts of relatively rare events or outcomes that occur independently in space or time.</p>
<p>Some Examples:</p>
<ol type="1">
<li>The number of snails in a quadrat (<span class="math inline">\(1~m^2\)</span>)</li>
<li>Fish counts in a visual transect (25 x 5 m)</li>
<li>Bacterial colonies in 2 litres of milk</li>
</ol>
<p>The random variable <span class="math inline">\(X\)</span>, the number of occurrences (count), often follows the Poisson distribution whose probability function is given by</p>
<p><span class="math display">\[\Pr(x)= \frac{\lambda^x e^{-\lambda}}{x!}~~~ x=0,1,2,\dots, \infty\]</span></p>
<p>The parameter <span class="math inline">\(\lambda\)</span> is the mean which is also equal to the variance.</p>
<p><span class="math display">\[\mu_X=\lambda~~~~ \sigma^2_X=\lambda\]</span></p>
<p>Main assumptions:</p>
<ol type="1">
<li><p>The events occur at a constant average rate of <span class="math inline">\(\lambda\)</span> per unit time or space.</p></li>
<li><p>Occurrences are independent of one another as well as they do not happen at exactly the same unit time or space.</p></li>
</ol>
<p>Example: Consider the number of changes that accumulate along a stretch of a neutrally evolving gene over a given period of time.</p>
<p>This is a Poisson random variable with a population mean of <span class="math inline">\(\lambda=kt\)</span>, where <span class="math inline">\(k\)</span> is the number of mutations per generation, and <span class="math inline">\(t\)</span> is the time in generations that has elapsed.</p>
<p>Assume that <span class="math inline">\(k = 1\times10^{-4}\)</span> and <span class="math inline">\(t = 500\)</span>.</p>
<p>For <span class="math inline">\(\lambda=kt=0.05\)</span>, the Poisson probabilities are shown in <a href="#fig-dpoi">Figure&nbsp;7</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dpoi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-dpoi-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;7: Poisson probabilities</figcaption>
</figure>
</div>
</div>
</div>
<p>What is the probability that at least one mutation has occurred over this period?</p>
<p><span class="math inline">\(P(x &gt; 0)=1-P(x = 0)\)</span> is found in R as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">dpois</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">lambda=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04877058</code></pre>
</div>
</div>
<p>Another example: The number of parasites in a host is a Poisson random variable with mean 1.5. What is the probability that there will be exactly one parasite in the host? Examine <a href="#fig-parasite">Figure&nbsp;8</a> for the answer.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-parasite" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-parasite-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Parasites distribution</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="continuous-probability-distributions" class="level2">
<h2 class="anchored" data-anchor-id="continuous-probability-distributions">Continuous probability distributions</h2>
<p>A discrete random variable takes values which are simply points on a real line. In other words, there is an inherent discontinuity in the values a discrete random variable can take.</p>
<p>If a random variable, <span class="math inline">\(X\)</span>, can take any value (i.e., not just integers) in some interval of the real line, it is called a <em>continuous</em> random variable. Examples include variables such as height, weight, length, percentage protein etc.</p>
<p>For a discrete random variable <span class="math inline">\(X\)</span>, the associated probabilities <span class="math inline">\(P(X=x)\)</span> are also just points or masses, and hence the probability function <span class="math inline">\(P(x)\)</span> is also called as the probability mass function (<em>pmf</em>).</p>
<p>For continuous random variables, probabilities can be computed when the variable falls in an interval such as <span class="math inline">\(5\)</span> to <span class="math inline">\(15\)</span>, but not when it takes a fixed value such as <span class="math inline">\(10\)</span> (which is equal to zero).</p>
<p>The probability density function (pdf) gives the probabilities as an area under the curve.</p>
<p>For example, consider a random proportion <span class="math inline">\((X)\)</span> between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. Here <span class="math inline">\(X\)</span> follows a (standard) continuous uniform distribution whose (probability) density function <span class="math inline">\(f(x)\)</span> is defined as follows:</p>
<p><span class="math display">\[f(x)=\begin{cases}{1}~~~\mathrm {for} \ 0\leq x\leq 1,\\[9pt]0~~~\mathrm {for} \ x&lt;0\ \mathrm {or} \ x&gt;1\end{cases}\]</span></p>
<p>This constant density function is very simple; see <a href="#fig-constdens">Figure&nbsp;9</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="fl">1.5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dunif, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">10001</span>, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-constdens" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-constdens-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;9: Constant density between 0 and 1</figcaption>
</figure>
</div>
</div>
</div>
<p>The cumulative distribution function, CDF, <span class="math inline">\(F(x)\)</span> gives the left tail area or probability up to <span class="math inline">\(x\)</span>. This is probability is found as</p>
<p><span class="math display">\[F_{X}(x)=\int _{-\infty }^{x}f_{X}(t)\,dt\]</span> The relationship between the density function <span class="math inline">\(f(x)\)</span> and the distribution function <span class="math inline">\(F(x)\)</span> is given by the <em>Fundamental Theorem of Calculus</em>.</p>
<p><span class="math display">\[f(x)={dF(x) \over dx}\]</span></p>
<p>The total area under the pdf curve is <span class="math inline">\(1\)</span>. The probability of obtaining a value between two points (<span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>) is the area under the pdf curve between those two points. This probability is given by <span class="math inline">\(F(b)-F(a)\)</span>.</p>
<p>For the uniform distribution <span class="math inline">\(U(0,1)\)</span>, <span class="math inline">\(f(x)=1\)</span>. So,</p>
<p><span class="math display">\[F_{X}(x)=\int _{-\infty }^{x}\,dt=x\]</span></p>
<p>For example, the probability of a randomly drawn fraction from the interval <span class="math inline">\([0,1]\)</span> to fall below <span class="math inline">\(x=0.5\)</span> is 50%.</p>
<p>The probability of a random fraction falling between <span class="math inline">\(a=0.2\)</span> and <span class="math inline">\(b=0.8\)</span> is</p>
<p><span class="math display">\[F(b)-F(a)=0.8-0.2=0.6\]</span></p>
<section id="normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="normal-distribution">Normal distribution</h3>
<p>The Gaussian or normal distribution is parameterised in terms of the mean <span class="math inline">\(\mu\)</span> and the variance <span class="math inline">\(\sigma ^{2}\)</span> and its density function is given by</p>
<p><span class="math display">\[f(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}}\]</span> If <span class="math inline">\(X \sim N(\mu, \sigma)\)</span>, its Z-score is calculated from <span class="math inline">\(X\)</span> by subtracting <span class="math inline">\(\mu\)</span> and dividing by the standard deviation <span class="math inline">\(\sigma\)</span>.</p>
<p><span class="math display">\[Z={\frac {X-\mu }{\sigma }}\]</span> The random variable <span class="math inline">\(Z \sim N(0,1)\)</span>. Its pdf is given by</p>
<p><span class="math display">\[f(z)={\frac {1}{ {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}z^{2}}\]</span></p>
<p>We often deal with the Standard normal because the <em>symmetric</em> bell shape of the normal distribution remains the same for all <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>; see <a href="#fig-nrm">Figure&nbsp;10</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nrm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-nrm-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;10: Standard Normal Density</figcaption>
</figure>
</div>
</div>
</div>
<p>Example: The weight of an individual of <em>Amphibola crenata</em> (snail) is normally distributed with a mean of <span class="math inline">\(40g\)</span> and variance of <span class="math inline">\(20g^2\)</span> as shown in <a href="#fig-nrmeg">Figure&nbsp;11</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">60</span>, <span class="at">length=</span><span class="dv">1000</span>), </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfs) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span>) <span class="sc">+</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">40</span>) </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>ps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-nrmeg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-nrmeg-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption class="figure-caption">Figure&nbsp;11: Distribution of snail weight</figcaption>
</figure>
</div>
</div>
</div>
<p>What is the probability of getting a snail that weighs between <span class="math inline">\(35g\)</span> and <span class="math inline">\(50g\)</span>? In R, the function <code>pnorm()</code> gives the CDF.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">50</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) <span class="sc">-</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(<span class="dv">35</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8555501</code></pre>
</div>
</div>
<p><a href="#fig-snail">Figure&nbsp;12</a> illustrates the computation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ps <span class="sc">+</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> dfs <span class="sc">|&gt;</span> <span class="fu">filter</span>(x <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="dv">35</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">"coral1"</span>, <span class="at">alpha=</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-snail" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-snail-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption class="figure-caption">Figure&nbsp;12: Probability of snail weight being between 35 g and 50 g</figcaption>
</figure>
</div>
</div>
</div>
<p>What is the probability of getting a snail that weighs below <span class="math inline">\(35g\)</span> or over <span class="math inline">\(50g\)</span>?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">35</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(<span class="dv">50</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>), <span class="at">lower.tail=</span><span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1444499</code></pre>
</div>
</div>
<p>Under standard normal, the areas under the pdf curve are shown in <a href="#fig-ncurves">Figure&nbsp;13</a> for various situations.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ncurves" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-ncurves-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;13: Standard normal coverage</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="skewed-distributions" class="level3">
<h3 class="anchored" data-anchor-id="skewed-distributions">Skewed distributions</h3>
<p>There are many probability distributions which are asymmetrical. A few of them are briefed here.</p>
<p><strong>Log-normal</strong></p>
<p>A random variable <span class="math inline">\(X\)</span> is log-normally distributed, when <span class="math inline">\(log_e(X)\)</span> follows normal. Alternatively, if <span class="math inline">\(X\)</span> follows normal, then <span class="math inline">\(e^X\)</span> follows log-normal.</p>
<p>The log-normal density function is shown below:</p>
<p><span class="math display">\[f(x)={\frac {1}{x\sigma {\sqrt {2\pi }}}}\ \exp \left(-{\frac {\left(\ln x-\mu \right)^{2}}{2\sigma ^{2}}}\right),~~ x&gt;0\]</span> While the R function <code>dnorm()</code> gives the normal density, the function <code>dlnorm()</code> gives the log-normal density.</p>
<p>The standard log-normal pdf and CDF are plotted in <a href="#fig-lnrm">Figure&nbsp;14</a></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lnrm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-lnrm-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;14: Log-normal pdf and CDF</figcaption>
</figure>
</div>
</div>
</div>
<p>The mean &amp; variance of the lognormal random variables are:</p>
<p><span class="math display">\[\mu_X=e^{\left(\mu +{\frac {\sigma ^{2}}{2}}\right)}~~~~\sigma_X^2=(e^{\sigma ^{2}}-1) e^{(2\mu +\sigma ^{2})}\]</span> <strong>Gamma</strong></p>
<p>The probability function of the gamma distribution with shape parameter <span class="math inline">\(\alpha\)</span> and scale parameter <span class="math inline">\(\beta\)</span> is given below:</p>
<p><span class="math display">\[\displaystyle {\begin{aligned}f(x)={\frac {\beta ^{\alpha }x^{\alpha -1}e^{-\beta x}}{\Gamma (\alpha )}}\quad {\text{ for }}x&gt;0\quad \alpha ,\beta &gt;0,\\[6pt]\end{aligned}}\]</span> where <span class="math inline">\(\displaystyle \Gamma (\alpha)=\int _{0}^{\infty }x^{\alpha-1}e^{-x}\,dx.\)</span></p>
<p><a href="#fig-gam">Figure&nbsp;15</a> shows the plot of gamma density for various shape and scale parameters.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-gam" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-gam-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;15: Gamma distributional shapes</figcaption>
</figure>
</div>
</div>
</div>
<p>Lognormal, Weibull and gamma distributions are useful to model right skewed data, particularly lifetimes data, but we need large amount of data, say over 300, to discriminate the three fitted distributions.</p>
<p><strong>Beta distribution</strong></p>
<p>The beta distribution is bounded on the interval <span class="math inline">\([0, 1]\)</span> and parameterised by two positive shape parameters, say <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<p>The probability function of the Weibull distribution is given below:</p>
<p><span class="math display">\[\begin{aligned}f(x;\alpha ,\beta ) ={\frac {x^{\alpha -1}(1-x)^{\beta -1}}{\displaystyle \int _{0}^{1}u^{\alpha -1}(1-u)^{\beta -1}\,du}}={\frac {1}{\mathrm {B} (\alpha ,\beta )}}x^{\alpha -1}(1-x)^{\beta -1}\end{aligned} \]</span> where <span class="math inline">\(\mathrm {B} (\alpha ,\beta )=\frac {\Gamma (\alpha )\Gamma (\beta )}{\Gamma (\alpha +\beta )}\)</span>. <a href="#fig-betas">Figure&nbsp;16</a> shows the plot of beta density for various shape parameter combinations.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-betas" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-betas-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;16: Beta distributional shapes</figcaption>
</figure>
</div>
</div>
</div>
<p>When <span class="math inline">\(\alpha=\beta=1\)</span>, the beta distribution becomes the continuous uniform distribution. This distribution is useful to model component fractions such as percentage of protein in milk powder, and is also widely used in Bayesian analysis.</p>
</section>
<section id="empirical-distributions" class="level3">
<h3 class="anchored" data-anchor-id="empirical-distributions">Empirical distributions</h3>
<p>Data from a normal (or any other distribution) may not look very much like the expected theoretical shape (‘bell-curve’ for normal) unless there is very large amount of it. <a href="#fig-rn200">Figure&nbsp;17</a> is for a random sample of 200 from the standard normal distribution. Compare the departures from the expected theoretical shape. Recall that we covered the ECDF curves in the last Chapter. The CDF curve is just theoretical one but fitted with data. More on this later.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-rn200" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-rn200-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption class="figure-caption">Figure&nbsp;17: Normal(0,1) data (n=200)</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Small sample effect</strong> For small samples, we do not expect many outliers but the ‘ideal’ shape may not be seen; see <a href="#fig-rn50">Figure&nbsp;18</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-rn50" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-rn50-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption class="figure-caption">Figure&nbsp;18: Normal(0,1) data (n=50)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="importance-of-the-normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="importance-of-the-normal-distribution">Importance of the normal distribution</h3>
<p><strong><em>Question</em></strong>: Why do we use the Normal distribution so much? Answer: Because:</p>
<ol type="1">
<li><p>Many physical, biological, engineering and economic quantities do seem to follow a Normal distribution (sometimes after a transformation of the data to an appropriate scale). An example is that the logarithm of the ‘waiting time’ between earthquakes in Wellington is normally distributed. (The use of the logarithm may worry you, but it is natural for the subject area. Note that the magnitude of earthquakes is also measured on a logarithmic scale, namely the familiar Richter scale.)</p></li>
<li><p>Data that are <em>approximately</em> Normal seem to turn up very frequently in practice. In particular this may occur because</p></li>
<li><p>The Normal distribution is often what you get <em>(for mathematical reasons)</em> when you add together (or average) lots of different things. This result is known as the central limit theorem (CLT). For example, test scores are calculated by adding together marks from different questions, or share market movements are the result of many individuals and firms making private decisions. There is another theory which establishes that the sampling distributions of quantiles of continuous distributions of are approximately normal for <em>large</em> sample sizes.</p></li>
<li><p>We shall see in this course that residuals play a large part. These are, for example, the ‘errors’ left over after fitting a regression line to data. Quite often, we expect residuals to follow a Normal distribution.</p></li>
</ol>
</section>
<section id="normal-data-in-practice" class="level3">
<h3 class="anchored" data-anchor-id="normal-data-in-practice">Normal data in practice</h3>
<p>In practice, data from a ‘Normal distribution’ <em>may</em> not look very much like the ‘bell-curve’ unless there is very large amount of it. This statement has practical implications but first let us check whether the statement is true. We can do this by simulating batches of data from a Normal distribution (using software) and noting the variations across the data sets. Moreover, because the Normal distribution and its bell shaped curve are so important and ubiquitous, it is instructive to apply EDA methods to Normal data, for we would certainly like EDA methods to work well for that type of curve.</p>
<p>For the first batch, we simulated 1000 numbers from a Normal distribution with mean 80 and standard deviation of 12. The numbers could represent, for example, the diastolic blood pressure of 1000 adult New Zealanders. <a href="#fig-simnor">Figure&nbsp;19</a> shows the histogram and the boxplot of the random normal data. Even though the typical bell-shaped pattern (theoretical normal curve shown in dotted lines) is evident, the histogram is not perfectly symmetric as the numbers were chosen at random so that by chance more fall into some classifications than would be expected. Also there are a few unusual values at the both extremes (see the boxplot). In practice if we didn’t know that the data came from a Normal distribution we might investigate the three highest points to see if they were valid points or outliers. The extreme edges of a data often comprise very atypical values we would not tend to place too much weight on the conflicting evidence they give about symmetry. The mean and median of this simulated batch are somewhat closer but the median is slightly off-centred from the quartiles.<em>Well, so far so good. Now what if we have smaller batches?</em></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-simnor" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-simnor-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;19: Simulated normal data, n=100 and n=1000</figcaption>
</figure>
</div>
</div>
</div>
<p>For a normal distribution,</p>
<p>68% of the values fall within 1 standard deviation of the mean<br>
95% of the values fall within 2 standard deviation of the mean<br>
99% of the values fall within 3 standard deviation of the mean.<br>
</p>
<p>As a special case, 50% of the values will fall within 0.6745 standard deviations of the mean. For symmetric distributions, mean equals the median. Hence the fourths (quartiles) of random data obtained drawn from theoretical normal population will be</p>
<p><strong>Lower hinge</strong> = median - <span class="math inline">\(0.6745\times S~(\simeq\)</span>lower quartile),</p>
<p>and</p>
<p><strong>Upper hinge</strong> = median + <span class="math inline">\(0.6745 \times S~(\simeq\)</span> upper quartile),</p>
<p>where <span class="math inline">\(S\)</span> is the standard deviation. Thus F-spread (or <span class="math inline">\(\simeq\)</span> the IQR) <span class="math inline">\(\simeq\)</span> 1.35<span class="math inline">\(\times S\)</span>. Hence</p>
<p><strong>inner fences</strong>= median <span class="math inline">\(\pm\)</span> 2 F-spread = median <span class="math inline">\(\pm\)</span> 2.7<span class="math inline">\(\times S\)</span></p>
<p>The probability that an observation falls between these fences is 0.993, or the probability of falling outside these fences is 0.007. Thus in our simulated batch of size 1000, we expect about 7 possible outliers but none for the simulated batch size 100. <strong>Outer fences</strong> are defined as being 2 steps (3<span class="math inline">\(\times\)</span>F-spread) away from the fourths so that</p>
<p><strong>outer fences</strong>= median <span class="math inline">\(\pm\)</span> 3.5<span class="math inline">\(\times\)</span>F-spread = median <span class="math inline">\(\pm\)</span> 4.72<span class="math inline">\(\times S\)</span></p>
<p>The probability of a point falling outside of this range is the extremely small amount of 0.000002. It is not surprising, then, that none of the values in our simulated batches fell outside of the outer fences. If they did, we would class them as probable outliers. Of course, with distributions other than the Gaussian one, and particularly for asymmetric distributions, the probability of a value falling outside these fences is higher.</p>
</section>
<section id="assessment-of-normality" class="level3">
<h3 class="anchored" data-anchor-id="assessment-of-normality">Assessment of Normality</h3>
<p>The shapes of the ECDF curves shown in <a href="#fig-simnorecdf">Figure&nbsp;20</a> are typical of the empirical cumulative distributions for data from Normal populations. This curve was drawn using 1000 and 100 simulated random normal data. It could perhaps be described as an S-shape on its side (or lazy or stretched out S). The curve is flatter at either end which reflects the small amounts of relative frequency in the tails of the Normal distribution. The theoretical Cumulative Distribution Function (CDF) curve for the normal distribution is also shown in <a href="#fig-simnorecdf">Figure&nbsp;20</a> as a smooth curve. For smaller samples from a Normal population, the ECDF curve will vary about the theoretical curve, and, of course, the variation is likely to be larger the smaller the sample; see <a href="#fig-simnorecdf">Figure&nbsp;20</a>(B).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-simnorecdf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-simnorecdf-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;20: Simulated normal data, n=100 and n=1000</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="normal-quantile-quantile-plots" class="level3">
<h3 class="anchored" data-anchor-id="normal-quantile-quantile-plots">Normal quantile-quantile plots</h3>
<p>To visually check whether a given set of data are normally distributed, one can create a normal quantile-quantile (Q-Q) plot. In this plot the quantiles of the sample are plotted against the theoretical quantiles of a standard normal distribution N(0,1). If the data, <span class="math inline">\(Y_{i}\)</span>, are normally distributed N(<span class="math inline">\(\mu, \sigma\)</span>) then <span class="math inline">\(Z_{i} = \left(Y_{i} -\mu \right)/\sigma\)</span> has a standard normal distribution. If we plot the quantiles of the data against corresponding quantiles of the standard normal distribution, the points should roughly lie on the straight line: <span class="math display">\[Y_{i} =\mu +\sigma Z_{i}\]</span> that is, a line with intercept <span class="math inline">\(\mu\)</span>, and slope <span class="math inline">\(\sigma\)</span>.</p>
<p>We should note that the mean and standard deviation do not appear in the formula <span class="math inline">\(Y_{i} =\mu +\sigma Z_{i}\)</span> by coincidence. Rather, the mean and standard deviation are intimately connected to the normal distribution: if the data had not been normal then the line with these parameters would not pass through the data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-normqq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-normqq-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;21: Normal Quantile-Quantile Plot for Checking Normality</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-normqq">Figure&nbsp;21</a> shows the normal Q-Q plot for 50 random values from N(80,12). Note that the points in the middle largely plot on a line. It is natural that the tail part of the distribution shows more variation, and hence we will ignore such departures.</p>
<p>The normal Q-Q plot is presented as a <strong>normal probability plot</strong> in some software where the theoretical quantiles are replaced by the associated normal probabilities. Such normal probability plots show the sample data in the <span class="math inline">\(X\)</span>-axis and the normal probabilities in the <span class="math inline">\(Y\)</span>-axis. In both plots, we mainly look whether or not the points plot roughly on a straight line.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/rangitikei.RData"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">"rangitikei.RData"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"rangitikei.RData"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rangitikei) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">sample =</span> people) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rangitikei) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y=</span>people, <span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol=</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-normqqP" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-normqqP-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;22: Normal Quantile-Quantile Plot for Checking Normality</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-normqqP">Figure&nbsp;22</a> shows the normal Q-Q plot for the number of people who made use of a recreational facility (<strong>rangitikei</strong>). This plot clearly reveals that the data are not normal. The plotted points show a curved but asymmetric pattern. This pattern matches with the right skewness seen in the data (see the boxplot given in <a href="#fig-normqqP">Figure&nbsp;22</a>.</p>
<p>Note that <strong>normality and symmetry are not the same</strong>. If the true distribution of the data is symmetric such as uniform, rectangular or triangular distributions, then the normal Q-Q plot will show a symmetric pattern for the plotted points but they will not plot on a straight line. As an example, the normal Q-Q plots for batches of random data from Student’s <span class="math inline">\(t\)</span> (to be covered later in the next Chapter) and few other symmetric distributions is shown in <a href="#fig-normqqsym">Figure&nbsp;23</a>. Clearly normality is rejected for other symmetric non-normal distributions.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-normqqsym" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="3-probability_files/figure-html/fig-normqqsym-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;23: Normal Quantile-Quantile Plot for Checking Normality</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<p>This Chapter provided a revision of probability concepts usually covered the first year level covered at the seventh form level or in a first year Statistics course. A few popular probability distributions are also introduced.</p>
<p>Identification of a probability distribution is not an easy task for a set of observed data. This issue is not settled purely on statistical grounds. EDA helps to short-list distributions fitting reasonably well to the data. For regression type of models fitted to continuous responses, the normal distribution works generally well.</p>
<p>The material covered in this Chapter forms the foundation for many of the inferential methods.</p>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-witt" class="csl-entry" role="listitem">
Witt, P. N. 1956. <em>Die Wirkung von Substanzen Auf Den Netzbau Der Spinne Als Biologischer Test</em>. Berline-Gottinger-Heidelberg. Springer-Verlag.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../studyguide/2-eda.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Chapter 2: Exploratory Data Analysis (EDA)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../studyguide/4-inference.html" class="pagination-link">
        <span class="nav-page-text">Chapter 4: Statistical Inference</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb24" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Chapter 3: Probability Concepts and Distributions"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; “_Misunderstanding of probability may be the greatest of all impediments to scientific literacy_” </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; — Stephen Jay Gould</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "_Statisticians, like artists, have the bad habit of falling in love with their models._" </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; — George Box</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>The concept of probability is the foundation of statistical inference. In other words, making inferences about a populations based on a sample relies on probability notions, and any uncertainty in our conclusions can be expressed in probabilistic terms. We also informally used the probability concepts in data collection, particularly with the *EPSEM* sampling methods.</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>The concepts we cover in this Chapter will be largely familiar to you from a first year course. Note that we are covering probability concepts and distributions at a very basic level without much maths. </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="fu"># Probability: a placeholder for incomplete knowledge</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>Probability is a mathematical framework used to quantify and describe expectations of random events. Okay, so what is randomness? Where does it come from? This is a philosophical question, really. </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>From a practical viewpoint, I find it useful to think of randomness and probability as _placeholders for incomplete knowledge_. If we have complete knowledge of something, we don't need the concepts of randomness and probability.</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>To illustrate, when you roll a die, you don't know what number you'll get. On inspection of the die, you can see that it has six sides, numbered 1-6. If we assume that it will land on one side, and that there's equal probability of landing on each of the six sides, then we can form a basic probability model. </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>| $x$ | $P(x)$ |</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>|---|------|</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>| 1 | 1/6  |</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>| 2 | 1/6  |</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>| 3 | 1/6  |</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>| 4 | 1/6  |</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>| 5 | 1/6  |</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>| 6 | 1/6  |</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>There are six possible outcomes with equal probability, so the probability of each is 1/6. The probabilities sum to 1. </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>Where does the randomness come into this scenario? Is there randomness inherent in the process of rolling a die? I would say no. If we had complete knowledge of the system, including the shape of the die, the starting position, the angle and velocity with which it is thrown, and the shape and texture of the surface it lands on, and a good physical model of how these things interact, then we could theoretically be able to predict perfectly the number on which it will land. The trouble is, of course, that all this information is extremely difficult to collect in enough detail to allow us to make such a prediction. </span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>A simpler case is a shuffled deck of cards. When you shuffle a deck of cards for long enough, we'd consider the question of which card is on the top to be random. However, if we knew the starting conditions and exactly how the cards were shuffled, then there's no randomness, and no need for a  probability model. </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>But most of the world isn't as simple as shuffling cards or even rolling a die. Our knowledge is so very limited that concepts of uncertainty, randomness, and probability are indispensable to anyone who wants to make any real sense of it.</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Probability as a relative frequency</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>The naive or classical definition of probability is just a relative frequency. If $n$ is the total number of equally likely possible outcomes and if $m$ of those $n$ outcomes result in the occurrence of some given event, then the probability of that event is $m/n$. </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>For example, if a fair die is rolled, there are $n = 6$ possible outcomes. Let the event of interest be *getting a number 4 or more*. So, the probability of this event is 3 out of 6 or $p=1/2$.</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>The *sample space* or the set of all possible outcomes need not be finite. For example, tossing a coin until the first head appears will result in an infinite sample space.So, the probability can be viewed as a limiting or long run fraction of $m/n$ (i.e. when $n \to \infty$).</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>When the sample space is finite and outcomes are equally likely, we can assume that classical probability will be the same as empirical probability. Note that to find the probability of a fair coin landing heads it is not necessary to toss the coin repeatedly and observe the proportion of heads. So when the number of trails is reasonably large, empirical probability may be treated as the true value.</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>Subjective probability (such as expert opinion) is useful in areas such as decision theory, and its definition does not fit as a relative frequency.</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>Probabilities can only be between $0$ and $1$ (impossible to certain).</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mutually exclusive events</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>A German researcher <span class="co">[</span><span class="ot">@witt</span><span class="co">]</span> studied the effects of various drugs on the web-building abilities of orb-web spiders (@fig-webs). </span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a><span class="al">![Some examples of webs made by spiders dosed with various intoxicants](images/webs.png)</span>{#fig-webs}</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>Say he classified the webs into three types:</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`complete`</span>, <span class="in">`partial`</span>, or <span class="in">`fail`</span>.</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>He found the relative frequencies for the three types as follows:</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(W=\text{complete}) = 0.2$</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(W=\text{partial}) = 0.3$</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(W=\text{fail}) = 0.5$</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>The random variable $W$ has three possible states but any given observation can only belong to one state. You cannot observe a web that is both “partial” and “complete”, or “complete” and “fail”. These values or states are said to be mutually exclusive.</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>For mutually exclusive events, </span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The probability of any two events co-occurring is zero.</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The probability of one event or another event occurring is the sum of the two respective probabilities. </span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>For example, either a complete web or a partial web being observed is equal to the sum of $P(W = \text{complete})$ and $P(W = \text {partial})$.  That is, </span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The probability of any one event not occurring is the sum of those remaining is </span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>$$P(\text{not complete})    = P(W = \text{partial or}~W \text{ = fail})= 0.3 + 0.5 = 0.8 = 1 – P(W = \text{complete}) $$</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a><span class="fu">## Statistical independence</span></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>If events $A$ and $B$ are statistically independent, then </span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>$$P(A \textbf{ and } B) = P(A) \times P(B)$$</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>If the $n$ events $A_1, A_2, \dots, A_n$  are mutually independent, then:</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>   $$P(A_1 \textbf{ and } A_2 \textbf{ and } \dots \textbf{ and } A_n) = P(A_1) \times  P(A_2) \times \dots \times P(A_n)$$</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>The probability of *event A occurring given that event B has already occurred* is written in shorthand as $P(A|B)$.</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>For example, the probability of a card you’ve drawn being a 5, given that it is a spade.  This is known as a **conditional probability**.</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>Note that the sample space is reduced to that where B has occurred. </span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>We say that two events (A and B) are **independent** if</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>$$P(A | B) = P(A) \textbf{ and } P(B | A) = P(B)$$</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>This means that observing event A doesn’t make event B any more or less likely, and vice versa. </span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>For any two events $A$ and $B$,</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>$$P(A \textbf{ and } B ) = P(A|B) \times P(B)$$</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>        and also</span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>$$P(A \textbf{ and } B ) = P(B|A) \times P(A)$$</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examples</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a><span class="fu">### Blood group example</span></span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>There are a large number of genetic-based blood-type systems that have been used for categorising blood. Two of these are the Rh system (Rh+ and Rh–) and the Kell system (K+ and K–). It is found that for any person, their blood type in any one system is independent of their blood type in any other. </span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>For Europeans in New Zealand, about 81% are Rh+ and about 8% are K+. So, we can form a Table of counts as shown in @fig-Rh:</span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a><span class="al">![Categorising blood types](images/RhK.png)</span>{#fig-Rh}</span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>If a European New Zealander is chosen at random, what is the probability that they are (Rh+ and K+) or (Rh– and K–)?</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>The answer is 0.0648 + 0.1748 = 0.2396 (verify).</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>Suppose that a murder victim has a bloodstain on him with type (Rh– and K+), presumably from the assailant. What is the probability that a randomly selected person matches this type?</span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a>The answer is 0.0152 (verify).</span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a><span class="fu">### Beached whales example</span></span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a>Assume that 0.63 is the probability of a randomly selected beached whale is a male. So the probability of a beached whale being female is $1-0.63=0.37$. Suppose that we also observe whether beached whales are juvenile or adult, and the probability of a whale being juvenile, given that it is female, is 0.8, and the probability it is juvenile, given that it is male, is 0.4.</span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a>Let us denote the random variables and their outcomes as follows:</span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a>*Sex* (S) = either female ($f$) or male ($m$)</span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a>*Age* (A) = either juvenile ($j$) or adult ($a$)</span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a>We are given</span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a>   $P(S=m) = 0.63$   </span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a>   $P(A=j | S=f) = 0.8$   </span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>   $P(A=j | S=m) = 0.4$</span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Probability tree diagram</span></span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a>Easy to visualise the probabilities with this representation as shown in @fig-PTD.</span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a><span class="al">![Probability tree diagram](images/tree.png)</span>{#fig-PTD}</span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rules of the Probability Tree</span></span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Within each level, all branches are mutually exclusive events. </span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The tree covers all possibilities (i.e., the entire sample space).</span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>We multiply as we move along branches.</span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>We add when we move across branches.</span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a>What is the overall probability that a whale is juvenile? That is, what is $P(A = j)$ (or $P(j)$ for short)?</span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a>$$P(j) = P(m \textbf{ and } j) + P(f \textbf{ and } j)= 0.63\times 0.4+0.37 \times 0.8 = 0.548 $$</span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayes rule</span></span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a>What is the probability of the whale being female given that it is juvenile? i.e., what is $P(f | j)$ ?</span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a>$P(f | j)$ doesn’t appear in the tree anywhere, so we will have to go back to first principles.</span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a>we know that</span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a>$$P(f \textbf{ and }  j)  = P(f | j) × P(j)$$ and   </span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a>$$P(f \textbf{ and }  j)  = P(j | f) × P(f)$$</span>
<span id="cb24-190"><a href="#cb24-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-191"><a href="#cb24-191" aria-hidden="true" tabindex="-1"></a>Thus,  $$P(f | j) × P(j) = P(j | f) × P(f)$$</span>
<span id="cb24-192"><a href="#cb24-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a>$$P(f | j) = \frac {P(j | f) × P(f)} {P(j)}$$</span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a>This is known as the *Bayes rule* or theorem.</span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a>For our question</span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a>$$P(f | j) = \frac {P(j | f) × P(f)} {P(j)}= \frac{0.8 \times 0.37}{0.548}= 0.54$$</span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a><span class="fu"># Probability Distributions</span></span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>Consider the number of eggs $(X)$ in an Adelie penguin’s nest. The values range from $1$ to $5$, each with a certain probability (or relative frequency) of occurrence.</span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a>  <span class="at">X=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>)</span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dfm, <span class="at">booktabs=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="at">full_width =</span> F)</span>
<span id="cb24-217"><a href="#cb24-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-218"><a href="#cb24-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a>The barplot of these probabilities is shown as @fig-discr.</span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-230"><a href="#cb24-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-233"><a href="#cb24-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-234"><a href="#cb24-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb24-235"><a href="#cb24-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-discr</span></span>
<span id="cb24-236"><a href="#cb24-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Barplot of probabilities'</span></span>
<span id="cb24-237"><a href="#cb24-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb24-238"><a href="#cb24-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb24-239"><a href="#cb24-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-240"><a href="#cb24-240" aria-hidden="true" tabindex="-1"></a>dfm <span class="sc">|&gt;</span> </span>
<span id="cb24-241"><a href="#cb24-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-242"><a href="#cb24-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span><span class="st">`</span><span class="at">Probability</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb24-243"><a href="#cb24-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb24-244"><a href="#cb24-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb24-245"><a href="#cb24-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb24-246"><a href="#cb24-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"table"</span>, <span class="at">label =</span> <span class="fu">list</span>(dfm), <span class="at">x=</span><span class="dv">8</span>, <span class="at">y=</span>.<span class="dv">15</span>)</span>
<span id="cb24-247"><a href="#cb24-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-248"><a href="#cb24-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-249"><a href="#cb24-249" aria-hidden="true" tabindex="-1"></a>This is an example of a theoretical probability distribution, which describes the behaviour of a data-producing system. It's a model for producing random values with specific probabilities. </span>
<span id="cb24-250"><a href="#cb24-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-251"><a href="#cb24-251" aria-hidden="true" tabindex="-1"></a>Note the probabilities add to $1$ because ${1,2,3,4,5}$ is a complete distribution. There are no other possibilities.</span>
<span id="cb24-252"><a href="#cb24-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-253"><a href="#cb24-253" aria-hidden="true" tabindex="-1"></a>Two important parameters for describing the probability distribution of a random variable $X$ are:</span>
<span id="cb24-254"><a href="#cb24-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-255"><a href="#cb24-255" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The mean $\mu$ (or "expected value" $\text{E}(X)$). This is the "point of balance", that locates the distribution and puts equal mass either side.</span>
<span id="cb24-256"><a href="#cb24-256" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The variance $\sigma_X^2$ (or $\text{Var}(X)$) is a measure of spread. It is the average squared difference from a value to the mean.</span>
<span id="cb24-257"><a href="#cb24-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-258"><a href="#cb24-258" aria-hidden="true" tabindex="-1"></a>For a discrete probability distribution, the population mean $\mu_X$ is simply the sum of each outcome multiplied by its probability. </span>
<span id="cb24-259"><a href="#cb24-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-260"><a href="#cb24-260" aria-hidden="true" tabindex="-1"></a>$$\mu_X = \text{E}(X) = \sum xP(X=x) = \sum xP(x)$$</span>
<span id="cb24-261"><a href="#cb24-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-262"><a href="#cb24-262" aria-hidden="true" tabindex="-1"></a>In R,</span>
<span id="cb24-263"><a href="#cb24-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-264"><a href="#cb24-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb24-265"><a href="#cb24-265" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb24-266"><a href="#cb24-266" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>)</span>
<span id="cb24-267"><a href="#cb24-267" aria-hidden="true" tabindex="-1"></a>(Mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(X<span class="sc">*</span>P))</span>
<span id="cb24-268"><a href="#cb24-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-269"><a href="#cb24-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-270"><a href="#cb24-270" aria-hidden="true" tabindex="-1"></a>The population variance is given by</span>
<span id="cb24-271"><a href="#cb24-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-272"><a href="#cb24-272" aria-hidden="true" tabindex="-1"></a>$$\sigma_X^2 = \text{Var}(X) = \sum (x-\mu_X)^2 P(x)$$</span>
<span id="cb24-273"><a href="#cb24-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-274"><a href="#cb24-274" aria-hidden="true" tabindex="-1"></a>The population SD is simply the square-root of the variance.</span>
<span id="cb24-275"><a href="#cb24-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-276"><a href="#cb24-276" aria-hidden="true" tabindex="-1"></a>In R,</span>
<span id="cb24-277"><a href="#cb24-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-278"><a href="#cb24-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-279"><a href="#cb24-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb24-280"><a href="#cb24-280" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb24-281"><a href="#cb24-281" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>)</span>
<span id="cb24-282"><a href="#cb24-282" aria-hidden="true" tabindex="-1"></a>Mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">*</span> P)</span>
<span id="cb24-283"><a href="#cb24-283" aria-hidden="true" tabindex="-1"></a>(Variance <span class="ot">&lt;-</span> <span class="fu">sum</span>((X<span class="sc">-</span>Mean)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>P))</span>
<span id="cb24-284"><a href="#cb24-284" aria-hidden="true" tabindex="-1"></a>(SD <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Variance))</span>
<span id="cb24-285"><a href="#cb24-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-286"><a href="#cb24-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-287"><a href="#cb24-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Probability Mass/Density Functions</span></span>
<span id="cb24-288"><a href="#cb24-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-289"><a href="#cb24-289" aria-hidden="true" tabindex="-1"></a>The above example of the distribution of numbers of eggs of penguins is an odd case, because we've simply listed the outcomes and probabilities. More often, we use a known probability distribution where the probabilities of any value of $X$ may be calculated using a Probability Mass Function (PMF, for discrete distributions) or Probability Density Function (PDF, for continuous distributions). A PMF or PDF is a formula that can be used to calculate the probability associated with any value; that is, $\text{P}(X=x)$, the probability that the random variable $X$ will take a particular value $x$. These probabilities arise from making particular assumptions about how the values arise. </span>
<span id="cb24-290"><a href="#cb24-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-291"><a href="#cb24-291" aria-hidden="true" tabindex="-1"></a>The remainder of this chapter will discuss some of the more common probability distributions. </span>
<span id="cb24-292"><a href="#cb24-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-293"><a href="#cb24-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discrete probability distributions</span></span>
<span id="cb24-294"><a href="#cb24-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-295"><a href="#cb24-295" aria-hidden="true" tabindex="-1"></a>Discrete probability distributions are those that can produce a limited set of values, usually non-negative integers <span class="sc">\{</span>0, 1, 2, 3, ...<span class="sc">\}</span>. The two most useful ones are the Binomial and the Poisson. </span>
<span id="cb24-296"><a href="#cb24-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-297"><a href="#cb24-297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Binomial distribution</span></span>
<span id="cb24-298"><a href="#cb24-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-299"><a href="#cb24-299" aria-hidden="true" tabindex="-1"></a>Let $X$ be the number of heads when two coins are tossed. The possible outcomes are shown in @fig-twocoins.</span>
<span id="cb24-300"><a href="#cb24-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-301"><a href="#cb24-301" aria-hidden="true" tabindex="-1"></a><span class="al">![Possible outcomes for two coin tosses](images/binom.png)</span>{#fig-twocoins}</span>
<span id="cb24-302"><a href="#cb24-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-303"><a href="#cb24-303" aria-hidden="true" tabindex="-1"></a>In general, when there only two possible outcomes say  *success* or *failure* ($1$ or $0$; Yes or No; On or Off; Heads or Tails; etc.), we deal with a  *binary* or **Bernoulli** random variable.</span>
<span id="cb24-304"><a href="#cb24-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-305"><a href="#cb24-305" aria-hidden="true" tabindex="-1"></a>The count of the number of *successes* $X$ out of a fixed total of $n$ *independent* trials (in the above coin tossing example, there were $n = 2$ trials) follows the binomial distribution.</span>
<span id="cb24-306"><a href="#cb24-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-307"><a href="#cb24-307" aria-hidden="true" tabindex="-1"></a>In other words, $X \sim Bin(n, p)$, where $p$ the probability of a success. The binomial probability mass function $P(X=x)$ or $P(x)$ is given by</span>
<span id="cb24-308"><a href="#cb24-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-309"><a href="#cb24-309" aria-hidden="true" tabindex="-1"></a>$$P(x)={n \choose x}p^{x}(1-p)^{n-x}$$</span>
<span id="cb24-310"><a href="#cb24-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-311"><a href="#cb24-311" aria-hidden="true" tabindex="-1"></a>It is easy to plot these probabilities in R. For $n=10$, $p=0.3$, the binomial probabilities $P(x)~~~ x=0,1,2, \dots, 10$ are plotted in @fig-dbin.</span>
<span id="cb24-312"><a href="#cb24-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-315"><a href="#cb24-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-316"><a href="#cb24-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-317"><a href="#cb24-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dbin</span></span>
<span id="cb24-318"><a href="#cb24-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Binomial probabilities'</span></span>
<span id="cb24-319"><a href="#cb24-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb24-320"><a href="#cb24-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb24-321"><a href="#cb24-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb24-322"><a href="#cb24-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-323"><a href="#cb24-323" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-324"><a href="#cb24-324" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb24-325"><a href="#cb24-325" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, </span>
<span id="cb24-326"><a href="#cb24-326" aria-hidden="true" tabindex="-1"></a>           <span class="at">probability =</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-327"><a href="#cb24-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x=</span><span class="fu">as.factor</span>(x)) <span class="ot">-&gt;</span>dfm</span>
<span id="cb24-328"><a href="#cb24-328" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> probability)) <span class="sc">+</span> <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb24-329"><a href="#cb24-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"table"</span>, <span class="at">label =</span> <span class="fu">list</span>(dfm), <span class="at">x=</span><span class="dv">11</span>, <span class="at">y=</span>.<span class="dv">05</span>)</span>
<span id="cb24-330"><a href="#cb24-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-331"><a href="#cb24-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-332"><a href="#cb24-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-333"><a href="#cb24-333" aria-hidden="true" tabindex="-1"></a>Example: A microbiologist conducts an experiment to create a recombinant strain of bacteria that is resistant to penicillin. She plates out the bacteria on a plate, and picks out 10 colonies. She knows that the probability of successfully creating a recombinant is 0.15.</span>
<span id="cb24-334"><a href="#cb24-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-335"><a href="#cb24-335" aria-hidden="true" tabindex="-1"></a>What is the probability that if she mixes all 10 colonies in a growth medium with penicillin, something  (anything) will grow?</span>
<span id="cb24-336"><a href="#cb24-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-337"><a href="#cb24-337" aria-hidden="true" tabindex="-1"></a>Given:</span>
<span id="cb24-338"><a href="#cb24-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-339"><a href="#cb24-339" aria-hidden="true" tabindex="-1"></a>$X \sim Bin(n = 10, p = 0.15)$. What is $P(x &gt; 0)$? </span>
<span id="cb24-340"><a href="#cb24-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-341"><a href="#cb24-341" aria-hidden="true" tabindex="-1"></a>Note  $P(x &gt; 0)=1-P(x = 0)$.  So in R, compute this as follows:</span>
<span id="cb24-342"><a href="#cb24-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-343"><a href="#cb24-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb24-344"><a href="#cb24-344" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span>.<span class="dv">15</span>)</span>
<span id="cb24-345"><a href="#cb24-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-346"><a href="#cb24-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-347"><a href="#cb24-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-348"><a href="#cb24-348" aria-hidden="true" tabindex="-1"></a>or</span>
<span id="cb24-349"><a href="#cb24-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-350"><a href="#cb24-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb24-351"><a href="#cb24-351" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span>.<span class="dv">15</span>)</span>
<span id="cb24-352"><a href="#cb24-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-353"><a href="#cb24-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-354"><a href="#cb24-354" aria-hidden="true" tabindex="-1"></a>Note that function <span class="in">`pbinom(k,size=n,prob=p)`</span> gives the cumulative probabilities up to and including the quantile $k$ (which is equal to zero in our example). </span>
<span id="cb24-355"><a href="#cb24-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-356"><a href="#cb24-356" aria-hidden="true" tabindex="-1"></a>$$P(X\leq k)=\sum _{i=0}^{k}{n \choose x}p^{x}(1-p)^{n-x}$$</span>
<span id="cb24-357"><a href="#cb24-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-358"><a href="#cb24-358" aria-hidden="true" tabindex="-1"></a>The mean and variance of the binomial random variable is given by</span>
<span id="cb24-359"><a href="#cb24-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-360"><a href="#cb24-360" aria-hidden="true" tabindex="-1"></a>$$\mu_X=np~~~~ \sigma^2_X=np(1-p)$$</span>
<span id="cb24-361"><a href="#cb24-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-362"><a href="#cb24-362" aria-hidden="true" tabindex="-1"></a>So the expected number of recombinant strain of bacteria would be</span>
<span id="cb24-363"><a href="#cb24-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-364"><a href="#cb24-364" aria-hidden="true" tabindex="-1"></a>$$\mu_X=np=10*0.15=1.5$$</span>
<span id="cb24-365"><a href="#cb24-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-366"><a href="#cb24-366" aria-hidden="true" tabindex="-1"></a>with SD</span>
<span id="cb24-367"><a href="#cb24-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-368"><a href="#cb24-368" aria-hidden="true" tabindex="-1"></a>$$\sigma_X=\sqrt {np(1-p)}=1.129159$$</span>
<span id="cb24-369"><a href="#cb24-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-370"><a href="#cb24-370" aria-hidden="true" tabindex="-1"></a><span class="fu">### Poisson distribution</span></span>
<span id="cb24-371"><a href="#cb24-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-372"><a href="#cb24-372" aria-hidden="true" tabindex="-1"></a>The Poisson distribution is used to obtain the probabilities of counts of relatively rare events or outcomes that occur independently in space or time. </span>
<span id="cb24-373"><a href="#cb24-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-374"><a href="#cb24-374" aria-hidden="true" tabindex="-1"></a>Some Examples:</span>
<span id="cb24-375"><a href="#cb24-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-376"><a href="#cb24-376" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The number of snails in a quadrat ($1~m^2$)</span>
<span id="cb24-377"><a href="#cb24-377" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Fish counts in a visual transect (25 x 5 m)</span>
<span id="cb24-378"><a href="#cb24-378" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Bacterial colonies in 2 litres of milk</span>
<span id="cb24-379"><a href="#cb24-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-380"><a href="#cb24-380" aria-hidden="true" tabindex="-1"></a>The random variable $X$,  the number of occurrences (count), often follows the Poisson distribution whose probability function is given by</span>
<span id="cb24-381"><a href="#cb24-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-382"><a href="#cb24-382" aria-hidden="true" tabindex="-1"></a>$$\Pr(x)= \frac{\lambda^x e^{-\lambda}}{x!}~~~ x=0,1,2,\dots, \infty$$</span>
<span id="cb24-383"><a href="#cb24-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-384"><a href="#cb24-384" aria-hidden="true" tabindex="-1"></a>The parameter $\lambda$ is the mean  which is also equal to the variance.</span>
<span id="cb24-385"><a href="#cb24-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-386"><a href="#cb24-386" aria-hidden="true" tabindex="-1"></a>$$\mu_X=\lambda~~~~ \sigma^2_X=\lambda$$</span>
<span id="cb24-387"><a href="#cb24-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-388"><a href="#cb24-388" aria-hidden="true" tabindex="-1"></a>Main assumptions:</span>
<span id="cb24-389"><a href="#cb24-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-390"><a href="#cb24-390" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The events occur at a constant average rate of $\lambda$ per unit time or space.</span>
<span id="cb24-391"><a href="#cb24-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-392"><a href="#cb24-392" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Occurrences are independent of one another as well as they do not happen at exactly the same unit time or space.</span>
<span id="cb24-393"><a href="#cb24-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-394"><a href="#cb24-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-395"><a href="#cb24-395" aria-hidden="true" tabindex="-1"></a>Example: Consider the number of changes that accumulate along a stretch of a neutrally evolving gene over a given period of time.</span>
<span id="cb24-396"><a href="#cb24-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-397"><a href="#cb24-397" aria-hidden="true" tabindex="-1"></a>This is a Poisson random variable with a population mean of $\lambda=kt$, where $k$ is the number of mutations per generation, and $t$ is the time in generations that has elapsed.</span>
<span id="cb24-398"><a href="#cb24-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-399"><a href="#cb24-399" aria-hidden="true" tabindex="-1"></a>Assume that $k = 1\times10^{-4}$ and $t = 500$.</span>
<span id="cb24-400"><a href="#cb24-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-401"><a href="#cb24-401" aria-hidden="true" tabindex="-1"></a>For  $\lambda=kt=0.05$, the Poisson probabilities are shown in @fig-dpoi.</span>
<span id="cb24-402"><a href="#cb24-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-405"><a href="#cb24-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-406"><a href="#cb24-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-407"><a href="#cb24-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dpoi</span></span>
<span id="cb24-408"><a href="#cb24-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Poisson probabilities'</span></span>
<span id="cb24-409"><a href="#cb24-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb24-410"><a href="#cb24-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb24-411"><a href="#cb24-411" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-412"><a href="#cb24-412" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb24-413"><a href="#cb24-413" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb24-414"><a href="#cb24-414" aria-hidden="true" tabindex="-1"></a>           <span class="at">probability =</span> <span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">lambda=</span><span class="fl">0.05</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-415"><a href="#cb24-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x=</span><span class="fu">as.factor</span>(x), <span class="at">probability =</span> <span class="fu">round</span>(probability,<span class="dv">4</span>)) <span class="ot">-&gt;</span>dfm</span>
<span id="cb24-416"><a href="#cb24-416" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> probability)) <span class="sc">+</span> <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb24-417"><a href="#cb24-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"table"</span>, <span class="at">label =</span> <span class="fu">list</span>(dfm), <span class="at">x=</span><span class="dv">5</span>, <span class="at">y=</span>.<span class="dv">25</span>)</span>
<span id="cb24-418"><a href="#cb24-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-419"><a href="#cb24-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-420"><a href="#cb24-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-421"><a href="#cb24-421" aria-hidden="true" tabindex="-1"></a>What is the probability that at least one mutation has occurred over this period?</span>
<span id="cb24-422"><a href="#cb24-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-423"><a href="#cb24-423" aria-hidden="true" tabindex="-1"></a>$P(x &gt; 0)=1-P(x = 0)$ is found in R as follows:</span>
<span id="cb24-424"><a href="#cb24-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-427"><a href="#cb24-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-428"><a href="#cb24-428" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">dpois</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">lambda=</span><span class="fl">0.05</span>)</span>
<span id="cb24-429"><a href="#cb24-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-430"><a href="#cb24-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-431"><a href="#cb24-431" aria-hidden="true" tabindex="-1"></a>Another example: The number of parasites in a host is a Poisson random variable with mean 1.5. What is the probability that there will be exactly one parasite in the host?  Examine @fig-parasite for the answer.</span>
<span id="cb24-432"><a href="#cb24-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-435"><a href="#cb24-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-436"><a href="#cb24-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-437"><a href="#cb24-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-parasite</span></span>
<span id="cb24-438"><a href="#cb24-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Parasites distribution'</span></span>
<span id="cb24-439"><a href="#cb24-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb24-440"><a href="#cb24-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb24-441"><a href="#cb24-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-442"><a href="#cb24-442" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-443"><a href="#cb24-443" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb24-444"><a href="#cb24-444" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, </span>
<span id="cb24-445"><a href="#cb24-445" aria-hidden="true" tabindex="-1"></a>           <span class="at">probability =</span> <span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">lambda=</span><span class="fl">1.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-446"><a href="#cb24-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x=</span><span class="fu">as.factor</span>(x), </span>
<span id="cb24-447"><a href="#cb24-447" aria-hidden="true" tabindex="-1"></a>         <span class="at">probability =</span> <span class="fu">round</span>(probability,<span class="dv">4</span>),</span>
<span id="cb24-448"><a href="#cb24-448" aria-hidden="true" tabindex="-1"></a>         <span class="at">parasites =</span> <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"1"</span>, <span class="st">"Not 1"</span>)) <span class="ot">-&gt;</span>dfm</span>
<span id="cb24-449"><a href="#cb24-449" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> probability, <span class="at">fill =</span> parasites)) <span class="sc">+</span> </span>
<span id="cb24-450"><a href="#cb24-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb24-451"><a href="#cb24-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"table"</span>, <span class="at">label =</span> <span class="fu">list</span>(dfm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="at">x=</span><span class="dv">10</span>, <span class="at">y=</span>.<span class="dv">3</span>)</span>
<span id="cb24-452"><a href="#cb24-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-453"><a href="#cb24-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-454"><a href="#cb24-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## Continuous probability distributions</span></span>
<span id="cb24-455"><a href="#cb24-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-456"><a href="#cb24-456" aria-hidden="true" tabindex="-1"></a>A discrete random variable takes values which are simply points on a real line.  In other words, there is an inherent discontinuity in the values a discrete random variable can take.</span>
<span id="cb24-457"><a href="#cb24-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-458"><a href="#cb24-458" aria-hidden="true" tabindex="-1"></a>If a random variable, $X$, can take any value (i.e., not just integers) in some interval of the real line, it is called a *continuous* random variable.  Examples include variables such as height, weight, length, percentage protein etc.</span>
<span id="cb24-459"><a href="#cb24-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-460"><a href="#cb24-460" aria-hidden="true" tabindex="-1"></a>For a discrete random variable $X$, the associated probabilities $P(X=x)$ are also just points or masses, and hence the probability function $P(x)$ is also called as the probability mass function (*pmf*).</span>
<span id="cb24-461"><a href="#cb24-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-462"><a href="#cb24-462" aria-hidden="true" tabindex="-1"></a>For continuous random variables, probabilities can be computed when the variable falls in an interval such as $5$ to $15$, but not when it takes a fixed value such as $10$ (which is equal to zero).</span>
<span id="cb24-463"><a href="#cb24-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-464"><a href="#cb24-464" aria-hidden="true" tabindex="-1"></a>The probability density function (pdf) gives the probabilities as an area under the curve.</span>
<span id="cb24-465"><a href="#cb24-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-466"><a href="#cb24-466" aria-hidden="true" tabindex="-1"></a>For example, consider a random proportion $(X)$ between $0$ and $1$.  Here $X$ follows a (standard) continuous uniform distribution whose (probability) density function $f(x)$ is defined as follows:</span>
<span id="cb24-467"><a href="#cb24-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-468"><a href="#cb24-468" aria-hidden="true" tabindex="-1"></a>$$f(x)=\begin{cases}{1}~~~\mathrm {for} \ 0\leq x\leq 1,\\[9pt]0~~~\mathrm {for} \ x&lt;0\ \mathrm {or} \ x&gt;1\end{cases}$$</span>
<span id="cb24-469"><a href="#cb24-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-470"><a href="#cb24-470" aria-hidden="true" tabindex="-1"></a>This constant density function is very simple; see @fig-constdens. </span>
<span id="cb24-471"><a href="#cb24-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-474"><a href="#cb24-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-475"><a href="#cb24-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-constdens</span></span>
<span id="cb24-476"><a href="#cb24-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Constant density between 0 and 1"</span></span>
<span id="cb24-477"><a href="#cb24-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb24-478"><a href="#cb24-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-479"><a href="#cb24-479" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="fl">1.5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb24-480"><a href="#cb24-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb24-481"><a href="#cb24-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb24-482"><a href="#cb24-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb24-483"><a href="#cb24-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dunif, </span>
<span id="cb24-484"><a href="#cb24-484" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">10001</span>, </span>
<span id="cb24-485"><a href="#cb24-485" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb24-486"><a href="#cb24-486" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb24-487"><a href="#cb24-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"f(x)"</span>) <span class="sc">+</span></span>
<span id="cb24-488"><a href="#cb24-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb24-489"><a href="#cb24-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-490"><a href="#cb24-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-491"><a href="#cb24-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-492"><a href="#cb24-492" aria-hidden="true" tabindex="-1"></a>The cumulative distribution function, CDF,  $F(x)$ gives the left tail area or probability up to $x$.  This is probability is found as</span>
<span id="cb24-493"><a href="#cb24-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-494"><a href="#cb24-494" aria-hidden="true" tabindex="-1"></a>$$F_{X}(x)=\int _{-\infty }^{x}f_{X}(t)\,dt$$</span>
<span id="cb24-495"><a href="#cb24-495" aria-hidden="true" tabindex="-1"></a>The relationship between the density function $f(x)$ and the distribution function $F(x)$ is given by the *Fundamental Theorem of Calculus*.</span>
<span id="cb24-496"><a href="#cb24-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-497"><a href="#cb24-497" aria-hidden="true" tabindex="-1"></a>$$f(x)={dF(x) \over dx}$$</span>
<span id="cb24-498"><a href="#cb24-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-499"><a href="#cb24-499" aria-hidden="true" tabindex="-1"></a>The total area under the pdf curve is $1$. The probability of obtaining a value between two points ($a$ and $b$) is the area under the pdf curve between those two points.  This probability is given by $F(b)-F(a)$.</span>
<span id="cb24-500"><a href="#cb24-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-501"><a href="#cb24-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-502"><a href="#cb24-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-503"><a href="#cb24-503" aria-hidden="true" tabindex="-1"></a>For the uniform distribution $U(0,1)$, $f(x)=1$. So,</span>
<span id="cb24-504"><a href="#cb24-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-505"><a href="#cb24-505" aria-hidden="true" tabindex="-1"></a>$$F_{X}(x)=\int _{-\infty }^{x}\,dt=x$$</span>
<span id="cb24-506"><a href="#cb24-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-507"><a href="#cb24-507" aria-hidden="true" tabindex="-1"></a>For example, the probability of a randomly drawn fraction from the interval $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ to fall below $x=0.5$ is 50%.</span>
<span id="cb24-508"><a href="#cb24-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-509"><a href="#cb24-509" aria-hidden="true" tabindex="-1"></a>The probability of a random fraction falling between $a=0.2$ and $b=0.8$ is</span>
<span id="cb24-510"><a href="#cb24-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-511"><a href="#cb24-511" aria-hidden="true" tabindex="-1"></a>$$F(b)-F(a)=0.8-0.2=0.6$$</span>
<span id="cb24-512"><a href="#cb24-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-513"><a href="#cb24-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-514"><a href="#cb24-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-515"><a href="#cb24-515" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normal distribution</span></span>
<span id="cb24-516"><a href="#cb24-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-517"><a href="#cb24-517" aria-hidden="true" tabindex="-1"></a>The Gaussian or normal distribution is parameterised in terms of the mean $\mu$ and the variance $\sigma ^{2}$ and its density function is given by</span>
<span id="cb24-518"><a href="#cb24-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-519"><a href="#cb24-519" aria-hidden="true" tabindex="-1"></a>$$f(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}}$$</span>
<span id="cb24-520"><a href="#cb24-520" aria-hidden="true" tabindex="-1"></a>If $X \sim N(\mu, \sigma)$, its Z-score is calculated from $X$ by subtracting $\mu$ and dividing by the standard deviation $\sigma$.</span>
<span id="cb24-521"><a href="#cb24-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-522"><a href="#cb24-522" aria-hidden="true" tabindex="-1"></a>$$Z={\frac {X-\mu }{\sigma }}$$ </span>
<span id="cb24-523"><a href="#cb24-523" aria-hidden="true" tabindex="-1"></a>The random variable $Z \sim N(0,1)$.  Its pdf is given by</span>
<span id="cb24-524"><a href="#cb24-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-525"><a href="#cb24-525" aria-hidden="true" tabindex="-1"></a>$$f(z)={\frac {1}{ {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}z^{2}}$$</span>
<span id="cb24-526"><a href="#cb24-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-527"><a href="#cb24-527" aria-hidden="true" tabindex="-1"></a>We often deal with the Standard normal because the *symmetric* bell shape of the normal distribution remains the same for all $\mu$ and $\sigma$; see @fig-nrm.</span>
<span id="cb24-528"><a href="#cb24-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-531"><a href="#cb24-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-532"><a href="#cb24-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-533"><a href="#cb24-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nrm</span></span>
<span id="cb24-534"><a href="#cb24-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Standard Normal Density'</span></span>
<span id="cb24-535"><a href="#cb24-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb24-536"><a href="#cb24-536" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb24-537"><a href="#cb24-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-538"><a href="#cb24-538" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-539"><a href="#cb24-539" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb24-540"><a href="#cb24-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"standard normal deviate, z"</span>)</span>
<span id="cb24-541"><a href="#cb24-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-542"><a href="#cb24-542" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb24-543"><a href="#cb24-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb24-544"><a href="#cb24-544" aria-hidden="true" tabindex="-1"></a>                <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>), </span>
<span id="cb24-545"><a href="#cb24-545" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>) <span class="sc">+</span> </span>
<span id="cb24-546"><a href="#cb24-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb24-547"><a href="#cb24-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standard Normal Density"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"f(x)"</span>)</span>
<span id="cb24-548"><a href="#cb24-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-549"><a href="#cb24-549" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb24-550"><a href="#cb24-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">lwd=</span><span class="fl">1.02</span>) <span class="sc">+</span> </span>
<span id="cb24-551"><a href="#cb24-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb24-552"><a href="#cb24-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cumulative Standard Normal Density"</span>) <span class="sc">+</span></span>
<span id="cb24-553"><a href="#cb24-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"F(x)"</span>)</span>
<span id="cb24-554"><a href="#cb24-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-555"><a href="#cb24-555" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb24-556"><a href="#cb24-556" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2  <span class="sc">&amp;</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb24-557"><a href="#cb24-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-558"><a href="#cb24-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-559"><a href="#cb24-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-560"><a href="#cb24-560" aria-hidden="true" tabindex="-1"></a>Example: The weight of an individual of *Amphibola crenata* (snail) is normally distributed with a mean of $40g$ and variance of $20g^2$ as shown in @fig-nrmeg.  </span>
<span id="cb24-561"><a href="#cb24-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-564"><a href="#cb24-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-565"><a href="#cb24-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb24-566"><a href="#cb24-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nrmeg</span></span>
<span id="cb24-567"><a href="#cb24-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Distribution of snail weight'</span></span>
<span id="cb24-568"><a href="#cb24-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb24-569"><a href="#cb24-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb24-570"><a href="#cb24-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-571"><a href="#cb24-571" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-572"><a href="#cb24-572" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">60</span>, <span class="at">length=</span><span class="dv">1000</span>), </span>
<span id="cb24-573"><a href="#cb24-573" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>))</span>
<span id="cb24-574"><a href="#cb24-574" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-575"><a href="#cb24-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-576"><a href="#cb24-576" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfs) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span>) <span class="sc">+</span> </span>
<span id="cb24-577"><a href="#cb24-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb24-578"><a href="#cb24-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">40</span>) </span>
<span id="cb24-579"><a href="#cb24-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-580"><a href="#cb24-580" aria-hidden="true" tabindex="-1"></a>ps</span>
<span id="cb24-581"><a href="#cb24-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-582"><a href="#cb24-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-583"><a href="#cb24-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-584"><a href="#cb24-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-585"><a href="#cb24-585" aria-hidden="true" tabindex="-1"></a>What is the probability of getting a snail that weighs between $35g$ and $50g$? In R, the function <span class="in">`pnorm()`</span> gives the CDF.</span>
<span id="cb24-586"><a href="#cb24-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-587"><a href="#cb24-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb24-588"><a href="#cb24-588" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">50</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) <span class="sc">-</span> </span>
<span id="cb24-589"><a href="#cb24-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(<span class="dv">35</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) </span>
<span id="cb24-590"><a href="#cb24-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-591"><a href="#cb24-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-592"><a href="#cb24-592" aria-hidden="true" tabindex="-1"></a>@fig-snail illustrates the computation.</span>
<span id="cb24-593"><a href="#cb24-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-596"><a href="#cb24-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-597"><a href="#cb24-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-snail</span></span>
<span id="cb24-598"><a href="#cb24-598" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb24-599"><a href="#cb24-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Probability of snail weight being between 35 g and 50 g'</span></span>
<span id="cb24-600"><a href="#cb24-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb24-601"><a href="#cb24-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb24-602"><a href="#cb24-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-603"><a href="#cb24-603" aria-hidden="true" tabindex="-1"></a>ps <span class="sc">+</span> </span>
<span id="cb24-604"><a href="#cb24-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> dfs <span class="sc">|&gt;</span> <span class="fu">filter</span>(x <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="dv">35</span>),</span>
<span id="cb24-605"><a href="#cb24-605" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">"coral1"</span>, <span class="at">alpha=</span>.<span class="dv">5</span>)</span>
<span id="cb24-606"><a href="#cb24-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-607"><a href="#cb24-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-608"><a href="#cb24-608" aria-hidden="true" tabindex="-1"></a>What is the probability of getting a snail that weighs below $35g$ or over $50g$?</span>
<span id="cb24-609"><a href="#cb24-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-610"><a href="#cb24-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb24-611"><a href="#cb24-611" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">35</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb24-612"><a href="#cb24-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(<span class="dv">50</span>, <span class="at">mean=</span><span class="dv">40</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">20</span>), <span class="at">lower.tail=</span><span class="cn">FALSE</span>) </span>
<span id="cb24-613"><a href="#cb24-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-614"><a href="#cb24-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-615"><a href="#cb24-615" aria-hidden="true" tabindex="-1"></a>Under standard normal, the areas under the pdf curve are shown in @fig-ncurves for various situations.</span>
<span id="cb24-616"><a href="#cb24-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-619"><a href="#cb24-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-620"><a href="#cb24-620" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ncurves</span></span>
<span id="cb24-621"><a href="#cb24-621" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-622"><a href="#cb24-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Standard normal coverage'</span></span>
<span id="cb24-623"><a href="#cb24-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb24-624"><a href="#cb24-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb24-625"><a href="#cb24-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-626"><a href="#cb24-626" aria-hidden="true" tabindex="-1"></a>plot_area <span class="ot">&lt;-</span> <span class="cf">function</span>(lower, upper) {</span>
<span id="cb24-627"><a href="#cb24-627" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb24-628"><a href="#cb24-628" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb24-629"><a href="#cb24-629" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb24-630"><a href="#cb24-630" aria-hidden="true" tabindex="-1"></a>  area <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> (<span class="fu">pnorm</span>(upper) <span class="sc">-</span> <span class="fu">pnorm</span>(lower)), <span class="dv">1</span>)</span>
<span id="cb24-631"><a href="#cb24-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb24-632"><a href="#cb24-632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb24-633"><a href="#cb24-633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb24-634"><a href="#cb24-634" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlim =</span> <span class="fu">c</span>(lower, upper),</span>
<span id="cb24-635"><a href="#cb24-635" aria-hidden="true" tabindex="-1"></a>                  <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb24-636"><a href="#cb24-636" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">'coral1'</span>,</span>
<span id="cb24-637"><a href="#cb24-637" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb24-638"><a href="#cb24-638" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(lower, upper)) <span class="sc">+</span></span>
<span id="cb24-639"><a href="#cb24-639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="fu">paste</span>(area, <span class="st">"%"</span>, <span class="at">sep=</span><span class="st">""</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb24-640"><a href="#cb24-640" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-641"><a href="#cb24-641" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-642"><a href="#cb24-642" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb24-643"><a href="#cb24-643" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-644"><a href="#cb24-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-645"><a href="#cb24-645" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_area</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb24-646"><a href="#cb24-646" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_area</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb24-647"><a href="#cb24-647" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_area</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb24-648"><a href="#cb24-648" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_area</span>(<span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>)</span>
<span id="cb24-649"><a href="#cb24-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-650"><a href="#cb24-650" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb24-651"><a href="#cb24-651" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span>p3<span class="sc">+</span>p4</span>
<span id="cb24-652"><a href="#cb24-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-653"><a href="#cb24-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-654"><a href="#cb24-654" aria-hidden="true" tabindex="-1"></a><span class="fu">### Skewed distributions</span></span>
<span id="cb24-655"><a href="#cb24-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-656"><a href="#cb24-656" aria-hidden="true" tabindex="-1"></a>There are many probability distributions which are asymmetrical. A few of them are briefed here.</span>
<span id="cb24-657"><a href="#cb24-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-658"><a href="#cb24-658" aria-hidden="true" tabindex="-1"></a> **Log-normal**</span>
<span id="cb24-659"><a href="#cb24-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-660"><a href="#cb24-660" aria-hidden="true" tabindex="-1"></a>A random variable $X$ is log-normally distributed, when $log_e(X)$ follows normal. Alternatively, if $X$ follows normal, then $e^X$ follows log-normal.</span>
<span id="cb24-661"><a href="#cb24-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-662"><a href="#cb24-662" aria-hidden="true" tabindex="-1"></a>The log-normal density function is shown below:</span>
<span id="cb24-663"><a href="#cb24-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-664"><a href="#cb24-664" aria-hidden="true" tabindex="-1"></a>$$f(x)={\frac {1}{x\sigma {\sqrt {2\pi }}}}\ \exp \left(-{\frac {\left(\ln x-\mu \right)^{2}}{2\sigma ^{2}}}\right),~~ x&gt;0$$</span>
<span id="cb24-665"><a href="#cb24-665" aria-hidden="true" tabindex="-1"></a>While the R function <span class="in">`dnorm()`</span> gives the normal density, the function <span class="in">`dlnorm()`</span> gives the log-normal density.</span>
<span id="cb24-666"><a href="#cb24-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-667"><a href="#cb24-667" aria-hidden="true" tabindex="-1"></a>The standard log-normal pdf and CDF are plotted in @fig-lnrm</span>
<span id="cb24-668"><a href="#cb24-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-669"><a href="#cb24-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-672"><a href="#cb24-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-673"><a href="#cb24-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lnrm</span></span>
<span id="cb24-674"><a href="#cb24-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-675"><a href="#cb24-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Log-normal pdf and CDF'</span></span>
<span id="cb24-676"><a href="#cb24-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb24-677"><a href="#cb24-677" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb24-678"><a href="#cb24-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-679"><a href="#cb24-679" aria-hidden="true" tabindex="-1"></a>dfln <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">1000</span>), </span>
<span id="cb24-680"><a href="#cb24-680" aria-hidden="true" tabindex="-1"></a>              <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dlnorm</span>(x), </span>
<span id="cb24-681"><a href="#cb24-681" aria-hidden="true" tabindex="-1"></a>              <span class="st">`</span><span class="at">F(x)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">plnorm</span>(x))</span>
<span id="cb24-682"><a href="#cb24-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-683"><a href="#cb24-683" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfln) <span class="sc">+</span> </span>
<span id="cb24-684"><a href="#cb24-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span><span class="st">`</span><span class="at">f(x)</span><span class="st">`</span>) <span class="sc">+</span> </span>
<span id="cb24-685"><a href="#cb24-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha=</span>.<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb24-686"><a href="#cb24-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standard log-normal density"</span>, </span>
<span id="cb24-687"><a href="#cb24-687" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"standard log-normal deviate, z"</span>)</span>
<span id="cb24-688"><a href="#cb24-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-689"><a href="#cb24-689" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfln) <span class="sc">+</span> </span>
<span id="cb24-690"><a href="#cb24-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="st">`</span><span class="at">F(x)</span><span class="st">`</span>) <span class="sc">+</span> </span>
<span id="cb24-691"><a href="#cb24-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb24-692"><a href="#cb24-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cumulative standard log-normal density"</span>, </span>
<span id="cb24-693"><a href="#cb24-693" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"standard log-normal deviate, z"</span>)</span>
<span id="cb24-694"><a href="#cb24-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-695"><a href="#cb24-695" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span>
<span id="cb24-696"><a href="#cb24-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-697"><a href="#cb24-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-698"><a href="#cb24-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-699"><a href="#cb24-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-700"><a href="#cb24-700" aria-hidden="true" tabindex="-1"></a>The mean &amp; variance of the lognormal random variables are:</span>
<span id="cb24-701"><a href="#cb24-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-702"><a href="#cb24-702" aria-hidden="true" tabindex="-1"></a>$$\mu_X=e^{\left(\mu +{\frac {\sigma ^{2}}{2}}\right)}~~~~\sigma_X^2=(e^{\sigma ^{2}}-1) e^{(2\mu +\sigma ^{2})}$$</span>
<span id="cb24-703"><a href="#cb24-703" aria-hidden="true" tabindex="-1"></a> **Gamma**</span>
<span id="cb24-704"><a href="#cb24-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-705"><a href="#cb24-705" aria-hidden="true" tabindex="-1"></a>The probability function of the gamma distribution with shape parameter $\alpha$ and scale parameter $\beta$ is given below:</span>
<span id="cb24-706"><a href="#cb24-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-707"><a href="#cb24-707" aria-hidden="true" tabindex="-1"></a>$$\displaystyle {\begin{aligned}f(x)={\frac {\beta ^{\alpha }x^{\alpha -1}e^{-\beta x}}{\Gamma (\alpha )}}\quad {\text{ for }}x&gt;0\quad \alpha ,\beta &gt;0,<span class="sc">\\</span><span class="co">[</span><span class="ot">6pt</span><span class="co">]</span>\end{aligned}}$$</span>
<span id="cb24-708"><a href="#cb24-708" aria-hidden="true" tabindex="-1"></a>where $\displaystyle \Gamma (\alpha)=\int _{0}^{\infty }x^{\alpha-1}e^{-x}\,dx.$ </span>
<span id="cb24-709"><a href="#cb24-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-710"><a href="#cb24-710" aria-hidden="true" tabindex="-1"></a>@fig-gam shows the plot of gamma density for various shape and scale parameters.</span>
<span id="cb24-711"><a href="#cb24-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-714"><a href="#cb24-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-715"><a href="#cb24-715" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gam</span></span>
<span id="cb24-716"><a href="#cb24-716" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-717"><a href="#cb24-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Gamma distributional shapes'</span></span>
<span id="cb24-718"><a href="#cb24-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb24-719"><a href="#cb24-719" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb24-720"><a href="#cb24-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-721"><a href="#cb24-721" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-722"><a href="#cb24-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fl">0.5</span>, <span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb24-723"><a href="#cb24-723" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-724"><a href="#cb24-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape = 0.5, scale = 1"</span>)</span>
<span id="cb24-725"><a href="#cb24-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-726"><a href="#cb24-726" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-727"><a href="#cb24-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb24-728"><a href="#cb24-728" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-729"><a href="#cb24-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape = 1, scale = 1"</span>)</span>
<span id="cb24-730"><a href="#cb24-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-731"><a href="#cb24-731" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-732"><a href="#cb24-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb24-733"><a href="#cb24-733" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-734"><a href="#cb24-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape = 3, scale = 1"</span>)</span>
<span id="cb24-735"><a href="#cb24-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-736"><a href="#cb24-736" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-737"><a href="#cb24-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">6</span>, <span class="at">scale =</span> <span class="dv">4</span>),</span>
<span id="cb24-738"><a href="#cb24-738" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-739"><a href="#cb24-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape = 6, scale = 4"</span>)</span>
<span id="cb24-740"><a href="#cb24-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-741"><a href="#cb24-741" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span>p3<span class="sc">+</span>p4</span>
<span id="cb24-742"><a href="#cb24-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-743"><a href="#cb24-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-744"><a href="#cb24-744" aria-hidden="true" tabindex="-1"></a>Lognormal, Weibull  and  gamma distributions are useful to model right skewed data, particularly lifetimes data, but we need large amount of data, say over 300, to discriminate the three fitted distributions.</span>
<span id="cb24-745"><a href="#cb24-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-746"><a href="#cb24-746" aria-hidden="true" tabindex="-1"></a> **Beta distribution**</span>
<span id="cb24-747"><a href="#cb24-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-748"><a href="#cb24-748" aria-hidden="true" tabindex="-1"></a>The beta distribution is bounded on the interval $<span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$ and  parameterised by two positive shape parameters, say $\alpha$ and $\beta$.</span>
<span id="cb24-749"><a href="#cb24-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-750"><a href="#cb24-750" aria-hidden="true" tabindex="-1"></a>The probability function of the Weibull distribution is given below:</span>
<span id="cb24-751"><a href="#cb24-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-752"><a href="#cb24-752" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}f(x;\alpha ,\beta ) ={\frac {x^{\alpha -1}(1-x)^{\beta -1}}{\displaystyle \int _{0}^{1}u^{\alpha -1}(1-u)^{\beta -1}\,du}}={\frac {1}{\mathrm {B} (\alpha ,\beta )}}x^{\alpha -1}(1-x)^{\beta -1}\end{aligned} $$</span>
<span id="cb24-753"><a href="#cb24-753" aria-hidden="true" tabindex="-1"></a>where $\mathrm {B} (\alpha ,\beta )=\frac {\Gamma (\alpha )\Gamma (\beta )}{\Gamma (\alpha +\beta )}$.  @fig-betas shows the plot of beta density for various shape parameter combinations.</span>
<span id="cb24-754"><a href="#cb24-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-755"><a href="#cb24-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-758"><a href="#cb24-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-759"><a href="#cb24-759" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-betas</span></span>
<span id="cb24-760"><a href="#cb24-760" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-761"><a href="#cb24-761" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Beta distributional shapes'</span></span>
<span id="cb24-762"><a href="#cb24-762" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb24-763"><a href="#cb24-763" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb24-764"><a href="#cb24-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-765"><a href="#cb24-765" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-766"><a href="#cb24-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-767"><a href="#cb24-767" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-768"><a href="#cb24-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape1 = 0.5, shape2 = 0.5"</span>)</span>
<span id="cb24-769"><a href="#cb24-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-770"><a href="#cb24-770" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-771"><a href="#cb24-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">2</span>),</span>
<span id="cb24-772"><a href="#cb24-772" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-773"><a href="#cb24-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape1 = 2, shape2 = 2"</span>)</span>
<span id="cb24-774"><a href="#cb24-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-775"><a href="#cb24-775" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-776"><a href="#cb24-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">5</span>),</span>
<span id="cb24-777"><a href="#cb24-777" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-778"><a href="#cb24-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape1 = 2, shape2 = 5"</span>)</span>
<span id="cb24-779"><a href="#cb24-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-780"><a href="#cb24-780" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb24-781"><a href="#cb24-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">5</span>, <span class="at">shape2 =</span> <span class="dv">2</span>),</span>
<span id="cb24-782"><a href="#cb24-782" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="st">'area'</span>) <span class="sc">+</span></span>
<span id="cb24-783"><a href="#cb24-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"shape1 = 6, shape2 = 4"</span>)</span>
<span id="cb24-784"><a href="#cb24-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-785"><a href="#cb24-785" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span>p3<span class="sc">+</span>p4</span>
<span id="cb24-786"><a href="#cb24-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-787"><a href="#cb24-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-788"><a href="#cb24-788" aria-hidden="true" tabindex="-1"></a>When $\alpha=\beta=1$, the beta distribution becomes the continuous uniform distribution.  This distribution is useful to model component fractions such as percentage of protein in milk powder, and is also widely used in Bayesian analysis.</span>
<span id="cb24-789"><a href="#cb24-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-790"><a href="#cb24-790" aria-hidden="true" tabindex="-1"></a><span class="fu">### Empirical distributions</span></span>
<span id="cb24-791"><a href="#cb24-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-792"><a href="#cb24-792" aria-hidden="true" tabindex="-1"></a>Data from a normal (or any other distribution) may not look very much like the expected theoretical shape ('bell-curve' for normal)  unless there is very large amount of it.  @fig-rn200 is for a random sample of 200 from the standard normal distribution.  Compare the departures from the expected theoretical shape.  Recall that we covered the ECDF curves in the last Chapter.  The CDF curve is just theoretical one but fitted with data.  More on this later.</span>
<span id="cb24-793"><a href="#cb24-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-796"><a href="#cb24-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-797"><a href="#cb24-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rn200</span></span>
<span id="cb24-798"><a href="#cb24-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-799"><a href="#cb24-799" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-800"><a href="#cb24-800" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb24-801"><a href="#cb24-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Normal(0,1) data (n=200)'</span></span>
<span id="cb24-802"><a href="#cb24-802" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb24-803"><a href="#cb24-803" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb24-804"><a href="#cb24-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-805"><a href="#cb24-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-806"><a href="#cb24-806" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-807"><a href="#cb24-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-808"><a href="#cb24-808" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean=</span><span class="dv">80</span>, <span class="at">sd=</span><span class="dv">12</span>))</span>
<span id="cb24-809"><a href="#cb24-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-810"><a href="#cb24-810" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm) <span class="sc">+</span> </span>
<span id="cb24-811"><a href="#cb24-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span> </span>
<span id="cb24-812"><a href="#cb24-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)), <span class="at">colour=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-813"><a href="#cb24-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb24-814"><a href="#cb24-814" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(dfm<span class="sc">$</span>x), <span class="at">sd=</span><span class="fu">sd</span>(dfm<span class="sc">$</span>x)), </span>
<span id="cb24-815"><a href="#cb24-815" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"line"</span>)</span>
<span id="cb24-816"><a href="#cb24-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-817"><a href="#cb24-817" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm) <span class="sc">+</span> <span class="fu">aes</span>(x) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb24-818"><a href="#cb24-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-819"><a href="#cb24-819" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb24-820"><a href="#cb24-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-821"><a href="#cb24-821" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb24-822"><a href="#cb24-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-823"><a href="#cb24-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-824"><a href="#cb24-824" aria-hidden="true" tabindex="-1"></a> **Small sample effect**   For small samples, we do not expect many outliers but the 'ideal' shape may not be seen; see @fig-rn50.</span>
<span id="cb24-825"><a href="#cb24-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-828"><a href="#cb24-828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-829"><a href="#cb24-829" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rn50</span></span>
<span id="cb24-830"><a href="#cb24-830" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-831"><a href="#cb24-831" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-832"><a href="#cb24-832" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb24-833"><a href="#cb24-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Normal(0,1) data (n=50)'</span></span>
<span id="cb24-834"><a href="#cb24-834" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb24-835"><a href="#cb24-835" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb24-836"><a href="#cb24-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-837"><a href="#cb24-837" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-838"><a href="#cb24-838" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean=</span><span class="dv">80</span>, <span class="at">sd =</span><span class="dv">12</span>))</span>
<span id="cb24-839"><a href="#cb24-839" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(x))<span class="sc">+</span><span class="fu">stat_ecdf</span>()<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="dv">80</span>, <span class="at">sd=</span><span class="dv">12</span>), <span class="at">colour=</span><span class="st">"red"</span>)</span>
<span id="cb24-840"><a href="#cb24-840" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">"ECDF &amp; CDF curves"</span> )</span>
<span id="cb24-841"><a href="#cb24-841" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">sample =</span> x))<span class="sc">+</span><span class="fu">stat_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qnorm)<span class="sc">+</span><span class="fu">stat_qq_line</span>()</span>
<span id="cb24-842"><a href="#cb24-842" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal quantile plot"</span>)</span>
<span id="cb24-843"><a href="#cb24-843" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb24-844"><a href="#cb24-844" aria-hidden="true" tabindex="-1"></a>p1 </span>
<span id="cb24-845"><a href="#cb24-845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-846"><a href="#cb24-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-847"><a href="#cb24-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-848"><a href="#cb24-848" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importance of the normal distribution</span></span>
<span id="cb24-849"><a href="#cb24-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-850"><a href="#cb24-850" aria-hidden="true" tabindex="-1"></a>***Question***: Why do we use the Normal distribution so much? Answer: Because:</span>
<span id="cb24-851"><a href="#cb24-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-852"><a href="#cb24-852" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Many physical, biological, engineering and economic quantities do seem to follow a Normal distribution (sometimes after a transformation of the data to an appropriate scale). An example is that the logarithm of the 'waiting time' between earthquakes in Wellington is normally distributed. (The use of the logarithm may worry you, but it is natural for the subject area. Note that the magnitude of earthquakes is also measured on a logarithmic scale, namely the familiar Richter scale.)</span>
<span id="cb24-853"><a href="#cb24-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-854"><a href="#cb24-854" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Data that are *approximately* Normal seem to turn up very frequently in practice. In particular this may occur because</span>
<span id="cb24-855"><a href="#cb24-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-856"><a href="#cb24-856" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>The Normal distribution is often what you get *(for mathematical reasons)* when you add together (or average) lots of different things. This result is known as the central limit theorem (CLT). For example, test scores are calculated by adding together marks from different questions, or share market movements are the result of many individuals and firms making private decisions. There is another theory which establishes that the sampling distributions of quantiles of continuous distributions of are approximately normal for *large* sample sizes.</span>
<span id="cb24-857"><a href="#cb24-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-858"><a href="#cb24-858" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>We shall see in this course that residuals play a large part. These are, for example, the 'errors' left over after fitting a regression line to data. Quite often, we expect residuals to follow a Normal distribution.</span>
<span id="cb24-859"><a href="#cb24-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-860"><a href="#cb24-860" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normal data in practice</span></span>
<span id="cb24-861"><a href="#cb24-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-862"><a href="#cb24-862" aria-hidden="true" tabindex="-1"></a>In practice, data from a 'Normal distribution' *may* not look very much like the 'bell-curve' unless there is very large amount of it. This statement has practical implications but first let us check whether the statement is true. We can do this by simulating batches of data from a Normal distribution (using software) and noting the variations across the data sets. Moreover, because the Normal distribution and its bell shaped curve are so important and ubiquitous, it is instructive to apply EDA methods to Normal data, for we would certainly like EDA methods to work well for that type of curve.</span>
<span id="cb24-863"><a href="#cb24-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-864"><a href="#cb24-864" aria-hidden="true" tabindex="-1"></a>For the first batch, we simulated 1000 numbers from a Normal distribution with mean 80 and standard deviation of 12. The numbers could represent, for example, the diastolic blood pressure of 1000 adult New Zealanders. @fig-simnor shows the histogram and the boxplot of the random normal data. Even though the typical bell-shaped pattern (theoretical normal curve shown in dotted lines) is evident, the histogram is not perfectly symmetric as the numbers were chosen at random so that by chance more fall into some classifications than would be expected. Also there are a few unusual values at the both extremes (see the boxplot). In practice if we didn't know that the data came from a Normal distribution we might investigate the three highest points to see if they were valid points or outliers. The extreme edges of a data often comprise very atypical values we would not tend to place too much weight on the conflicting evidence they give about symmetry. The mean and median of this simulated batch are somewhat closer but the median is slightly off-centred from the quartiles.*Well, so far so good. Now what if we have smaller batches?*</span>
<span id="cb24-865"><a href="#cb24-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-868"><a href="#cb24-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-869"><a href="#cb24-869" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-simnor</span></span>
<span id="cb24-870"><a href="#cb24-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-871"><a href="#cb24-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb24-872"><a href="#cb24-872" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-873"><a href="#cb24-873" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Simulated normal data, n=100 and n=1000'</span></span>
<span id="cb24-874"><a href="#cb24-874" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb24-875"><a href="#cb24-875" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb24-876"><a href="#cb24-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-877"><a href="#cb24-877" aria-hidden="true" tabindex="-1"></a>Mean  <span class="ot">&lt;-</span>  <span class="dv">80</span></span>
<span id="cb24-878"><a href="#cb24-878" aria-hidden="true" tabindex="-1"></a>Sd  <span class="ot">&lt;-</span>  <span class="dv">12</span></span>
<span id="cb24-879"><a href="#cb24-879" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb24-880"><a href="#cb24-880" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-881"><a href="#cb24-881" aria-hidden="true" tabindex="-1"></a>dfm<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">RNDnorm =</span> <span class="fu">rnorm</span>(n, Mean, Sd))</span>
<span id="cb24-882"><a href="#cb24-882" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> RNDnorm)) <span class="sc">+</span> </span>
<span id="cb24-883"><a href="#cb24-883" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span><span class="fu">after_stat</span>(density)),</span>
<span id="cb24-884"><a href="#cb24-884" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">seq</span>(Mean<span class="dv">-4</span><span class="sc">*</span>Sd, Mean<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>Sd, <span class="at">length.out =</span><span class="dv">20</span>), </span>
<span id="cb24-885"><a href="#cb24-885" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb24-886"><a href="#cb24-886" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb24-887"><a href="#cb24-887" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dfm<span class="sc">$</span>RNDnorm), <span class="at">sd =</span> <span class="fu">sd</span>(dfm<span class="sc">$</span>RNDnorm)))</span>
<span id="cb24-888"><a href="#cb24-888" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"N(80,12) random data n=100"</span>)</span>
<span id="cb24-889"><a href="#cb24-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-890"><a href="#cb24-890" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">y =</span> RNDnorm, <span class="at">x=</span><span class="fu">factor</span>(<span class="st">""</span>))) </span>
<span id="cb24-891"><a href="#cb24-891" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> p11 <span class="sc">+</span> <span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">""</span>)</span>
<span id="cb24-892"><a href="#cb24-892" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> p11 <span class="sc">+</span> <span class="fu">coord_flip</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"N(80,12) random data n=100"</span>)</span>
<span id="cb24-893"><a href="#cb24-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-894"><a href="#cb24-894" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-895"><a href="#cb24-895" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-896"><a href="#cb24-896" aria-hidden="true" tabindex="-1"></a>dfm<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">RNDnorm =</span> <span class="fu">rnorm</span>(n, Mean, Sd))</span>
<span id="cb24-897"><a href="#cb24-897" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> RNDnorm)) <span class="sc">+</span> </span>
<span id="cb24-898"><a href="#cb24-898" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span>..density..),</span>
<span id="cb24-899"><a href="#cb24-899" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">seq</span>(Mean<span class="dv">-4</span><span class="sc">*</span>Sd, Mean<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>Sd, <span class="at">length.out =</span><span class="dv">20</span>), </span>
<span id="cb24-900"><a href="#cb24-900" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb24-901"><a href="#cb24-901" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb24-902"><a href="#cb24-902" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dfm<span class="sc">$</span>RNDnorm), <span class="at">sd =</span> <span class="fu">sd</span>(dfm<span class="sc">$</span>RNDnorm)))</span>
<span id="cb24-903"><a href="#cb24-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-904"><a href="#cb24-904" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"N(80,12) random data n=1000"</span>)</span>
<span id="cb24-905"><a href="#cb24-905" aria-hidden="true" tabindex="-1"></a>p22 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">y =</span> RNDnorm, <span class="at">x=</span><span class="fu">factor</span>(<span class="st">""</span>))) </span>
<span id="cb24-906"><a href="#cb24-906" aria-hidden="true" tabindex="-1"></a>p22 <span class="ot">&lt;-</span> p22 <span class="sc">+</span> <span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">""</span>)</span>
<span id="cb24-907"><a href="#cb24-907" aria-hidden="true" tabindex="-1"></a>p22 <span class="ot">&lt;-</span> p22 <span class="sc">+</span> <span class="fu">coord_flip</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"N(80,12) random data n=1000"</span>)</span>
<span id="cb24-908"><a href="#cb24-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-909"><a href="#cb24-909" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p2,p1,p22,p11, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb24-910"><a href="#cb24-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-911"><a href="#cb24-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-912"><a href="#cb24-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-913"><a href="#cb24-913" aria-hidden="true" tabindex="-1"></a>For a normal distribution,</span>
<span id="cb24-914"><a href="#cb24-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-915"><a href="#cb24-915" aria-hidden="true" tabindex="-1"></a>68% of the values fall within 1 standard deviation of the mean\</span>
<span id="cb24-916"><a href="#cb24-916" aria-hidden="true" tabindex="-1"></a>95% of the values fall within 2 standard deviation of the mean\</span>
<span id="cb24-917"><a href="#cb24-917" aria-hidden="true" tabindex="-1"></a>99% of the values fall within 3 standard deviation of the mean.\</span>
<span id="cb24-918"><a href="#cb24-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-919"><a href="#cb24-919" aria-hidden="true" tabindex="-1"></a>As a special case, 50% of the values will fall within 0.6745 standard deviations of the mean. For symmetric distributions, mean equals the median. Hence the fourths (quartiles) of random data obtained drawn from theoretical normal population will be</span>
<span id="cb24-920"><a href="#cb24-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-921"><a href="#cb24-921" aria-hidden="true" tabindex="-1"></a>**Lower hinge** = median - $0.6745\times S~(\simeq$lower quartile),</span>
<span id="cb24-922"><a href="#cb24-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-923"><a href="#cb24-923" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb24-924"><a href="#cb24-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-925"><a href="#cb24-925" aria-hidden="true" tabindex="-1"></a>**Upper hinge** = median + $0.6745 \times S~(\simeq$ upper quartile),</span>
<span id="cb24-926"><a href="#cb24-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-927"><a href="#cb24-927" aria-hidden="true" tabindex="-1"></a>where $S$ is the standard deviation. Thus F-spread (or $\simeq$ the IQR) $\simeq$ 1.35$\times S$. Hence</span>
<span id="cb24-928"><a href="#cb24-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-929"><a href="#cb24-929" aria-hidden="true" tabindex="-1"></a>**inner fences**= median $\pm$ 2 F-spread = median $\pm$ 2.7$\times S$</span>
<span id="cb24-930"><a href="#cb24-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-931"><a href="#cb24-931" aria-hidden="true" tabindex="-1"></a>The probability that an observation falls between these fences is 0.993, or the probability of falling outside these fences is 0.007. Thus in our simulated batch of size 1000, we expect about 7 possible outliers but none for the simulated batch size 100. **Outer fences** are defined as being 2 steps (3$\times$F-spread) away from the fourths so that</span>
<span id="cb24-932"><a href="#cb24-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-933"><a href="#cb24-933" aria-hidden="true" tabindex="-1"></a>**outer fences**= median $\pm$ 3.5$\times$F-spread = median $\pm$ 4.72$\times S$</span>
<span id="cb24-934"><a href="#cb24-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-935"><a href="#cb24-935" aria-hidden="true" tabindex="-1"></a>The probability of a point falling outside of this range is the extremely small amount of 0.000002. It is not surprising, then, that none of the values in our simulated batches fell outside of the outer fences. If they did, we would class them as probable outliers. Of course, with distributions other than the Gaussian one, and particularly for asymmetric distributions, the probability of a value falling outside these fences is higher.</span>
<span id="cb24-936"><a href="#cb24-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-937"><a href="#cb24-937" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assessment of Normality</span></span>
<span id="cb24-938"><a href="#cb24-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-939"><a href="#cb24-939" aria-hidden="true" tabindex="-1"></a>The shapes of the ECDF curves shown in @fig-simnorecdf are typical of the empirical cumulative distributions for data from Normal populations. This curve was drawn using 1000 and 100 simulated random normal data. It could perhaps be described as an S-shape on its side (or lazy or stretched out S). The curve is flatter at either end which reflects the small amounts of relative frequency in the tails of the Normal distribution. The theoretical Cumulative Distribution Function (CDF) curve for the normal distribution is also shown in @fig-simnorecdf as a smooth curve. For smaller samples from a Normal population, the ECDF curve will vary about the theoretical curve, and, of course, the variation is likely to be larger the smaller the sample; see @fig-simnorecdf(B).</span>
<span id="cb24-940"><a href="#cb24-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-943"><a href="#cb24-943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-944"><a href="#cb24-944" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-simnorecdf</span></span>
<span id="cb24-945"><a href="#cb24-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-946"><a href="#cb24-946" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-947"><a href="#cb24-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Simulated normal data, n=100 and n=1000'</span></span>
<span id="cb24-948"><a href="#cb24-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-949"><a href="#cb24-949" aria-hidden="true" tabindex="-1"></a>Mean  <span class="ot">&lt;-</span>  <span class="dv">80</span></span>
<span id="cb24-950"><a href="#cb24-950" aria-hidden="true" tabindex="-1"></a>Sd  <span class="ot">&lt;-</span>  <span class="dv">12</span></span>
<span id="cb24-951"><a href="#cb24-951" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb24-952"><a href="#cb24-952" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-953"><a href="#cb24-953" aria-hidden="true" tabindex="-1"></a>dfm<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">RNDnorm =</span> <span class="fu">rnorm</span>(n, Mean, Sd))</span>
<span id="cb24-954"><a href="#cb24-954" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> RNDnorm)) <span class="sc">+</span> <span class="fu">stat_ecdf</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">"red"</span>)) </span>
<span id="cb24-955"><a href="#cb24-955" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dfm<span class="sc">$</span>RNDnorm), <span class="at">sd =</span> <span class="fu">sd</span>(dfm<span class="sc">$</span>RNDnorm)))</span>
<span id="cb24-956"><a href="#cb24-956" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1<span class="sc">+</span><span class="fu">guides</span>(<span class="at">colour=</span><span class="cn">FALSE</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"(A)"</span>)</span>
<span id="cb24-957"><a href="#cb24-957" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"N(80,12) random data n=100"</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"Cumulative proportion/probability"</span>)</span>
<span id="cb24-958"><a href="#cb24-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-959"><a href="#cb24-959" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-960"><a href="#cb24-960" aria-hidden="true" tabindex="-1"></a>dfm<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">RNDnorm =</span> <span class="fu">rnorm</span>(n, Mean, Sd))</span>
<span id="cb24-961"><a href="#cb24-961" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> RNDnorm)) <span class="sc">+</span> <span class="fu">stat_ecdf</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">"red"</span>)) </span>
<span id="cb24-962"><a href="#cb24-962" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dfm<span class="sc">$</span>RNDnorm), <span class="at">sd =</span> <span class="fu">sd</span>(dfm<span class="sc">$</span>RNDnorm)))</span>
<span id="cb24-963"><a href="#cb24-963" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2<span class="sc">+</span><span class="fu">guides</span>(<span class="at">colour=</span><span class="cn">FALSE</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"(B)"</span>)</span>
<span id="cb24-964"><a href="#cb24-964" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"N(80,12) random data n=1000"</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"Cumulative proportion/probability"</span>)</span>
<span id="cb24-965"><a href="#cb24-965" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p2,p1, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb24-966"><a href="#cb24-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-967"><a href="#cb24-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-968"><a href="#cb24-968" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normal quantile-quantile plots</span></span>
<span id="cb24-969"><a href="#cb24-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-970"><a href="#cb24-970" aria-hidden="true" tabindex="-1"></a>To visually check whether a given set of data are normally distributed, one can create a normal quantile-quantile (Q-Q) plot. In this plot the quantiles of the sample are plotted against the theoretical quantiles of a standard normal distribution N(0,1). If the data, $Y_{i}$, are normally distributed N($\mu, \sigma$) then $Z_{i} = \left(Y_{i} -\mu \right)/\sigma$ has a standard normal distribution. If we plot the quantiles of the data against corresponding quantiles of the standard normal distribution, the points should roughly lie on the straight line: $$Y_{i} =\mu +\sigma Z_{i}$$ that is, a line with intercept $\mu$, and slope $\sigma$.</span>
<span id="cb24-971"><a href="#cb24-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-972"><a href="#cb24-972" aria-hidden="true" tabindex="-1"></a>We should note that the mean and standard deviation do not appear in the formula $Y_{i} =\mu +\sigma Z_{i}$ by coincidence. Rather, the mean and standard deviation are intimately connected to the normal distribution: if the data had not been normal then the line with these parameters would not pass through the data.</span>
<span id="cb24-973"><a href="#cb24-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-976"><a href="#cb24-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-977"><a href="#cb24-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normqq</span></span>
<span id="cb24-978"><a href="#cb24-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-979"><a href="#cb24-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Normal Quantile-Quantile Plot for Checking Normality'</span></span>
<span id="cb24-980"><a href="#cb24-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-981"><a href="#cb24-981" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-982"><a href="#cb24-982" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">12</span>) <span class="co">#qqnorm(x); qqline(x) # base function</span></span>
<span id="cb24-983"><a href="#cb24-983" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb24-984"><a href="#cb24-984" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb24-985"><a href="#cb24-985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-986"><a href="#cb24-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-987"><a href="#cb24-987" aria-hidden="true" tabindex="-1"></a>@fig-normqq shows the normal Q-Q plot for 50 random values from N(80,12). Note that the points in the middle largely plot on a line. It is natural that the tail part of the distribution shows more variation, and hence we will ignore such departures.</span>
<span id="cb24-988"><a href="#cb24-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-989"><a href="#cb24-989" aria-hidden="true" tabindex="-1"></a>The normal Q-Q plot is presented as a **normal probability plot** in some software where the theoretical quantiles are replaced by the associated normal probabilities. Such normal probability plots show the sample data in the $X$-axis and the normal probabilities in the $Y$-axis. In both plots, we mainly look whether or not the points plot roughly on a straight line.</span>
<span id="cb24-990"><a href="#cb24-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-993"><a href="#cb24-993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-994"><a href="#cb24-994" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normqqP</span></span>
<span id="cb24-995"><a href="#cb24-995" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb24-996"><a href="#cb24-996" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Normal Quantile-Quantile Plot for Checking Normality'</span></span>
<span id="cb24-997"><a href="#cb24-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-998"><a href="#cb24-998" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb24-999"><a href="#cb24-999" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/rangitikei.RData"</span>,</span>
<span id="cb24-1000"><a href="#cb24-1000" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">"rangitikei.RData"</span>)</span>
<span id="cb24-1001"><a href="#cb24-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1002"><a href="#cb24-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"rangitikei.RData"</span>)</span>
<span id="cb24-1003"><a href="#cb24-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1004"><a href="#cb24-1004" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rangitikei) <span class="sc">+</span></span>
<span id="cb24-1005"><a href="#cb24-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">sample =</span> people) <span class="sc">+</span> </span>
<span id="cb24-1006"><a href="#cb24-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>()</span>
<span id="cb24-1007"><a href="#cb24-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1008"><a href="#cb24-1008" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rangitikei) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y=</span>people, <span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-1009"><a href="#cb24-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb24-1010"><a href="#cb24-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb24-1011"><a href="#cb24-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb24-1012"><a href="#cb24-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1013"><a href="#cb24-1013" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol=</span><span class="dv">1</span>) </span>
<span id="cb24-1014"><a href="#cb24-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-1015"><a href="#cb24-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1016"><a href="#cb24-1016" aria-hidden="true" tabindex="-1"></a>@fig-normqqP shows the normal Q-Q plot for the number of people who made use of a recreational facility (**rangitikei**). This plot clearly reveals that the data are not normal. The plotted points show a curved but asymmetric pattern. This pattern matches with the right skewness seen in the data (see the boxplot given in @fig-normqqP.</span>
<span id="cb24-1017"><a href="#cb24-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1018"><a href="#cb24-1018" aria-hidden="true" tabindex="-1"></a>Note that **normality and symmetry are not the same**. If the true distribution of the data is symmetric such as uniform, rectangular or triangular distributions, then the normal Q-Q plot will show a symmetric pattern for the plotted points but they will not plot on a straight line. As an example, the normal Q-Q plots for batches of random data from Student's $t$ (to be covered later in the next Chapter) and few other symmetric distributions is shown in @fig-normqqsym. Clearly normality is rejected for other symmetric non-normal distributions.</span>
<span id="cb24-1019"><a href="#cb24-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1022"><a href="#cb24-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-1023"><a href="#cb24-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normqqsym</span></span>
<span id="cb24-1024"><a href="#cb24-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb24-1025"><a href="#cb24-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Normal Quantile-Quantile Plot for Checking Normality'</span></span>
<span id="cb24-1026"><a href="#cb24-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb24-1027"><a href="#cb24-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb24-1028"><a href="#cb24-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1029"><a href="#cb24-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-1030"><a href="#cb24-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1031"><a href="#cb24-1031" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">rt</span>(<span class="dv">500</span>, <span class="dv">2</span>) </span>
<span id="cb24-1032"><a href="#cb24-1032" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb24-1033"><a href="#cb24-1033" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Student t data with 2 df - n=500"</span>)</span>
<span id="cb24-1034"><a href="#cb24-1034" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">runif</span>(<span class="dv">500</span>) </span>
<span id="cb24-1035"><a href="#cb24-1035" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb24-1036"><a href="#cb24-1036" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Uniform data - n=500"</span>)</span>
<span id="cb24-1037"><a href="#cb24-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1038"><a href="#cb24-1038" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">rbeta</span>(<span class="dv">500</span>, <span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb24-1039"><a href="#cb24-1039" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span> </span>
<span id="cb24-1040"><a href="#cb24-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb24-1041"><a href="#cb24-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Beta(2,2) data - n=500"</span>)</span>
<span id="cb24-1042"><a href="#cb24-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1043"><a href="#cb24-1043" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  extraDistr<span class="sc">::</span><span class="fu">rlaplace</span>(<span class="dv">500</span>) </span>
<span id="cb24-1044"><a href="#cb24-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1045"><a href="#cb24-1045" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb24-1046"><a href="#cb24-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb24-1047"><a href="#cb24-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Laplace data - n=500"</span>)</span>
<span id="cb24-1048"><a href="#cb24-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1049"><a href="#cb24-1049" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1,p2, p3, p4, <span class="at">ncol=</span><span class="dv">2</span>) </span>
<span id="cb24-1050"><a href="#cb24-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-1051"><a href="#cb24-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1052"><a href="#cb24-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1053"><a href="#cb24-1053" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary</span></span>
<span id="cb24-1054"><a href="#cb24-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1055"><a href="#cb24-1055" aria-hidden="true" tabindex="-1"></a>This Chapter provided a revision of probability concepts usually covered the first year level covered at the seventh form level or in a first year Statistics course.  A few popular probability distributions are also introduced.</span>
<span id="cb24-1056"><a href="#cb24-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1057"><a href="#cb24-1057" aria-hidden="true" tabindex="-1"></a>Identification of a probability distribution is not an easy task for a set of observed data. This issue is not settled purely on statistical grounds.  EDA helps to short-list distributions fitting reasonably well to the data.  For regression type of models fitted to continuous responses, the normal distribution works generally well.</span>
<span id="cb24-1058"><a href="#cb24-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1059"><a href="#cb24-1059" aria-hidden="true" tabindex="-1"></a>The material covered in this Chapter forms the foundation for many of the inferential methods.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>